# Trade-Info ç³»ç»Ÿæ¶æ„è¯´æ˜

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

Trade-Info é‡‡ç”¨**æ¨¡å—åŒ–åˆ†å±‚æ¶æ„**ï¼Œæ¸…æ™°åˆ†ç¦»èŒè´£ï¼Œæå‡å¯ç»´æŠ¤æ€§ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend Layer                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  UI Modules  â”‚  â”‚  API Client  â”‚  â”‚    Utils     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ HTTP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API Layer (Flask)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ L1 Advisory  â”‚  â”‚ Dual Advisoryâ”‚  â”‚   History    â”‚  â”‚
â”‚  â”‚   Routes     â”‚  â”‚    Routes    â”‚  â”‚    Routes    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Service Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚  Scheduler   â”‚  â”‚Config Watcherâ”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Business Logic Layer                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           L1 Advisory Engine (l1_engine/)          â”‚ â”‚
â”‚  â”‚                                                    â”‚ â”‚
â”‚  â”‚  DataValidator â†’ RegimeDetector â†’ RiskGates      â”‚ â”‚
â”‚  â”‚         â†“              â†“              â†“           â”‚ â”‚
â”‚  â”‚  SignalGenerator â†’ ConfidenceCalculator          â”‚ â”‚
â”‚  â”‚         â†“              â†“                          â”‚ â”‚
â”‚  â”‚  FrequencyController â†’ Result                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Data Access Layer                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Advisory    â”‚  â”‚ Dual Advisoryâ”‚  â”‚   Pipeline   â”‚  â”‚
â”‚  â”‚ Repository   â”‚  â”‚  Repository  â”‚  â”‚  Repository  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ SQLite  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ ç›®å½•ç»“æ„

### åç«¯ï¼ˆPythonï¼‰

```
trade-info/
â”‚
â”œâ”€â”€ l1_engine/                      # æ ¸å¿ƒå¼•æ“å±‚
â”‚   â”œâ”€â”€ data_validator.py          # æ•°æ®éªŒè¯
â”‚   â”œâ”€â”€ regime_detector.py         # å¸‚åœºç¯å¢ƒè¯†åˆ«
â”‚   â”œâ”€â”€ risk_gates.py              # é£é™©å‡†å…¥+äº¤æ˜“è´¨é‡
â”‚   â”œâ”€â”€ signal_generator.py        # ä¿¡å·ç”Ÿæˆ
â”‚   â”œâ”€â”€ confidence_calculator.py   # ç½®ä¿¡åº¦+æ‰§è¡Œè®¸å¯
â”‚   â”œâ”€â”€ frequency_controller.py    # é¢‘ç‡æ§åˆ¶
â”‚   â”œâ”€â”€ config_validator.py        # é…ç½®éªŒè¯
â”‚   â”œâ”€â”€ helper_utils.py            # è¾…åŠ©å·¥å…·
â”‚   â”œâ”€â”€ memory.py                  # å†³ç­–è®°å¿†
â”‚   â”œâ”€â”€ config_manager.py          # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ __init__.py                # æ¨¡å—å¯¼å‡º
â”‚
â”œâ”€â”€ api/                            # APIè·¯ç”±å±‚
â”‚   â”œâ”€â”€ l1_advisory_routes.py      # L1å†³ç­–API
â”‚   â”œâ”€â”€ dual_advisory_routes.py    # åŒå‘¨æœŸAPI
â”‚   â”œâ”€â”€ history_routes.py          # å†å²æŸ¥è¯¢API
â”‚   â”œâ”€â”€ config_routes.py           # é…ç½®ç®¡ç†API
â”‚   â”œâ”€â”€ market_routes.py           # å¸‚åœºä¿¡æ¯API
â”‚   â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ services/                       # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ scheduler_service.py       # å®šæ—¶ä»»åŠ¡
â”‚   â”œâ”€â”€ config_watcher_service.py  # é…ç½®ç›‘æ§
â”‚   â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ database/                       # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ connection.py              # è¿æ¥ç®¡ç†
â”‚   â”œâ”€â”€ advisory_repository.py     # å•å‘¨æœŸæ•°æ®è®¿é—®
â”‚   â”œâ”€â”€ dual_advisory_repository.py # åŒå‘¨æœŸæ•°æ®è®¿é—®
â”‚   â”œâ”€â”€ pipeline_repository.py     # ç®¡é“æ•°æ®è®¿é—®
â”‚   â”œâ”€â”€ migrations.py              # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ models/                         # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ advisory_result.py
â”‚   â”œâ”€â”€ dual_timeframe_result.py
â”‚   â”œâ”€â”€ enums.py
â”‚   â””â”€â”€ reason_tags.py
â”‚
â”œâ”€â”€ btc_web_app_l1_modular.py      # Flaskåº”ç”¨ï¼ˆæ¨¡å—åŒ–ç‰ˆï¼‰
â”œâ”€â”€ btc_web_app_l1.py               # Flaskåº”ç”¨ï¼ˆåŸå§‹ç‰ˆï¼Œä¿ç•™ï¼‰
â”‚
â”œâ”€â”€ market_state_machine_l1.py     # æ ¸å¿ƒå¼•æ“ï¼ˆåŸå§‹ç‰ˆï¼Œä¿ç•™ï¼‰
â”œâ”€â”€ database_l1.py                  # æ•°æ®åº“ï¼ˆåŸå§‹ç‰ˆï¼Œä¿ç•™ï¼‰
â”‚
â”œâ”€â”€ binance_data_fetcher.py        # æ•°æ®è·å–
â”œâ”€â”€ data_cache.py                  # æ•°æ®ç¼“å­˜
â””â”€â”€ metrics_normalizer.py          # æŒ‡æ ‡è§„èŒƒåŒ–
```

### å‰ç«¯ï¼ˆJavaScriptï¼‰

```
static/js/
â”‚
â”œâ”€â”€ modules/                        # åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ api_client.js              # APIè°ƒç”¨å°è£…
â”‚   â”œâ”€â”€ dual_decision.js           # åŒå‘¨æœŸå†³ç­–æ¸²æŸ“
â”‚   â”œâ”€â”€ signal_notification.js     # ä¿¡å·é€šçŸ¥
â”‚   â””â”€â”€ history_manager.js         # å†å²è®°å½•ç®¡ç†
â”‚
â”œâ”€â”€ utils/                          # å·¥å…·åº“
â”‚   â”œâ”€â”€ formatters.js              # æ•°æ®æ ¼å¼åŒ–
â”‚   â””â”€â”€ constants.js               # å¸¸é‡å®šä¹‰
â”‚
â”œâ”€â”€ app_l1_unified_modular.js      # ä¸»åº”ç”¨ï¼ˆæ¨¡å—åŒ–ç‰ˆï¼‰
â”œâ”€â”€ app_l1_unified.js               # ä¸»åº”ç”¨ï¼ˆåŸå§‹ç‰ˆï¼Œä¿ç•™ï¼‰
â””â”€â”€ app_l1.js                       # å•å‘¨æœŸåº”ç”¨ï¼ˆä¿ç•™ï¼‰
```

---

## ğŸ¯ æ¨¡å—èŒè´£è¯´æ˜

### æ ¸å¿ƒå¼•æ“å±‚ï¼ˆl1_engine/ï¼‰

| æ¨¡å— | èŒè´£ | è¡Œæ•° |
|------|------|------|
| `data_validator` | Step 1: æ•°æ®éªŒè¯ã€è§„èŒƒåŒ–ã€completenessæ£€æŸ¥ | ~200 |
| `regime_detector` | Step 2: å¸‚åœºç¯å¢ƒè¯†åˆ«ï¼ˆTREND/RANGE/EXTREMEï¼‰ | ~100 |
| `risk_gates` | Step 3&4: é£é™©å‡†å…¥è¯„ä¼°ã€äº¤æ˜“è´¨é‡è¯„ä¼° | ~250 |
| `signal_generator` | Step 5&6: æ–¹å‘è¯„ä¼°ã€å†³ç­–ä¼˜å…ˆçº§åˆ¤æ–­ | ~200 |
| `confidence_calculator` | Step 8&9: æ‰§è¡Œè®¸å¯ã€ç½®ä¿¡åº¦è®¡ç®— | ~250 |
| `frequency_controller` | Step 7: å†³ç­–é¢‘ç‡æ§åˆ¶ | ~100 |
| `config_validator` | å¯åŠ¨æ—¶é…ç½®æ ¡éªŒï¼ˆå£å¾„ã€ä¸€è‡´æ€§ã€æ‹¼å†™ï¼‰ | ~250 |
| `helper_utils` | None-safeå·¥å…·ã€é˜ˆå€¼æ‰å¹³åŒ– | ~150 |
| `memory` | å†³ç­–è®°å¿†ç®¡ç†ï¼ˆå•å‘¨æœŸ+åŒå‘¨æœŸï¼‰ | ~280 |
| `config_manager` | é…ç½®æ–‡ä»¶ç®¡ç† | ~50 |

### APIè·¯ç”±å±‚ï¼ˆapi/ï¼‰

| æ¨¡å— | èŒè´£ | è¡Œæ•° |
|------|------|------|
| `l1_advisory_routes` | L1å•å‘¨æœŸå†³ç­–API | ~150 |
| `dual_advisory_routes` | åŒå‘¨æœŸå†³ç­–API | ~100 |
| `history_routes` | å†å²æŸ¥è¯¢+ç»Ÿè®¡API | ~200 |
| `config_routes` | é…ç½®ç®¡ç†+ReasonTagè§£é‡ŠAPI | ~150 |
| `market_routes` | å¸‚åœºä¿¡æ¯API | ~80 |

### ä¸šåŠ¡æœåŠ¡å±‚ï¼ˆservices/ï¼‰

| æ¨¡å— | èŒè´£ | è¡Œæ•° |
|------|------|------|
| `scheduler_service` | å®šæ—¶ä»»åŠ¡ç®¡ç†ï¼ˆå‘¨æœŸæ›´æ–°ã€è‡ªåŠ¨æ¸…ç†ï¼‰ | ~200 |
| `config_watcher_service` | é…ç½®æ–‡ä»¶ç›‘æ§å’Œçƒ­æ›´æ–° | ~100 |

### æ•°æ®è®¿é—®å±‚ï¼ˆdatabase/ï¼‰

| æ¨¡å— | èŒè´£ | è¡Œæ•° |
|------|------|------|
| `connection` | æ•°æ®åº“è¿æ¥ç®¡ç† | ~30 |
| `advisory_repository` | å•å‘¨æœŸå†³ç­–CRUD | ~250 |
| `dual_advisory_repository` | åŒå‘¨æœŸå†³ç­–CRUD | ~180 |
| `pipeline_repository` | ç®¡é“æ­¥éª¤CRUD | ~150 |
| `migrations` | è¡¨ç»“æ„ç®¡ç†å’Œè¿ç§» | ~230 |

### å‰ç«¯æ¨¡å—ï¼ˆstatic/js/modules/ï¼‰

| æ¨¡å— | èŒè´£ | è¡Œæ•° |
|------|------|------|
| `api_client` | å°è£…æ‰€æœ‰APIè°ƒç”¨ | ~150 |
| `dual_decision` | åŒå‘¨æœŸå†³ç­–å¡ç‰‡å’Œè¯¦æƒ…æ¸²æŸ“ | ~300 |
| `signal_notification` | ä¿¡å·æ£€æµ‹ã€å¼¹çª—ã€é€šçŸ¥ã€å£°éŸ³ | ~250 |
| `history_manager` | å†å²è®°å½•åŠ è½½ã€è¿‡æ»¤ã€åˆ†é¡µ | ~200 |
| `formatters` | æ•°æ®æ ¼å¼åŒ–å·¥å…· | ~100 |
| `constants` | å¸¸é‡å®šä¹‰ | ~60 |

---

## ğŸ”„ æ•°æ®æµå›¾

### L1å†³ç­–æµç¨‹

```
ç”¨æˆ·è¯·æ±‚ â†’ Flaskè·¯ç”± â†’ AdvisoryEngine â†’ Database â†’ å“åº”
    â”‚           â”‚            â”‚               â”‚
    â”‚           â”‚            â”‚               â”‚
GET /api/l1/   â”‚            â”‚               â”‚
advisory/BTC   â”‚            â”‚               â”‚
               â”‚            â”‚               â”‚
         [l1_advisory_routes.py]   â”‚               â”‚
               â”‚                   â”‚               â”‚
               â””â”€â†’ fetch_market_data()            â”‚
                   (binance_fetcher)               â”‚
                          â”‚                        â”‚
                          â”œâ”€â†’ on_new_tick()        â”‚
                          â”‚   (10æ­¥ç®¡é“)           â”‚
                          â”‚                        â”‚
                          â”‚   Step 1: DataValidator
                          â”‚   Step 2: RegimeDetector
                          â”‚   Step 3-4: RiskGates
                          â”‚   Step 5-6: SignalGenerator
                          â”‚   Step 7: FrequencyController
                          â”‚   Step 8-9: ConfidenceCalculator
                          â”‚                        â”‚
                          â”œâ”€â†’ AdvisoryResult       â”‚
                          â”‚                        â”‚
                          â””â”€â†’ save_advisory_result()
                              (advisory_repository)
                                     â”‚
                                     â””â”€â†’ SQLite
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨åŸå§‹ç‰ˆæœ¬ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

```bash
# å¯åŠ¨åŸå§‹Flaskåº”ç”¨
python btc_web_app_l1.py

# è®¿é—®
open http://localhost:5001
```

### ä½¿ç”¨æ¨¡å—åŒ–ç‰ˆæœ¬ï¼ˆæ–°å¼€å‘æ¨èï¼‰

```bash
# å¯åŠ¨æ¨¡å—åŒ–Flaskåº”ç”¨
python btc_web_app_l1_modular.py

# è®¿é—®
open http://localhost:5001
```

### å•ç‹¬ä½¿ç”¨å¼•æ“æ¨¡å—

```python
# ä½¿ç”¨æ¨¡å—åŒ–ç»„ä»¶
from l1_engine import (
    DataValidator,
    RegimeDetector,
    RiskGates,
    SignalGenerator,
    ConfidenceCalculator
)

# åˆ›å»ºå®ä¾‹å¹¶ä½¿ç”¨
validator = DataValidator(config)
is_valid, data, err, trace = validator.validate_data(market_data)
```

---

## ğŸ§ª æµ‹è¯•æŒ‡å—

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python -m pytest tests/

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
python -m pytest tests/l1_engine/

# æŸ¥çœ‹è¦†ç›–ç‡
python -m pytest --cov=l1_engine tests/
```

### æ·»åŠ æ–°æµ‹è¯•

```python
# tests/l1_engine/test_data_validator.py
import pytest
from l1_engine import DataValidator

def test_validate_data_success():
    config = {...}
    validator = DataValidator(config)
    
    market_data = {
        'price': 100000,
        'volume_24h': 50000,
        'funding_rate': 0.0001
    }
    
    is_valid, normalized_data, fail_tag, trace = validator.validate_data(market_data)
    
    assert is_valid == True
    assert fail_tag is None
```

---

## ğŸ“ å¼€å‘è§„èŒƒ

### 1. æ–‡ä»¶å¤§å°é™åˆ¶

- âœ… æ¯ä¸ªæ¨¡å—æ–‡ä»¶ < 400è¡Œ
- âš ï¸ è¶…è¿‡400è¡Œè€ƒè™‘æ‹†åˆ†
- âŒ ç¦æ­¢å•æ–‡ä»¶ > 1000è¡Œ

### 2. æ¨¡å—èŒè´£

- âœ… å•ä¸€èŒè´£åŸåˆ™
- âœ… é«˜å†…èšä½è€¦åˆ
- âœ… æ˜ç¡®çš„è¾“å…¥è¾“å‡º

### 3. å‘½åè§„èŒƒ

```python
# æ¨¡å—åï¼šå°å†™ä¸‹åˆ’çº¿
data_validator.py

# ç±»åï¼šå¤§é©¼å³°
class DataValidator

# å‡½æ•°åï¼šå°å†™ä¸‹åˆ’çº¿
def validate_data()

# å¸¸é‡ï¼šå¤§å†™ä¸‹åˆ’çº¿
MAX_STALENESS_SECONDS
```

### 4. å¯¼å…¥è§„èŒƒ

```python
# æ ‡å‡†åº“
import os
import json

# ç¬¬ä¸‰æ–¹åº“
from flask import Blueprint
import yaml

# æœ¬åœ°æ¨¡å—
from models.enums import Decision
from l1_engine import DataValidator
```

---

## ğŸ”§ ç»´æŠ¤æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

```python
# 1. ç¡®å®šåŠŸèƒ½æ‰€å±æ¨¡å—
# ä¾‹å¦‚ï¼šæ·»åŠ æ–°çš„é£é™©æ£€æŸ¥è§„åˆ™

# 2. åœ¨å¯¹åº”æ¨¡å—ä¸­æ·»åŠ æ–¹æ³•
# ç¼–è¾‘: l1_engine/risk_gates.py

class RiskGates:
    def eval_risk_exposure_allowed(self, data, regime):
        # ... ç°æœ‰é€»è¾‘
        
        # æ·»åŠ æ–°è§„åˆ™
        if self._check_new_risk_rule(data):
            tags.append(ReasonTag.NEW_RISK)
            return False, tags
        
        return True, []
    
    def _check_new_risk_rule(self, data):
        # æ–°è§„åˆ™é€»è¾‘
        pass
```

### ä¿®æ”¹ç°æœ‰åŠŸèƒ½

```python
# 1. å®šä½åˆ°å…·ä½“æ¨¡å—
# ä¾‹å¦‚ï¼šä¿®æ”¹ç½®ä¿¡åº¦è®¡ç®—é€»è¾‘

# 2. ä¿®æ”¹å¯¹åº”æ–¹æ³•
# ç¼–è¾‘: l1_engine/confidence_calculator.py

# 3. æ·»åŠ /æ›´æ–°æµ‹è¯•
# ç¼–è¾‘: tests/l1_engine/test_confidence_calculator.py
```

### æ‰©å±•æ–°API

```python
# 1. åˆ›å»ºæ–°è·¯ç”±æ¨¡å—ï¼ˆå¦‚æœéœ€è¦ï¼‰
# åˆ›å»º: api/new_feature_routes.py

# 2. æ³¨å†Œè·¯ç”±
# ç¼–è¾‘: api/__init__.py

# 3. å®ç°ä¸šåŠ¡é€»è¾‘
# ç¼–è¾‘: services/new_feature_service.py
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### å¯¼å…¥é”™è¯¯

```python
# é”™è¯¯: ModuleNotFoundError: No module named 'l1_engine'
# è§£å†³: ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
cd /Users/wangqiang/learning/trade-info
python btc_web_app_l1_modular.py
```

### é…ç½®é”™è¯¯

```python
# é”™è¯¯: ValueError: é…ç½®å£å¾„é”™è¯¯æ£€æµ‹
# è§£å†³: æ£€æŸ¥ config/l1_thresholds.yamlï¼Œç¡®ä¿ç™¾åˆ†æ¯”ä½¿ç”¨å°æ•°æ ¼å¼ï¼ˆ0.05è€Œé5.0ï¼‰
```

### æ•°æ®åº“é”™è¯¯

```python
# é”™è¯¯: sqlite3.OperationalError: no such table
# è§£å†³: åˆ é™¤æ—§æ•°æ®åº“ï¼Œé‡æ–°åˆå§‹åŒ–
rm data/db/l1_advisory.db
python btc_web_app_l1_modular.py
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `ARCHITECTURE_OPTIMIZATION_SUMMARY.md` - è¯¦ç»†ä¼˜åŒ–æŠ¥å‘Š
- `REFACTORING_REPORT.md` - é‡æ„è¿‡ç¨‹è®°å½•
- `README.md` - é¡¹ç›®æ€»ä½“è¯´æ˜
- `doc/` - æŠ€æœ¯æ–‡æ¡£ç›®å½•

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. **Forké¡¹ç›®** 
2. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**: `git checkout -b feature/new-feature`
3. **éµå¾ªæ¨¡å—åŒ–åŸåˆ™**: æ¯ä¸ªæ–‡ä»¶ < 400è¡Œ
4. **æ·»åŠ å•å…ƒæµ‹è¯•**: è¦†ç›–æ ¸å¿ƒé€»è¾‘
5. **æ›´æ–°æ–‡æ¡£**: åŒ…æ‹¬ä»£ç æ³¨é‡Šå’ŒREADME
6. **æäº¤PR**: æ¸…æ™°çš„commit message

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤Issue: GitHub Issues
- é‚®ä»¶: your-email@example.com

---

**æœ€åæ›´æ–°**: 2026-01-23  
**æ¶æ„ç‰ˆæœ¬**: v2.0 (Modular)  
