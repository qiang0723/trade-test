# æ–°æ¶æ„å¼€å‘é€ŸæŸ¥è¡¨ ğŸš€

> **é‡è¦**: ä¹‹åçš„å¼€å‘éƒ½åŸºäºæ–°æ¶æ„ï¼ˆæ¨¡å—åŒ–ç‰ˆæœ¬ï¼‰

---

## âš¡ å¿«é€Ÿå‘½ä»¤

### å¯åŠ¨åº”ç”¨

```bash
# æ¨¡å—åŒ–ç‰ˆæœ¬ï¼ˆæ¨èï¼‰
python btc_web_app_l1_modular.py

# åŸå§‹ç‰ˆæœ¬ï¼ˆç´§æ€¥å¤‡ç”¨ï¼‰
python btc_web_app_l1.py
```

### æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest tests/ -v

# è¿è¡Œç‰¹å®šæ¨¡å—
pytest tests/l1_engine/ -v

# æŸ¥çœ‹è¦†ç›–ç‡
pytest --cov=l1_engine tests/
```

### ä»£ç æ£€æŸ¥

```bash
# Python linter
flake8 l1_engine/ api/ services/ database/

# è¡Œæ•°ç»Ÿè®¡
wc -l <æ–‡ä»¶å>
```

---

## ğŸ“‚ æ¨¡å—å®šä½é€ŸæŸ¥

### éœ€è¦ä¿®æ”¹ä»€ä¹ˆï¼Ÿ â†’ æ‰¾å“ªä¸ªæ–‡ä»¶ï¼Ÿ

| éœ€æ±‚ | æ¨¡å—ä½ç½® | è¡Œæ•° |
|------|---------|------|
| **æ•°æ®éªŒè¯è§„åˆ™** | `l1_engine/data_validator.py` | ~200 |
| **å¸‚åœºç¯å¢ƒåˆ¤æ–­** | `l1_engine/regime_detector.py` | ~100 |
| **é£é™©æ£€æŸ¥è§„åˆ™** | `l1_engine/risk_gates.py` | ~250 |
| **äº¤æ˜“è´¨é‡è¯„ä¼°** | `l1_engine/risk_gates.py` | ~250 |
| **åšå¤š/åšç©ºæ¡ä»¶** | `l1_engine/signal_generator.py` | ~200 |
| **ç½®ä¿¡åº¦ç®—æ³•** | `l1_engine/confidence_calculator.py` | ~250 |
| **æ‰§è¡Œè®¸å¯åˆ¤æ–­** | `l1_engine/confidence_calculator.py` | ~250 |
| **é¢‘ç‡æ§åˆ¶è§„åˆ™** | `l1_engine/frequency_controller.py` | ~100 |
| **é…ç½®éªŒè¯** | `l1_engine/config_validator.py` | ~250 |
| **L1å†³ç­–API** | `api/l1_advisory_routes.py` | ~150 |
| **åŒå‘¨æœŸAPI** | `api/dual_advisory_routes.py` | ~100 |
| **å†å²æŸ¥è¯¢API** | `api/history_routes.py` | ~200 |
| **é…ç½®ç®¡ç†API** | `api/config_routes.py` | ~150 |
| **å®šæ—¶ä»»åŠ¡** | `services/scheduler_service.py` | ~200 |
| **é…ç½®çƒ­æ›´æ–°** | `services/config_watcher_service.py` | ~100 |
| **å•å‘¨æœŸæ•°æ®** | `database/advisory_repository.py` | ~250 |
| **åŒå‘¨æœŸæ•°æ®** | `database/dual_advisory_repository.py` | ~180 |
| **ç®¡é“æ•°æ®** | `database/pipeline_repository.py` | ~150 |
| **å‰ç«¯APIè°ƒç”¨** | `static/js/modules/api_client.js` | ~150 |
| **å†³ç­–å¡ç‰‡æ¸²æŸ“** | `static/js/modules/dual_decision.js` | ~300 |
| **ä¿¡å·é€šçŸ¥** | `static/js/modules/signal_notification.js` | ~250 |
| **å†å²ç®¡ç†** | `static/js/modules/history_manager.js` | ~200 |

---

## ğŸ¯ å¼€å‘æ¨¡æ¿

### æ·»åŠ æ–°çš„é£é™©æ£€æŸ¥

```python
# æ–‡ä»¶: l1_engine/risk_gates.py

class RiskGates:
    def eval_risk_exposure_allowed(self, data, regime):
        tags = []
        
        # ğŸ†• æ·»åŠ ä½ çš„æ–°è§„åˆ™
        if self._check_æ–°é£é™©(data):
            tags.append(ReasonTag.æ–°é£é™©æ ‡ç­¾)
            return False, tags
        
        return True, []
    
    def _check_æ–°é£é™©(self, data):
        """æ–°é£é™©æ£€æŸ¥é€»è¾‘"""
        # TODO: å®ç°
        return False
```

### æ·»åŠ æ–°çš„APIç«¯ç‚¹

```python
# æ–‡ä»¶: api/l1_advisory_routes.py

@l1_advisory_bp.route('/æ–°ç«¯ç‚¹/<symbol>')
def æ–°åŠŸèƒ½(symbol):
    """åŠŸèƒ½è¯´æ˜"""
    try:
        # 1. éªŒè¯å‚æ•°
        # 2. è°ƒç”¨ä¸šåŠ¡é€»è¾‘
        # 3. è¿”å›ç»“æœ
        return jsonify({'success': True, 'data': result})
    except Exception as e:
        logger.error(f'Error: {e}')
        return jsonify({'success': False, 'error': str(e)}), 500
```

### æ·»åŠ æ–°çš„æ•°æ®æŸ¥è¯¢

```python
# æ–‡ä»¶: database/advisory_repository.py

class AdvisoryRepository:
    def æ–°æŸ¥è¯¢æ–¹æ³•(self, symbol, å‚æ•°):
        """æŸ¥è¯¢è¯´æ˜"""
        try:
            with self.connection.connect() as conn:
                cursor = conn.cursor()
                cursor.execute('SELECT ...', (symbol,))
                return cursor.fetchall()
        except Exception as e:
            logger.error(f"Error: {e}")
            return []
```

---

## âš ï¸ é‡è¦æé†’

### âœ… æ¨èåšæ³•

```python
# âœ… åœ¨æ¨¡å—ä¸­æ·»åŠ æ–°åŠŸèƒ½
# æ–‡ä»¶: l1_engine/risk_gates.pyï¼ˆä»…250è¡Œï¼‰

# âœ… ä½¿ç”¨æ¨¡å—åŒ–å¯¼å…¥
from l1_engine import RiskGates

# âœ… ç¼–å†™å•å…ƒæµ‹è¯•
def test_new_feature():
    # æµ‹è¯•ä»£ç 
    pass
```

### âŒ ç¦æ­¢åšæ³•

```python
# âŒ ä¸è¦åœ¨åŸå§‹å·¨å‹æ–‡ä»¶ä¸­æ·»åŠ ä»£ç 
# market_state_machine_l1.pyï¼ˆ3486è¡Œï¼‰- ä»…ç”¨äºå…¼å®¹

# âŒ ä¸è¦åˆ›å»ºæ–°çš„å·¨å‹æ–‡ä»¶
# å•æ–‡ä»¶å¿…é¡» < 400è¡Œ

# âŒ ä¸è¦è·³è¿‡æµ‹è¯•
# æ ¸å¿ƒé€»è¾‘å¿…é¡»æœ‰æµ‹è¯•è¦†ç›–
```

---

## ğŸ“– å¸¸ç”¨æ–‡æ¡£

| æ–‡æ¡£ | ç”¨é€” | é˜…è¯»æ—¶é—´ |
|------|------|---------|
| `æ–°æ¶æ„å¼€å‘æŒ‡å—.md` | æ—¥å¸¸å¼€å‘è§„èŒƒ | 5åˆ†é’Ÿ |
| `QUICK_START_MODULAR.md` | å¿«é€Ÿä¸Šæ‰‹ | 10åˆ†é’Ÿ |
| `ARCHITECTURE.md` | æ¶æ„æ·±å…¥ç†è§£ | 20åˆ†é’Ÿ |
| `ä¼˜åŒ–å®Œæˆæ€»ç»“.md` | äº†è§£ä¼˜åŒ–æˆæœ | 15åˆ†é’Ÿ |

---

## ğŸ¯ è®°ä½è¿™äº›

### æ ¸å¿ƒåŸåˆ™

```
1. æ¨¡å—åŒ–ä¼˜å…ˆ - æ–°ä»£ç ä½¿ç”¨æ–°æ¶æ„
2. å•ä¸€èŒè´£   - æ¯ä¸ªæ¨¡å—åšä¸€ä»¶äº‹
3. å°è€Œç¾     - å•æ–‡ä»¶ < 400è¡Œ
4. æµ‹è¯•é©±åŠ¨   - TDDå¼€å‘æ–¹å¼
5. æ–‡æ¡£åŒæ­¥   - ä»£ç æ–‡æ¡£ä¸€èµ·æ›´æ–°
```

### å…³é”®è·¯å¾„

```
éœ€æ±‚åˆ†æ â†’ å®šä½æ¨¡å— â†’ æ·»åŠ ä»£ç  â†’ ç¼–å†™æµ‹è¯• â†’ ä»£ç å®¡æŸ¥ â†’ åˆå¹¶
   â†“         â†“         â†“         â†“         â†“         â†“
 5åˆ†é’Ÿ    10åˆ†é’Ÿ    30åˆ†é’Ÿ    15åˆ†é’Ÿ    15åˆ†é’Ÿ    5åˆ†é’Ÿ

æ€»è®¡: ~1.5å°æ—¶ï¼ˆvs ä¼˜åŒ–å‰çš„2-3å°æ—¶ï¼‰
```

---

## ğŸ’¡ Pro Tips

### Tip 1: å¿«é€Ÿå®šä½

```bash
# ä½¿ç”¨grepå¿«é€Ÿæ‰¾åˆ°ç›¸å…³ä»£ç 
grep -r "function_name" l1_engine/

# ä½¿ç”¨findæŸ¥æ‰¾æ–‡ä»¶
find . -name "*validator*"
```

### Tip 2: æ€§èƒ½åˆ†æ

```python
# åœ¨å…³é”®æ–¹æ³•ä¸­æ·»åŠ æ—¥å¿—
import time

def process_data(data):
    start = time.time()
    # å¤„ç†é€»è¾‘
    elapsed = time.time() - start
    logger.info(f"Processed in {elapsed:.3f}s")
```

### Tip 3: è°ƒè¯•æŠ€å·§

```python
# åœ¨æ¨¡å—ä¸­æ·»åŠ debugè¾“å‡º
logger.debug(f"[DEBUG] Variable value: {value}")

# åœ¨Flaskä¸­ä½¿ç”¨æ–­ç‚¹
import pdb; pdb.set_trace()
```

---

## ğŸŠ å¼€å§‹å¼€å‘å§ï¼

**æ‰€æœ‰å·¥å…·å’Œæ–‡æ¡£éƒ½å·²å‡†å¤‡å°±ç»ªï¼**

**å¼€å¯é«˜æ•ˆæ¨¡å—åŒ–å¼€å‘ä¹‹æ—…ï¼** ğŸš€âœ¨

---

**é€ŸæŸ¥è¡¨ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2026-01-23  
**åŸºäºæ¶æ„**: v2.0 Modular  
