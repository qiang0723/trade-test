# L1å›æµ‹æ¡†æ¶ä½¿ç”¨æŒ‡å—

**ç‰ˆæœ¬**: 1.0.0  
**æ—¥æœŸ**: 2026-01-21

---

## ğŸ“‹ ç›®å½•

1. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
2. [åŸºç¡€æ¦‚å¿µ](#åŸºç¡€æ¦‚å¿µ)
3. [ä½¿ç”¨åœºæ™¯](#ä½¿ç”¨åœºæ™¯)
4. [è¯¦ç»†æ•™ç¨‹](#è¯¦ç»†æ•™ç¨‹)
5. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## å¿«é€Ÿå¼€å§‹

### 1åˆ†é’Ÿå¿«é€Ÿæµ‹è¯•

ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®å¿«é€ŸéªŒè¯å›æµ‹æ¡†æ¶ï¼š

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/trade-info

# è¿è¡Œå¿«é€Ÿæµ‹è¯•
python backtest/quick_test.py
```

**è¾“å‡º**ï¼š
- ç”Ÿæˆ7å¤©æ¨¡æ‹Ÿæ•°æ®
- è¿è¡Œå•ä¸€å†³ç­–å’ŒåŒå‘¨æœŸå†³ç­–å›æµ‹
- ç”ŸæˆHTMLæŠ¥å‘Š
- æ‰“å°ç»©æ•ˆæ‘˜è¦

**æŠ¥å‘Šä½ç½®**: `backtest/reports/quick_test_*.html`

---

### 5åˆ†é’ŸçœŸå®å›æµ‹

ä½¿ç”¨çœŸå®å†å²æ•°æ®è¿›è¡Œå›æµ‹ï¼š

```bash
# 1. ç¼–è¾‘é…ç½®æ–‡ä»¶
vim backtest/config.yaml

# ä¿®æ”¹ä»¥ä¸‹å‚æ•°ï¼š
# data:
#   symbol: "BTCUSDT"
#   start_date: "2024-01-01"
#   end_date: "2024-01-31"

# 2. è¿è¡Œå›æµ‹
python backtest/run_backtest.py

# 3. æŸ¥çœ‹æŠ¥å‘Š
open backtest/reports/*.html
```

---

## åŸºç¡€æ¦‚å¿µ

### å›æµ‹æµç¨‹

```
å†å²æ•°æ® â†’ è®¡ç®—æŒ‡æ ‡ â†’ L1å†³ç­– â†’ æ¨¡æ‹Ÿäº¤æ˜“ â†’ ç»©æ•ˆåˆ†æ â†’ ç”ŸæˆæŠ¥å‘Š
```

### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | åŠŸèƒ½ | æ–‡ä»¶ |
|------|------|------|
| HistoricalDataLoader | åŠ è½½å†å²æ•°æ® | `data_loader.py` |
| BacktestEngine | å›æµ‹å¼•æ“ | `backtest_engine.py` |
| PerformanceAnalyzer | ç»©æ•ˆåˆ†æ | `performance_analyzer.py` |
| ReportGenerator | æŠ¥å‘Šç”Ÿæˆ | `report_generator.py` |

### å›æµ‹æ¨¡å¼

| æ¨¡å¼ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|---------|
| single | å•ä¸€å†³ç­– | éªŒè¯åŸºç¡€L1é€»è¾‘ |
| dual | åŒå‘¨æœŸå†³ç­– | éªŒè¯PR-DUALæ•ˆæœ |

### å¹³ä»“ç­–ç•¥

| ç­–ç•¥ | è¯´æ˜ | é£é™© |
|------|------|------|
| signal_reverse | ä¿¡å·åè½¬å¹³ä»“ | ä¸­ |
| stop_loss | å›ºå®šæ­¢æŸ | ä½ |
| time_based | å›ºå®šæŒä»“æ—¶é—´ | ä¸­ |

---

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: éªŒè¯L1é…ç½®

**ç›®æ ‡**: æµ‹è¯•ä¿®æ”¹L1é…ç½®åçš„æ•ˆæœ

**æ­¥éª¤**:

1. ä¿®æ”¹ `config/l1_thresholds.yaml`
2. è¿è¡Œå›æµ‹
3. å¯¹æ¯”ä¿®æ”¹å‰åçš„ç»©æ•ˆ

**ç¤ºä¾‹**:

```bash
# ä¿®æ”¹é…ç½®
vim config/l1_thresholds.yaml

# è¿è¡Œå›æµ‹
python backtest/run_backtest.py

# æŸ¥çœ‹æ”¶ç›Šç‡å˜åŒ–
grep "æ€»æ”¶ç›Šç‡" backtest/reports/*.html
```

---

### åœºæ™¯2: å¯¹æ¯”å•ä¸€ vs åŒå‘¨æœŸ

**ç›®æ ‡**: éªŒè¯åŒå‘¨æœŸå†³ç­–æ˜¯å¦ä¼˜äºå•ä¸€å†³ç­–

**é…ç½®**:

```yaml
# backtest/config.yaml
backtest:
  modes:
    - "single"
    - "dual"
```

**è¿è¡Œ**:

```bash
python backtest/run_backtest.py
```

**ç»“æœ**: è‡ªåŠ¨ç”Ÿæˆå¯¹æ¯”åˆ†æ

---

### åœºæ™¯3: æµ‹è¯•ä¸åŒå¹³ä»“ç­–ç•¥

**ç›®æ ‡**: æ‰¾åˆ°æœ€ä¼˜å¹³ä»“ç­–ç•¥

**é…ç½®**:

```yaml
backtest:
  exit_strategies:
    - "signal_reverse"
    - "stop_loss"
    - "time_based"
```

**è¿è¡Œ**:

```bash
python backtest/run_backtest.py
```

**åˆ†æ**: å¯¹æ¯”å„ç­–ç•¥çš„èƒœç‡ã€æ”¶ç›Šã€å›æ’¤

---

### åœºæ™¯4: å¤šå¸ç§å›æµ‹

**ç›®æ ‡**: æµ‹è¯•L1åœ¨ä¸åŒå¸ç§çš„è¡¨ç°

**è„šæœ¬**:

```python
# multi_symbol_backtest.py
symbols = ["BTCUSDT", "ETHUSDT", "SOLUSDT"]

for symbol in symbols:
    # ä¿®æ”¹é…ç½®
    config['data']['symbol'] = symbol
    
    # è¿è¡Œå›æµ‹
    result = run_backtest(config)
    
    # ä¿å­˜ç»“æœ
    save_result(symbol, result)

# ç”Ÿæˆå¯¹æ¯”æŠ¥å‘Š
generate_comparison_report(results)
```

---

## è¯¦ç»†æ•™ç¨‹

### æ•™ç¨‹1: ä»é›¶å¼€å§‹çš„å®Œæ•´å›æµ‹

#### æ­¥éª¤1: å‡†å¤‡ç¯å¢ƒ

```bash
# å®‰è£…ä¾èµ–
pip install python-binance pyyaml

# åˆ›å»ºç›®å½•
mkdir -p backtest/cache
mkdir -p backtest/reports
```

#### æ­¥éª¤2: é…ç½®å›æµ‹å‚æ•°

ç¼–è¾‘ `backtest/config.yaml`:

```yaml
data:
  symbol: "BTCUSDT"
  start_date: "2024-01-01"
  end_date: "2024-01-31"
  interval: "1m"
  use_cache: true

backtest:
  initial_capital: 10000.0
  position_size: 1.0
  commission_rate: 0.001
  slippage: 0.0005
  
  modes:
    - "single"
  
  exit_strategies:
    - "signal_reverse"

output:
  reports_dir: "backtest/reports"
  generate_html: true
  export_csv: true
  export_json: true
```

#### æ­¥éª¤3: è¿è¡Œå›æµ‹

```bash
python backtest/run_backtest.py
```

**é¢„æœŸè¾“å‡º**:

```
============================================================
ğŸš€ L1 å›æµ‹æ¡†æ¶
============================================================
äº¤æ˜“å¯¹: BTCUSDT
æ—¶é—´èŒƒå›´: 2024-01-01 ~ 2024-01-31
åˆå§‹èµ„é‡‘: $10,000.00
============================================================

ğŸ“Š æ­¥éª¤1: åŠ è½½å†å²æ•°æ®...
âœ… åŠ è½½å®Œæˆ: 44640 æ¡Kçº¿æ•°æ®

ğŸ“ˆ æ­¥éª¤2: å‡†å¤‡å¸‚åœºæ•°æ®...
âœ… å‡†å¤‡å®Œæˆ: 44280 ä¸ªæ•°æ®ç‚¹

ğŸ”„ æ­¥éª¤3: è¿è¡Œå›æµ‹...
  è¿è¡Œ: single + signal_reverse
    æ€»æ”¶ç›Š: 5.23%
    èƒœç‡: 52.34%
    äº¤æ˜“æ¬¡æ•°: 87

ğŸ“ æ­¥éª¤4: ç”ŸæˆæŠ¥å‘Š...
âœ… HTMLæŠ¥å‘Šå·²ç”Ÿæˆ: backtest/reports/BTCUSDT_single_signal_reverse_20260121_153045.html
âœ… CSVæ–‡ä»¶å·²å¯¼å‡º: backtest/reports/BTCUSDT_single_signal_reverse_20260121_153045_trades.csv
âœ… JSONæ–‡ä»¶å·²å¯¼å‡º: backtest/reports/BTCUSDT_single_signal_reverse_20260121_153045.json

============================================================
âœ… å›æµ‹å®Œæˆï¼
ğŸ“ æŠ¥å‘Šç›®å½•: backtest/reports
============================================================
```

#### æ­¥éª¤4: æŸ¥çœ‹æŠ¥å‘Š

```bash
# åœ¨æµè§ˆå™¨æ‰“å¼€HTMLæŠ¥å‘Š
open backtest/reports/BTCUSDT_single_signal_reverse_*.html

# æˆ–ä½¿ç”¨Excelæ‰“å¼€CSV
open backtest/reports/BTCUSDT_single_signal_reverse_*_trades.csv
```

---

### æ•™ç¨‹2: ç¼–å†™è‡ªå®šä¹‰å›æµ‹è„šæœ¬

```python
# my_backtest.py
import sys
import os
sys.path.insert(0, os.path.abspath('.'))

from backtest import (
    HistoricalDataLoader,
    BacktestEngine,
    PerformanceAnalyzer,
    ReportGenerator
)

# 1. åŠ è½½æ•°æ®
loader = HistoricalDataLoader()
klines = loader.load_historical_data(
    symbol="BTCUSDT",
    start_date="2024-01-01",
    end_date="2024-01-31",
    interval="1m"
)

# 2. å‡†å¤‡å¸‚åœºæ•°æ®
market_data_list = []
for kline in klines:
    data = loader.prepare_market_data(klines, kline['timestamp'])
    if data:
        market_data_list.append(data)

# 3. è¿è¡Œå›æµ‹
engine = BacktestEngine(
    initial_capital=10000.0,
    position_size=1.0,
    commission_rate=0.001,
    slippage=0.0005
)

result = engine.run_backtest(
    symbol="BTCUSDT",
    market_data_list=market_data_list,
    mode="single",
    exit_strategy="signal_reverse"
)

# 4. åˆ†æç»“æœ
trade_analysis = PerformanceAnalyzer.analyze_trades(result['trades'])
print(f"èƒœç‡: {trade_analysis['win_rate']*100:.2f}%")
print(f"ç›ˆäºæ¯”: {trade_analysis['profit_factor']:.2f}")

# 5. ç”ŸæˆæŠ¥å‘Š
ReportGenerator.generate_html_report(result, "my_report.html")

print("âœ… å›æµ‹å®Œæˆï¼")
```

---

## æœ€ä½³å®è·µ

### 1. æ•°æ®ç®¡ç†

**âœ… æ¨è**:
- é¦–æ¬¡è¿è¡Œä½¿ç”¨ `use_cache: false` è·å–æœ€æ–°æ•°æ®
- åç»­è¿è¡Œä½¿ç”¨ `use_cache: true` åŠ é€Ÿ
- å®šæœŸæ¸…ç†ç¼“å­˜ç›®å½•ï¼ˆæ¯æœˆï¼‰

**âŒ é¿å…**:
- ä¸è¦åœ¨ç½‘ç»œä¸ç¨³å®šæ—¶è·å–æ•°æ®
- ä¸è¦é¢‘ç¹è¯·æ±‚Binance APIï¼ˆä¼šè¢«é™æµï¼‰

### 2. å›æµ‹å‘¨æœŸ

**âœ… æ¨è**:
- çŸ­æœŸæµ‹è¯•: 7-14å¤©
- ä¸­æœŸæµ‹è¯•: 1-3ä¸ªæœˆ
- é•¿æœŸæµ‹è¯•: 6-12ä¸ªæœˆ

**âŒ é¿å…**:
- è¿‡çŸ­å‘¨æœŸï¼ˆ< 3å¤©ï¼‰ï¼šæ ·æœ¬ä¸è¶³
- è¿‡é•¿å‘¨æœŸï¼ˆ> 1å¹´ï¼‰ï¼šæ•°æ®é‡å¤§ï¼Œè€—æ—¶é•¿

### 3. å‚æ•°è®¾ç½®

**åˆå§‹èµ„é‡‘**:
- æµ‹è¯•: $10,000
- å®ç›˜æ¨¡æ‹Ÿ: å®é™…èµ„é‡‘

**ä»“ä½å¤§å°**:
- ä¿å®ˆ: 0.5 (50%)
- ä¸­ç­‰: 1.0 (100%)
- æ¿€è¿›: 2.0 (200%, ä½¿ç”¨æ æ†)

**æ‰‹ç»­è´¹**:
- ç°è´§: 0.001 (0.1%)
- åˆçº¦: 0.0004 (0.04%)

**æ»‘ç‚¹**:
- ä½æµåŠ¨æ€§: 0.001 (0.1%)
- é«˜æµåŠ¨æ€§: 0.0005 (0.05%)

### 4. ç»“æœè§£è¯»

**å¥½çš„ç­–ç•¥ç‰¹å¾**:
- æ€»æ”¶ç›Š > Buy & Hold
- èƒœç‡ > 50%
- å¤æ™®æ¯”ç‡ > 1.0
- æœ€å¤§å›æ’¤ < 20%
- ç›ˆäºæ¯” > 1.5

**è­¦å‘Šä¿¡å·**:
- èƒœç‡å¾ˆé«˜ä½†æ”¶ç›Šä½ï¼ˆå¯èƒ½è¿‡åº¦ä¿å®ˆï¼‰
- æ”¶ç›Šå¾ˆé«˜ä½†å›æ’¤å¤§ï¼ˆé£é™©è¿‡é«˜ï¼‰
- äº¤æ˜“æ¬¡æ•°è¿‡å¤šï¼ˆè¿‡åº¦äº¤æ˜“ï¼‰
- äº¤æ˜“æ¬¡æ•°è¿‡å°‘ï¼ˆä¿¡å·ä¸è¶³ï¼‰

---

## å¸¸è§é—®é¢˜

### Q1: é¦–æ¬¡è¿è¡ŒæŠ¥é”™ "No module named 'binance'"

**A**: å®‰è£…ä¾èµ–

```bash
pip install python-binance
```

### Q2: æ•°æ®åŠ è½½å¾ˆæ…¢

**A**: 
1. é¦–æ¬¡è¿è¡Œéœ€è¦ä»Binance APIè·å–æ•°æ®ï¼Œå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿ
2. åç»­è¿è¡Œä½¿ç”¨ç¼“å­˜ä¼šå¾ˆå¿«
3. å¯ä»¥å‡å°å›æµ‹å‘¨æœŸ

### Q3: å›æµ‹ç»“æœä¸å®ç›˜ä¸ç¬¦

**A**: å¯èƒ½åŸå› ï¼š
1. æ‰‹ç»­è´¹å’Œæ»‘ç‚¹è®¾ç½®ä¸å‡†ç¡®
2. å›æµ‹æœŸé—´å¸‚åœºç¯å¢ƒç‰¹æ®Š
3. L1é…ç½®ä¸å®ç›˜ä¸ä¸€è‡´
4. æ•°æ®è´¨é‡é—®é¢˜

**è§£å†³**:
- ä½¿ç”¨æ›´çœŸå®çš„æ‰‹ç»­è´¹å’Œæ»‘ç‚¹
- æµ‹è¯•å¤šä¸ªæ—¶é—´æ®µ
- ç¡®ä¿é…ç½®ä¸€è‡´
- æ£€æŸ¥æ•°æ®å®Œæ•´æ€§

### Q4: å¦‚ä½•ä¼˜åŒ–ç­–ç•¥

**A**: 
1. è°ƒæ•´L1é…ç½®é˜ˆå€¼
2. å°è¯•ä¸åŒå¹³ä»“ç­–ç•¥
3. ä¼˜åŒ–ä»“ä½ç®¡ç†
4. å¢åŠ é£é™©æ§åˆ¶

**ä¸è¦**:
- è¿‡åº¦æ‹Ÿåˆå†å²æ•°æ®
- é¢‘ç¹ä¿®æ”¹å‚æ•°
- å¿½è§†é£é™©æŒ‡æ ‡

### Q5: å›æµ‹æŠ¥å‘Šåœ¨å“ªé‡Œ

**A**: 
- HTML: `backtest/reports/*.html`
- CSV: `backtest/reports/*_trades.csv`
- JSON: `backtest/reports/*.json`

### Q6: å¦‚ä½•å¯¹æ¯”å¤šä¸ªç­–ç•¥

**A**: 

```python
# è¿è¡Œå¤šä¸ªå›æµ‹
results = []
for config in configs:
    result = run_backtest(config)
    results.append(result)

# å¯¹æ¯”åˆ†æ
comparison = PerformanceAnalyzer.compare_strategies(
    results[0], results[1]
)
print(comparison)
```

---

## è¿›é˜¶æŠ€å·§

### 1. å‚æ•°ä¼˜åŒ–

ä½¿ç”¨ç½‘æ ¼æœç´¢æ‰¾åˆ°æœ€ä¼˜å‚æ•°ï¼š

```python
# å‚æ•°èŒƒå›´
position_sizes = [0.5, 1.0, 2.0]
commission_rates = [0.0004, 0.001, 0.002]

best_result = None
best_return = -float('inf')

for pos_size in position_sizes:
    for comm_rate in commission_rates:
        engine = BacktestEngine(
            position_size=pos_size,
            commission_rate=comm_rate
        )
        result = engine.run_backtest(...)
        
        if result['performance']['total_return'] > best_return:
            best_return = result['performance']['total_return']
            best_result = result

print(f"æœ€ä¼˜å‚æ•°: pos_size={best_result['position_size']}")
```

### 2. æ»šåŠ¨çª—å£å›æµ‹

é¿å…è¿‡æ‹Ÿåˆï¼š

```python
# å°†æ•°æ®åˆ†ä¸ºå¤šä¸ªçª—å£
windows = split_data_into_windows(data, window_size=30)

results = []
for window in windows:
    result = run_backtest(window)
    results.append(result)

# è®¡ç®—å¹³å‡ç»©æ•ˆ
avg_return = sum(r['performance']['total_return'] for r in results) / len(results)
```

### 3. è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿ

è¯„ä¼°ç­–ç•¥ç¨³å®šæ€§ï¼š

```python
# éšæœºæ‰“ä¹±äº¤æ˜“é¡ºåº
import random

for i in range(1000):
    shuffled_trades = random.sample(trades, len(trades))
    result = calculate_performance(shuffled_trades)
    results.append(result)

# åˆ†æåˆ†å¸ƒ
print(f"95%ç½®ä¿¡åŒºé—´: {np.percentile(results, [2.5, 97.5])}")
```

---

## æ€»ç»“

å›æµ‹æ¡†æ¶æ˜¯éªŒè¯L1å†³ç­–æœ‰æ•ˆæ€§çš„é‡è¦å·¥å…·ã€‚é€šè¿‡ç³»ç»Ÿçš„å›æµ‹åˆ†æï¼Œå¯ä»¥ï¼š

1. âœ… éªŒè¯ç­–ç•¥é€»è¾‘
2. âœ… ä¼˜åŒ–å‚æ•°é…ç½®
3. âœ… è¯„ä¼°é£é™©æ”¶ç›Š
4. âœ… å¯¹æ¯”ä¸åŒæ–¹æ¡ˆ

**è®°ä½**:
- å›æµ‹ä¸ç­‰äºå®ç›˜
- å†å²è¡¨ç°ä¸ä»£è¡¨æœªæ¥
- é£é™©æ§åˆ¶æ°¸è¿œç¬¬ä¸€

---

**ç›¸å…³æ–‡æ¡£**:
- [å›æµ‹æ¡†æ¶README](../backtest/README.md)
- [L1å¹³å°è¯¦è§£](./å¹³å°è¯¦è§£3.2.md)
- [PR-DUALæ–‡æ¡£](./PR-DUAL_åŒå‘¨æœŸç‹¬ç«‹ç»“è®º.md)
