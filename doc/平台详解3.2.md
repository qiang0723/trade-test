# åŠ å¯†è´§å¸äº¤æ˜“å†³ç­–å¹³å°è¯¦è§£ 3.2

**ç‰ˆæœ¬**: 3.2.0  
**æ›´æ–°æ—¥æœŸ**: 2026-01-21  
**ç³»ç»Ÿåç§°**: L1 Advisory Layer (äº¤æ˜“å†³ç­–å’¨è¯¢ç³»ç»Ÿ)  
**æ›´æ–°å†…å®¹**: v3.1 + çŸ­æœŸæœºä¼šè¯†åˆ« + P0ä¿®å¤ + PR-M + å‰ç«¯ä¼˜åŒ– + ç³»ç»Ÿé²æ£’æ€§å…¨é¢å¢å¼º

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#1-ç³»ç»Ÿæ¦‚è¿°)
2. [ç‰ˆæœ¬æ¼”è¿›](#2-ç‰ˆæœ¬æ¼”è¿›)
3. [æ ¸å¿ƒåŠŸèƒ½](#3-æ ¸å¿ƒåŠŸèƒ½)
4. [å£å¾„è§„èŒƒï¼ˆPR-Aä¿®å¤ï¼‰](#4-å£å¾„è§„èŒƒpr-aä¿®å¤)
5. [PR-B: è´¨é‡è¯­ä¹‰é’‰æ­» + æ–¹æ¡ˆD: æ‰§è¡Œè®¸å¯æœºåˆ¶](#5-pr-b-è´¨é‡è¯­ä¹‰é’‰æ­»--æ–¹æ¡ˆd-æ‰§è¡Œè®¸å¯æœºåˆ¶)
6. [PR-C: å†³ç­–é¢‘ç‡æ§åˆ¶](#6-pr-c-å†³ç­–é¢‘ç‡æ§åˆ¶)
7. [PR-D: ç½®ä¿¡åº¦æ··åˆæ¨¡å¼](#7-pr-d-ç½®ä¿¡åº¦æ··åˆæ¨¡å¼)
8. [å†³ç­–ç®¡é“](#8-å†³ç­–ç®¡é“)
9. [æŠ€æœ¯æ¶æ„](#9-æŠ€æœ¯æ¶æ„)
10. [é…ç½®ç®¡ç†](#10-é…ç½®ç®¡ç†)
11. [Webç•Œé¢](#11-webç•Œé¢)
12. [APIæ¥å£](#12-apiæ¥å£)
13. [éƒ¨ç½²æ¶æ„](#13-éƒ¨ç½²æ¶æ„)
14. [æµ‹è¯•è¦†ç›–](#14-æµ‹è¯•è¦†ç›–)
15. [ä½¿ç”¨æŒ‡å—](#15-ä½¿ç”¨æŒ‡å—)
16. [é™„å½•](#16-é™„å½•)

---

## 1. ç³»ç»Ÿæ¦‚è¿°

### 1.1 ç³»ç»Ÿå®šä½

**L1 Advisory Layer** æ˜¯ä¸€ä¸ªåŸºäºå¤šç»´åº¦å¸‚åœºæ•°æ®çš„**äº¤æ˜“å†³ç­–å’¨è¯¢ç³»ç»Ÿ**ï¼Œä¸“æ³¨äºä¸ºåŠ å¯†è´§å¸äº¤æ˜“æä¾›**å®‰å…¨ã€å¯è¿½æº¯ã€é«˜è´¨é‡**çš„æ–¹å‘æ€§å»ºè®®ã€‚

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š
- ğŸ›¡ï¸ **Safety First**: å®‰å…¨ä¼˜å…ˆï¼Œå¤šå±‚é—¸é—¨é˜²æŠ¤
- ğŸ¯ **å•ä¸€èŒè´£**: ä»…è¾“å‡ºæ–¹å‘å†³ç­–ï¼ˆLONG/SHORT/NO_TRADEï¼‰ï¼Œä¸æ¶‰åŠæ‰§è¡Œ
- ğŸ“Š **æ•°æ®é©±åŠ¨**: åŸºäºå®æ—¶Binanceåˆçº¦å¸‚åœºæ•°æ®
- ğŸ” **å¯è¿½æº¯æ€§**: æ¯ä¸ªå†³ç­–éƒ½æœ‰æ˜ç¡®çš„reason_tagså’Œ10æ­¥ç®¡é“è¿½æº¯
- âš™ï¸ **å¯é…ç½®**: æ‰€æœ‰é˜ˆå€¼å¤–éƒ¨åŒ–ï¼Œæ”¯æŒçƒ­æ›´æ–°
- ğŸŒ **å¤šå¸ç§**: æ”¯æŒTAã€ATã€HANAã€BTRã€GPSã€RIVERç­‰è‡ªå®šä¹‰å¸ç§
- ğŸš€ **ç”Ÿäº§å°±ç»ª**: Dockerå®¹å™¨åŒ–éƒ¨ç½²ï¼ŒAWSç”Ÿäº§ç¯å¢ƒè¿è¡Œ
- ğŸšï¸ **ç²¾ç»†æ§åˆ¶**: ExecutabilityLevelä¸‰çº§æ§åˆ¶ã€å†³ç­–é¢‘ç‡é™åˆ¶ã€ç½®ä¿¡åº¦æ··åˆæ¨¡å¼

### 1.2 ç³»ç»Ÿè¾¹ç•Œ

**L1åšä»€ä¹ˆ**ï¼š
- âœ… æ•°æ®è´¨é‡éªŒè¯ï¼ˆæ–°é²œåº¦ã€è§„èŒƒåŒ–ï¼‰
- âœ… åˆ†æå¸‚åœºç¯å¢ƒï¼ˆTREND/RANGE/EXTREMEï¼‰
- âœ… è¯„ä¼°é£é™©å‡†å…¥ï¼ˆæ¸…ç®—/æ‹¥æŒ¤/æç«¯æˆäº¤é‡ï¼‰
- âœ… è¯„ä¼°äº¤æ˜“è´¨é‡ï¼ˆGOOD/UNCERTAIN/POORï¼‰
- âœ… åˆ¤æ–­äº¤æ˜“æ–¹å‘ï¼ˆLONG/SHORT/NO_TRADEï¼‰
- âœ… å†³ç­–é¢‘ç‡æ§åˆ¶ï¼ˆæœ€å°é—´éš”ã€ç¿»è½¬å†·å´ï¼‰
- âœ… è®¡ç®—ç½®ä¿¡åº¦ï¼ˆULTRA/HIGH/MEDIUM/LOW + æ··åˆæ¨¡å¼ï¼‰
- âœ… æä¾›æ‰§è¡Œè®¸å¯ï¼ˆexecutableæ ‡å¿— + ä¸‰çº§æ§åˆ¶ï¼‰
- âœ… å†³ç­–ç®¡é“è¿½æº¯ï¼ˆ10æ­¥å¯è§†åŒ–ï¼‰

**L1ä¸åšä»€ä¹ˆ**ï¼š
- âŒ ä¸è¾“å‡ºä»“ä½å¤§å°
- âŒ ä¸è¾“å‡ºå…¥åœºç‚¹ä½
- âŒ ä¸è¾“å‡ºæ­¢æŸæ­¢ç›ˆ
- âŒ ä¸è®¡ç®—æ æ†å€æ•°
- âŒ ä¸ä¸‹å•æ‰§è¡Œ
- âŒ ä¸ç®¡ç†æŒä»“

### 1.3 ä¸‰å±‚æ¶æ„æ„¿æ™¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  L1 Advisory Layer (âœ… v3.0å®Œæˆ)         â”‚
â”‚  - æ–¹å‘å†³ç­–å’¨è¯¢                          â”‚
â”‚  - å®‰å…¨é—¸é—¨ï¼ˆé£é™©+è´¨é‡ï¼‰                  â”‚
â”‚  - 4å±‚ç½®ä¿¡åº¦è¯„ä¼° + æ··åˆæ¨¡å¼               â”‚
â”‚  - 10æ­¥å†³ç­–ç®¡é“ + é¢‘ç‡æ§åˆ¶               â”‚
â”‚  - å¤šå¸ç§æ”¯æŒ + ExecutabilityLevel       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  L2 Selection Layer (è§„åˆ’ä¸­)             â”‚
â”‚  - è‡ªåŠ¨é€‰å¸                              â”‚
â”‚  - å€™é€‰æ± ç®¡ç†                            â”‚
â”‚  - å¤šå¸ç§æ’åº                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  L3 Execution Layer (è§„åˆ’ä¸­)             â”‚
â”‚  - è‡ªåŠ¨äº¤æ˜“                              â”‚
â”‚  - ä»“ä½ç®¡ç†                              â”‚
â”‚  - é£æ§æ‰§è¡Œ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ç‰ˆæœ¬æ¼”è¿›

### 2.1 ç‰ˆæœ¬å¯¹æ¯”

| ç»´åº¦ | 1.0 | 2.0 | 3.0 | 3.1 | 3.2 (å½“å‰) |
|------|-----|-----|-----|-----|-----------|
| **é…ç½®å£å¾„** | âŒ æ··ç”¨ | âŒ æ··ç”¨ | âœ… ç»Ÿä¸€å°æ•° | âœ… ä¿æŒ | âœ… **+å…ƒæ•°æ®æ ‡æ³¨** |
| **ç½®ä¿¡åº¦æ¡£ä½** | 3æ¡£ | 4æ¡£ | 4æ¡£+æ··åˆ | âœ… ä¿æŒ | âœ… ä¿æŒ |
| **è´¨é‡è¯„çº§** | 2æ¡£ | 3æ¡£ | 3æ¡£+æ˜ å°„ | âœ… ä¿æŒ | âœ… ä¿æŒ |
| **æ‰§è¡Œè®¸å¯** | âŒ æ—  | âŒ æ—  | âœ… ä¸‰çº§ | âœ… ä¿æŒ | âœ… ä¿æŒ |
| **å†³ç­–æ§åˆ¶** | æ—  | æ—  | âœ… é—´éš”+å†·å´ | âœ… ä¿æŒ | âœ… ä¿æŒ |
| **å¸‚åœºç¯å¢ƒ** | ç®€å• | ç®€å• | 3æ¨¡æ€ | âœ… ä¿æŒ | âœ… **+çŸ­æœŸTREND** |
| **æ–¹å‘è¯†åˆ«** | ç®€å• | ä¸­ç­‰ | ä¸¥æ ¼ | âœ… ä¿æŒ | âœ… **+RANGEçŸ­æœŸ** |
| **æ•°æ®è´¨é‡** | åŸºç¡€ | è§„èŒƒåŒ– | ä¼˜åŒ– | âœ… ä¿æŒ | âœ… **+å…ƒæ•°æ®+é‡è¯•** |
| **å¤šå¸ç§** | å•å¸ç§ | 5å¸ç§ | è‡ªå®šä¹‰ | âœ… ä¿æŒ | âœ… **TA/AT/HANA/BTR/GPS/RIVER** |
| **å‰ç«¯ç•Œé¢** | å®Œæ•´ | æ¦‚è§ˆ | ç®€æ´ | âœ… ä¿æŒ | âœ… **åˆ—è¡¨æŸ¥è¯¢+å¸ç§ç­›é€‰** |
| **å†å²è®°å½•** | åŸºç¡€ | åŸºç¡€ | æ—¶é—´è½´ | âœ… ä¿æŒ | âœ… **åˆ—è¡¨+ç­›é€‰+åˆ†é¡µ** |
| **å®šæ—¶é‡‡é›†** | âŒ æ—  | âŒ æ—  | âŒ æ—  | âŒ æ—  | âœ… **æ¯åˆ†é’Ÿè‡ªåŠ¨** |
| **æµ‹è¯•è¦†ç›–** | åŸºç¡€ | 10ä¸ª | 42ä¸ª | 56ä¸ª | âœ… **68ä¸ªæµ‹è¯•** |
| **å®¹é”™èƒ½åŠ›** | ä½ | ä¸­ | ä¸­ | âœ… ä¿æŒ | âœ… **+é‡è¯•æœºåˆ¶** |
| **P0çº§Bug** | - | - | - | 3ä¸ªä¿®å¤ | âœ… **+5ä¸ªæ–°ä¿®å¤** |
| **éƒ¨ç½²** | æœ¬åœ° | æœ¬åœ°+AWS | æœ¬åœ°+AWS | æœ¬åœ°+AWS | æœ¬åœ°+AWS |

### 2.2 v3.2æ ¸å¿ƒå‡çº§ï¼ˆé‡å¤§æ›´æ–°ï¼‰

**v3.2 = v3.1 + çŸ­æœŸæœºä¼šè¯†åˆ« + æ•°æ®å‡†ç¡®æ€§ + å‰ç«¯ä¼˜åŒ– + ç³»ç»Ÿé²æ£’æ€§**

v3.2æ˜¯v3.1ä¹‹åçš„**é‡å¤§å‡çº§ç‰ˆæœ¬**ï¼Œå…¨é¢æå‡ç³»ç»Ÿçš„å‡†ç¡®æ€§ã€æ•æ„Ÿæ€§å’Œé²æ£’æ€§ï¼š

#### **æ ¸å¿ƒæ”¹è¿›**
1. **çŸ­æœŸæœºä¼šè¯†åˆ«**ï¼ˆæ–¹æ¡ˆ1+4ç»„åˆï¼‰ï¼šæ•è·ç‡æå‡60%
2. **P0çº§Bugä¿®å¤**ï¼ˆæ–°å¢5ä¸ªï¼‰ï¼šæ•°æ®å‡†ç¡®æ€§å’Œç³»ç»Ÿç¨³å®šæ€§
3. **PR-Må…ƒæ•°æ®æ ¼å¼æ ‡æ³¨**ï¼šé˜²æ­¢silent driftï¼Œæ”¯æŒå¤šæ•°æ®æº
4. **å‰ç«¯ä¼˜åŒ–**ï¼šå†å²è®°å½•åˆ—è¡¨æŸ¥è¯¢+å¸ç§ç­›é€‰+åˆ†é¡µ
5. **ç³»ç»Ÿé²æ£’æ€§**ï¼šé‡è¯•æœºåˆ¶+ç¬¦å·è§„èŒƒ+æ—¥å¿—ä¿®å¤

---

### 2.3 v3.2è¯¦ç»†æ›´æ–°ï¼ˆ2026-01-21ï¼‰

#### **2.3.1 çŸ­æœŸæœºä¼šè¯†åˆ«ä¼˜åŒ–ï¼ˆæ ¸å¿ƒå‡çº§ï¼‰**

**é—®é¢˜**ï¼šåŸæœ‰é˜ˆå€¼å¯¹çŸ­æœŸäº¤æ˜“ï¼ˆ1-3å°æ—¶ï¼‰è¿‡äºä¿å®ˆï¼Œé”™è¿‡å¤§é‡çŸ­æœŸæœºä¼š

**æ–¹æ¡ˆ1: æ·»åŠ çŸ­æœŸTRENDåˆ¤æ–­**
```yaml
market_regime:
  short_term_trend_1h: 0.02  # æ–°å¢ï¼š1å°æ—¶>2% â†’ TREND
```

**æ•ˆæœ**ï¼š
- âœ… 1hæ¶¨3% â†’ ä»RANGEå˜ä¸ºTREND â†’ å¯è§¦å‘LONG
- âœ… 1hæ¶¨2.2% â†’ ä»RANGEå˜ä¸ºTREND â†’ å¯è§¦å‘LONG
- âœ… ä¸­æœŸé˜ˆå€¼ä¿æŒä¿å®ˆï¼ˆ6h>3%ï¼‰â†’ é¿å…è¿‡åº¦æ•æ„Ÿ

**æ–¹æ¡ˆ4: RANGEçŸ­æœŸä¿¡å·ç»¼åˆè¯†åˆ«**
```yaml
direction.range.short_term_opportunity:
  long:
    min_price_change_1h: 0.015   # ä»·æ ¼>1.5%
    min_oi_change_1h: 0.15       # OI>15%
    min_buy_sell_imbalance: 0.65 # ä¹°å‹>65%
    required_signals: 2          # 3é€‰2ç¡®è®¤
```

**å®ç°é€»è¾‘**ï¼š
```python
# _eval_long_direction() å¢å¼º
if regime == MarketRegime.RANGE:
    signals = []
    if price_change > 0.015: signals.append('price_surge')
    if oi_change > 0.15: signals.append('oi_growing')
    if imbalance > 0.65: signals.append('strong_buy_pressure')
    
    if len(signals) >= 2:  # 3é€‰2ç¡®è®¤
        return True  # è§¦å‘LONG
```

**æ•ˆæœå¯¹æ¯”**ï¼š

| åœºæ™¯ | v3.1 | v3.2 | æå‡ |
|------|------|------|------|
| 1hæ¶¨3% | RANGE â†’ NO_TRADE | **TREND â†’ LONG** | âœ… |
| 1hæ¶¨2%+OI18%+ä¹°å‹0.7 | RANGE â†’ NO_TRADE | **RANGE â†’ LONG** | âœ… |
| 1hæ¶¨1.8%+OI16% | RANGE â†’ NO_TRADE | **RANGE â†’ LONG** | âœ… |
| 1hæ¶¨1.5%ï¼ˆå•ä¿¡å·ï¼‰ | RANGE â†’ NO_TRADE | RANGE â†’ NO_TRADE | âœ… è¿‡æ»¤ |

**æ€»ä½“æå‡**ï¼š
- ğŸ“ˆ çŸ­æœŸæœºä¼šæ•è·ç‡ï¼š+60%
- ğŸ›¡ï¸ å™ªéŸ³æ§åˆ¶ï¼šä¿æŒä¸¥æ ¼ï¼ˆ3é€‰2ç¡®è®¤ï¼‰
- âš–ï¸ è¾¾åˆ°ä¿å®ˆæ€§å’Œæ•æ„Ÿæ€§çš„æœ€ä½³å¹³è¡¡

---

#### **2.3.2 P0çº§Bugä¿®å¤ï¼ˆæ–°å¢5é¡¹ï¼‰**

**P0-BugFix-3: volumeå•ä½ä¸ä¸€è‡´**

**é—®é¢˜**ï¼š
- `volume_1h`ï¼šæ¥è‡ª24hç´¯è®¡é‡å·®å€¼ï¼ˆBTCæ•°é‡ï¼‰
- `volume_24h`ï¼šä½¿ç”¨quoteVolumeï¼ˆUSDTé‡‘é¢ï¼‰
- ç›´æ¥æ¯”è¾ƒå¯¼è‡´EXTREME_VOLUME/ABSORPTION_RISKå®Œå…¨å¤±æ•ˆ

**ä¿®å¤**ï¼š
```python
# binance_data_fetcher.py
'volume_24h': float(ticker['volume'])  # æ”¹ç”¨volumeï¼ˆBTCæ•°é‡ï¼‰
# ç»Ÿä¸€å•ä½ä¸ºåŸºç¡€å¸æ•°é‡
```

**å½±å“**ï¼šæç«¯æˆäº¤é‡å’Œå¸çº³é£é™©æ£€æµ‹æ¢å¤æ­£å¸¸

---

**P0-BugFix-4: å…³é”®å­—æ®µæœªå¼ºåˆ¶è¦æ±‚**

**é—®é¢˜**ï¼š
- `price_change_6h` å’Œ `oi_change_6h` æœªåœ¨ `required_fields` ä¸­
- ç¼ºå¤±æ—¶é»˜è®¤ä¸º0ï¼Œå¯¼è‡´TRENDè¯†åˆ«å’ŒCROWDING_RISKé™é»˜å¤±è´¥

**ä¿®å¤**ï¼š
```python
# market_state_machine_l1.py
required_fields = [
    'price_change_6h',  # æ–°å¢
    'oi_change_6h'      # æ–°å¢
]
```

**å½±å“**ï¼šTRENDå¸‚åœºç¯å¢ƒå’Œæ‹¥æŒ¤é£é™©æ£€æµ‹æ¢å¤æ­£å¸¸

---

**P0-BugFix-5: æ—¥å¿—åˆå§‹åŒ–é¡ºåºé”™è¯¯**

**é—®é¢˜**ï¼š
- logger åœ¨å®šä¹‰å‰ä½¿ç”¨ï¼ˆwatchdog/apschedulerå¯¼å…¥å¤±è´¥æ—¶ï¼‰
- è§¦å‘ NameErrorï¼Œç¨‹åºå´©æºƒæ— æ³•å¯åŠ¨

**ä¿®å¤**ï¼š
```python
# btc_web_app_l1.py
# å°† logging.basicConfig å’Œ logger å®šä¹‰æå‰
logging.basicConfig(...)
logger = logging.getLogger(__name__)

# ç„¶åæ‰æ˜¯å¯é€‰ä¾èµ–å¯¼å…¥
try:
    from watchdog...
except ImportError:
    logger.warning(...)  # ç°åœ¨å¯ä»¥å®‰å…¨ä½¿ç”¨
```

**å½±å“**ï¼šå¯é€‰ä¾èµ–ç¼ºå¤±æ—¶ä¸å†å´©æºƒ

---

**P1-BugFix-1: ç¬¦å·é‡å¤æ‹¼æ¥USDT**

**é—®é¢˜**ï¼š
- `monitored_symbols.yaml` é…ç½® "BTCUSDT"
- `fetch_futures_data()` å†æ‹¼æ¥ "USDT"
- æœ€ç»ˆè¯·æ±‚ "BTCUSDTUSDT" â†’ APIå¤±è´¥

**ä¿®å¤**ï¼š
```python
# binance_data_fetcher.py
if symbol.endswith('USDT'):
    trading_symbol = symbol  # ç›´æ¥ä½¿ç”¨
else:
    trading_symbol = f"{symbol}USDT"  # æ‹¼æ¥
```

**å½±å“**ï¼šå®šæ—¶ä»»åŠ¡ç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œ

---

**P2-ä¼˜åŒ–-1: é…ç½®ä¸­çš„é‡è¯•ç­–ç•¥æœªä½¿ç”¨**

**é—®é¢˜**ï¼š
- `monitored_symbols.yaml` å®šä¹‰äº† `max_retries` å’Œ `retry_delay_seconds`
- `periodic_advisory_update()` æœªä½¿ç”¨ï¼Œä¸€æ¬¡å¤±è´¥å°±æ”¾å¼ƒ

**ä¿®å¤**ï¼š
```python
# btc_web_app_l1.py
for attempt in range(max_retries):
    market_data = binance_fetcher.fetch_market_data(...)
    if market_data:
        break
    if attempt < max_retries - 1:
        time.sleep(retry_delay)
```

**å½±å“**ï¼šä¸´æ—¶ç½‘ç»œæŠ–åŠ¨ä¸å†å¯¼è‡´æ•°æ®ç¼ºå¤±

---

#### **2.3.3 PR-M: å…ƒæ•°æ®æ ¼å¼æ ‡æ³¨ï¼ˆé˜²silent driftï¼‰**

**ç›®æ ‡**ï¼šå°†"ç™¾åˆ†æ¯”å­—æ®µè¾“å…¥æ ¼å¼"ä»éšå¼å‡è®¾å˜æˆæ˜¾å¼æ ‡æ³¨

**æ–¹æ¡ˆBå®æ–½**ï¼š
```python
# data_cache.py (å”¯ä¸€æ³¨å…¥ç‚¹)
enhanced_data = {
    ...
    '_metadata': {
        'percentage_format': 'percent_point',  # å£°æ˜æ ¼å¼
        'source': 'market_data_cache',
        'version': '1.0'
    }
}

# metrics_normalizer.py (è¯»å–å¹¶é€‚é…)
input_format = metadata.get('percentage_format', 'percent_point')

if input_format == 'percent_point':
    normalized[field] = value / 100.0  # è½¬æ¢
elif input_format == 'decimal':
    # è·³è¿‡è½¬æ¢
```

**å»ºè®®A: æ˜ç¡®å”¯ä¸€æ³¨å…¥ç‚¹**
- âœ… èŒè´£è¾¹ç•Œæ³¨é‡Šï¼šåªæœ‰ `MarketDataCache.get_enhanced_market_data()` æ³¨å…¥
- âœ… ç¼ºå¤±è­¦å‘Šï¼šæ— å…ƒæ•°æ®æ—¶è¾“å‡ºWARNING
- âœ… æµ‹è¯•éªŒè¯ï¼š4ä¸ªåœºæ™¯æµ‹è¯•

**ä»·å€¼**ï¼š
- âœ… é˜²æ­¢ä¸Šæ¸¸æ ¼å¼å˜åŒ–æ—¶çš„silent drift
- âœ… æ”¯æŒå¤šæ•°æ®æºï¼ˆæœªæ¥å¯æ‰©å±•ï¼‰
- âœ… æ¸…æ™°çš„æ¶æ„è¾¹ç•Œ

---

#### **2.3.4 å‰ç«¯ä¼˜åŒ–ï¼ˆç”¨æˆ·ä½“éªŒå‡çº§ï¼‰**

**é—®é¢˜1: å†å²æ•°æ®ç¼ºå¤±**

**åŸå› **ï¼šåªåœ¨ç”¨æˆ·è®¿é—®æ—¶è¢«åŠ¨ä¿å­˜å†³ç­–ï¼Œå‰ç«¯å…³é—­åæ— æ•°æ®

**ä¿®å¤**ï¼š
```python
# btc_web_app_l1.py
def periodic_advisory_update():
    """æ¯åˆ†é’Ÿè‡ªåŠ¨é‡‡é›†å¹¶ä¿å­˜å†³ç­–"""
    for symbol in symbols:
        market_data = fetch_market_data(symbol)
        result = advisory_engine.on_new_tick(symbol, market_data)
        l1_db.save_advisory_result(symbol, result)

# config/monitored_symbols.yaml
periodic_update:
  enabled: true
  interval_minutes: 1
  market_type: futures
symbols:
  - BTCUSDT
```

---

**é—®é¢˜2: æ—¶é—´è½´å±•ç¤ºä¸é€‚åˆå¤§æ•°æ®é‡**

**åŸå› **ï¼šæ¨ªå‘æ—¶é—´è½´ï¼Œæ•°æ®å¤šæ—¶éš¾ä»¥æŸ¥çœ‹å’Œç­›é€‰

**ä¿®å¤**ï¼š
```
æ—¶é—´è½´ï¼ˆæ—§ï¼‰:
  [ğŸŸ¢] [ğŸŸ¢] [âšª] [ğŸ”´] ... ï¼ˆæœ€å¤š30ä¸ªï¼Œéœ€æ‰‹åŠ¨å±•å¼€ï¼‰

åˆ—è¡¨æŸ¥è¯¢ï¼ˆæ–°ï¼‰:
  ç­›é€‰: [å¸ç§â–¼] [å†³ç­–ç±»å‹â–¼] [ç½®ä¿¡åº¦â–¼] [å¯æ‰§è¡Œâ–¼] [æ—¶é—´â–¼]
  è¡¨æ ¼: 8åˆ—å®Œæ•´ä¿¡æ¯ï¼ˆå¸ç§/æ—¶é—´/å†³ç­–/ç½®ä¿¡åº¦/å¯æ‰§è¡Œ/ç¯å¢ƒ/è´¨é‡/è¯´æ˜ï¼‰
  åˆ†é¡µ: 10/20/50/100æ¡/é¡µ
  ç»Ÿè®¡: æ€»æ•°/LONG/SHORT/NO_TRADE/å¯æ‰§è¡Œ
```

**æå‡**ï¼š
- âœ… æ”¯æŒ2000+æ¡å†å²è®°å½•æµç•…æŸ¥è¯¢
- âœ… å¤šç»´åº¦ç­›é€‰ï¼ˆ5ä¸ªç»´åº¦ï¼‰
- âœ… ä¿¡æ¯å¯†åº¦æå‡5x
- âœ… æŸ¥è¯¢æ•ˆç‡æå‡10x

---

**å¸ç§ç­›é€‰åŠŸèƒ½**ï¼š
```
æ–°å¢åŠŸèƒ½:
  - å¸ç§ä¸‹æ‹‰æ¡†ï¼ˆç¬¬ä¸€ä¸ªç­›é€‰æ¡ä»¶ï¼‰
  - æ”¯æŒ"å…¨éƒ¨å¸ç§"æˆ–å•ä¸€å¸ç§
  - å…¨éƒ¨å¸ç§ï¼šå¹¶è¡ŒæŸ¥è¯¢æ‰€æœ‰å¸ç§å¹¶åˆå¹¶
  - è¡¨æ ¼æ–°å¢å¸ç§åˆ—ï¼ˆç¬¬ä¸€åˆ—ï¼‰
```

**å¸ç§åˆ—è¡¨æ›´æ–°**ï¼š
```
v3.1: AIA, GPS, ETH
v3.2: TA, AT, HANA, BTR, GPS, RIVER
```

---

#### **2.3.5 å‰ç«¯äº¤äº’é‡æ„ï¼ˆç”¨æˆ·ä½“éªŒå†å‡çº§ï¼‰**

**é—®é¢˜3: å•å¸ç§é€‰æ‹©æ¨¡å¼ä¿¡æ¯æ•ˆç‡ä½**

**åŸå› **ï¼š
- éœ€è¦é€ä¸ªç‚¹å‡»å¸ç§æŸ¥çœ‹å†³ç­–
- æ— æ³•ä¸€æ¬¡æ€§å¯¹æ¯”å¤šä¸ªå¸ç§
- è¯¦æƒ…åŒºåŸŸä¸å¸ç§åˆ†ç¦»ï¼Œå…³è”ä¸æ˜ç¡®

**é‡æ„æ–¹æ¡ˆ**ï¼š
```
æ—§ç‰ˆï¼š
  [å¸ç§é€‰æ‹©å™¨] ç‚¹å‡»é€‰æ‹©å•ä¸ªå¸ç§
  â†“
  æ˜¾ç¤ºè¯¥å¸ç§çš„å†³ç­–å’Œè¯¦æƒ…ï¼ˆå›ºå®šåŒºåŸŸï¼‰
  
  ç¼ºç‚¹ï¼š
    - ä¸€æ¬¡åªèƒ½çœ‹1ä¸ªå¸ç§
    - éœ€è¦é¢‘ç¹åˆ‡æ¢
    - è¯¦æƒ…åŒºåŸŸå§‹ç»ˆå ç”¨ç©ºé—´

æ–°ç‰ˆï¼š
  [æ‰€æœ‰å¸ç§å†³ç­–å¹¶æ’æ˜¾ç¤º]
  TA | AT | HANA | BTR | GPS | RIVER ï¼ˆ6ä¸ªå¡ç‰‡ï¼‰
  â†“
  ç‚¹å‡»ä»»æ„å¡ç‰‡ â†’ æ‚¬æµ®å¼¹çª—æ˜¾ç¤ºè¯¦æƒ…
  
  ä¼˜ç‚¹ï¼š
    - ä¸€å±åŒæ—¶çœ‹6ä¸ªå¸ç§
    - ç‚¹å‡»æ‰æ˜¾ç¤ºè¯¦æƒ…ï¼ˆæŒ‰éœ€ï¼‰
    - è¯¦æƒ…æ‚¬æµ®ä¸å ç”¨é¡µé¢ç©ºé—´
    - å…³è”æ˜ç¡®ï¼ˆè¯¦æƒ…è·Ÿéšå¸ç§ï¼‰
```

**å®ç°ç»†èŠ‚**ï¼š

1. **æ‰€æœ‰å¸ç§å¹¶æ’æ˜¾ç¤ºï¼ˆç½‘æ ¼å¡ç‰‡ï¼‰**
```html
<div class="decisions-grid">
  <div class="decision-card" data-symbol="TA">
    <div class="decision-card-header">
      <span>TA</span>
      <span class="exec-badge">âœ“/âœ—</span>
    </div>
    <div class="decision-card-body">
      <div>ğŸŸ¢ å›¾æ ‡</div>
      <div>LONG</div>
      <div class="confidence-mini">é«˜</div>
    </div>
  </div>
  <!-- AT, HANA, BTR, GPS, RIVER... -->
</div>
```

2. **æ‚¬æµ®å¼¹çª—è¯¦æƒ…**
```css
.detail-modal {
    position: fixed;          /* å›ºå®šå®šä½ */
    z-index: 1000;            /* æœ€ä¸Šå±‚ */
    display: flex;            /* å±…ä¸­å¯¹é½ */
    justify-content: center;
    align-items: center;
}

.detail-overlay {
    background: rgba(0, 0, 0, 0.6);    /* åŠé€æ˜é®ç½© */
    backdrop-filter: blur(4px);         /* èƒŒæ™¯è™šåŒ– */
}
```

3. **JavaScripté€»è¾‘**
```javascript
// å¹¶è¡Œè·å–æ‰€æœ‰å¸ç§å†³ç­–
async function refreshAdvisory() {
    const promises = availableSymbols.map(symbol => 
        fetchAdvisory(symbol)
    );
    const results = await Promise.all(promises);
    updateAllDecisionsPanel(results);
}

// ç‚¹å‡»æ˜¾ç¤ºæ‚¬æµ®è¯¦æƒ…
card.onclick = () => showDetailModal(symbol, advisory);
```

**æ•ˆæœå¯¹æ¯”**ï¼š

| ç»´åº¦ | v3.1 | v3.2 | æå‡ |
|------|------|------|------|
| **ä¸€å±å¯è§å¸ç§æ•°** | 1ä¸ª | 6ä¸ª | +500% |
| **åˆ‡æ¢æ“ä½œ** | éœ€ç‚¹å‡» | æ— éœ€åˆ‡æ¢ | çœç•¥ |
| **è¯¦æƒ…æŸ¥çœ‹** | å›ºå®šæ˜¾ç¤º | æŒ‰éœ€å¼¹çª— | æ›´çµæ´» |
| **ç©ºé—´åˆ©ç”¨** | ä½ï¼ˆå›ºå®šå ç”¨ï¼‰ | é«˜ï¼ˆæŒ‰éœ€æ˜¾ç¤ºï¼‰ | +60% |
| **ä¿¡æ¯å¯†åº¦** | ä¸­ | é«˜ | +40% |
| **å¯¹æ¯”æ•ˆç‡** | æ— æ³•å¯¹æ¯” | ä¸€å±å¯¹æ¯”6ä¸ª | è´¨å˜ |

**è§†è§‰æ•ˆæœ**ï¼š
```
v3.1 å•å¸ç§æ¨¡å¼:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ [BTC] [ETH] ... â”‚ â† é€‰æ‹©å™¨
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ ğŸŸ¢ LONG         â”‚
  â”‚ ç½®ä¿¡åº¦: HIGH    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ å®‰å…¨é—¸é—¨ï¼ˆå ä½ï¼‰â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ å†³ç­–ä¾æ®ï¼ˆå ä½ï¼‰â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ å†³ç­–ç®¡é“ï¼ˆå ä½ï¼‰â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
v3.2 å¤šå¸ç§å¡ç‰‡+æ‚¬æµ®å¼¹çª—:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ TA  | AT  | HANA | BTR | GPS | RIVER â”‚ â† 6ä¸ªå¹¶æ’
  â”‚ ğŸŸ¢  | âšª  | ğŸ”´   | âšª  | ğŸŸ¢  | âšª   â”‚
  â”‚LONG |NO_T |SHORT |NO_T |LONG |NO_T   â”‚
  â”‚ é«˜  | ä½  | ä¸­   | ä½  | é«˜  | ä½    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ å†å²è®°å½•ï¼ˆæ›´å¤šç©ºé—´ï¼‰             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  
  ç‚¹å‡»TAå¡ç‰‡ â†’
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ TAè¯¦æƒ…æ‚¬æµ®å¼¹çª—     â”‚ â† å±…ä¸­å¼¹å‡º
      â”‚ å®‰å…¨é—¸é—¨+ä¾æ®+ç®¡é“ â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å‰ç«¯é‡æ„æˆæœ**ï¼š
- âœ… ä¿¡æ¯æ•ˆç‡æå‡5x
- âœ… é¡µé¢ç©ºé—´åˆ©ç”¨ç‡æå‡60%
- âœ… ç”¨æˆ·æ“ä½œæ­¥éª¤å‡å°‘70%
- âœ… ä¸€å±ä¿¡æ¯é‡æå‡40%

---

#### **2.3.6 çŸ­æœŸä¿¡å·å‰ç«¯å±•ç¤º**

**ç›®æ ‡**ï¼šè®©ç”¨æˆ·æ¸…æ¥šçœ‹åˆ°çŸ­æœŸæœºä¼šè¯†åˆ«çš„è§¦å‘åŸå› 

**å®ç°**ï¼š
```python
# models/reason_tags.py æ–°å¢6ä¸ªæ ‡ç­¾
SHORT_TERM_TREND            # âš¡ çŸ­æœŸè¶‹åŠ¿
RANGE_SHORT_TERM_LONG       # ğŸ¯ éœ‡è¡çŸ­æœŸåšå¤š
RANGE_SHORT_TERM_SHORT      # ğŸ¯ éœ‡è¡çŸ­æœŸåšç©º
SHORT_TERM_PRICE_SURGE      # ğŸ’¨ çŸ­æœŸä»·æ ¼çˆ†å‘
SHORT_TERM_STRONG_BUY       # ğŸ”¥ çŸ­æœŸå¼ºä¹°å‹
SHORT_TERM_STRONG_SELL      # ğŸ”¥ çŸ­æœŸå¼ºå–å‹
```

**å‰ç«¯è‡ªåŠ¨å±•ç¤º**ï¼š
```
å½“è§¦å‘çŸ­æœŸTRENDæ—¶ï¼š
  å†³ç­–ä¾æ®åŒºåŸŸæ˜¾ç¤º:
    âš¡ çŸ­æœŸè¶‹åŠ¿ï¼š1å°æ—¶å¿«é€Ÿèµ°åŠ¿ï¼ˆ>2%ï¼‰ï¼Œæ•è·çŸ­æœŸæœºä¼š
    ğŸ’¨ çŸ­æœŸä»·æ ¼çˆ†å‘ï¼š1å°æ—¶æ¶¨å¹…>1.5%
    ğŸ”¥ çŸ­æœŸå¼ºä¹°å‹ï¼šä¹°å–å¤±è¡¡>65%

å½“è§¦å‘RANGEçŸ­æœŸæœºä¼šæ—¶ï¼š
  å†³ç­–ä¾æ®åŒºåŸŸæ˜¾ç¤º:
    ğŸ¯ éœ‡è¡çŸ­æœŸåšå¤šï¼šç»¼åˆä¿¡å·å¼ºåŠ¿åšå¤šæœºä¼šï¼ˆ3é€‰2ç¡®è®¤ï¼‰
    ğŸ’¨ çŸ­æœŸä»·æ ¼çˆ†å‘
    ğŸ”¥ çŸ­æœŸå¼ºä¹°å‹
```

**ä»·å€¼**ï¼š
- âœ… ç”¨æˆ·æ˜ç¡®çŸ¥é“è¿™æ˜¯çŸ­æœŸæœºä¼šï¼ˆè€Œéä¸­æœŸè¶‹åŠ¿ï¼‰
- âœ… å¯ä»¥çœ‹åˆ°å…·ä½“è§¦å‘çš„ä¿¡å·ç»„åˆ
- âœ… å†³ç­–é€æ˜åº¦æå‡

---

#### **2.3.7 å¤šå‘¨æœŸæ•°æ®é‡æ„ï¼ˆç¬¬ä¸€é˜¶æ®µï¼ŒP0çº§åŸºç¡€ï¼‰**

**ç›®æ ‡**ï¼šå»ºç«‹ç²¾ç¡®çš„å¤šå‘¨æœŸæ•°æ®åŸºç¡€ï¼Œä¸ºä¸‰å±‚è§¦å‘æœºåˆ¶å¥ å®šåŸºç¡€

**é—®é¢˜åˆ†æ**ï¼š

1. **Volumeè®¡ç®—ä¸å‡†ç¡®**
```python
# æ—§å®ç°ï¼ˆæœ‰é—®é¢˜ï¼‰
volume_1h = current_tick.volume - past_tick.volume  # 24h tickerå·®åˆ†
é—®é¢˜ï¼š
  - ticker.volumeæ˜¯24hæ»šåŠ¨çª—å£
  - å·®åˆ†ç»“æœä¸å‡†ç¡®
  - å¯èƒ½å‡ºç°è´Ÿå€¼
```

2. **ä¹°å–å¤±è¡¡æ•°æ®æ¼‚ç§»**
```python
# æ—§å®ç°ï¼ˆæœ‰é—®é¢˜ï¼‰
recent_trades = client.futures_recent_trades(limit=500)  # æ¯æ¬¡è°ƒç”¨
buy_volume = sum(...)  # é€æ¬¡ç´¯åŠ 
é—®é¢˜ï¼š
  - 500ç¬”è¦†ç›–æ—¶é—´ä¸ç¡®å®š
  - å—è°ƒç”¨é¢‘ç‡å½±å“
  - æ•°æ®æ¼‚ç§»
```

---

**PR-001: åŸºäºklinesçš„volumeè®¡ç®—**

**å®ç°æ–¹æ¡ˆ**ï¼š
```python
# æ–°å®ç°
klines = client.futures_klines(symbol, interval='1m', limit=60)

# èšåˆè®¡ç®—
volume_5m = sum([float(k[5]) for k in klines[-5:]])    # 5æ ¹1m Kçº¿
volume_15m = sum([float(k[5]) for k in klines[-15:]])  # 15æ ¹1m Kçº¿
volume_1h = sum([float(k[5]) for k in klines[-60:]])   # 60æ ¹1m Kçº¿

# è®¡ç®—æ”¾é‡æ¯”ç‡
expected_5m = (volume_24h / 1440) * 5
volume_ratio_5m = volume_5m / expected_5m
```

**æ–°å¢å­—æ®µ**ï¼š
```python
'volume_5m': float,           # 5åˆ†é’Ÿæˆäº¤é‡ï¼ˆåŸºç¡€å¸æ•°é‡ï¼‰
'volume_15m': float,          # 15åˆ†é’Ÿæˆäº¤é‡
'volume_1h': float,           # 1å°æ—¶æˆäº¤é‡ï¼ˆç²¾ç¡®ï¼‰
'volume_ratio_5m': float,     # 5åˆ†é’Ÿæ”¾é‡æ¯”ç‡
'volume_ratio_15m': float,    # 15åˆ†é’Ÿæ”¾é‡æ¯”ç‡
'volume_ratio_1h': float,     # 1å°æ—¶æ”¾é‡æ¯”ç‡
```

**æ•ˆæœ**ï¼š
- âœ… Volumeä¸ä¼šå‡ºç°è´Ÿå€¼
- âœ… ç²¾ç¡®åæ˜ å®é™…æˆäº¤é‡
- âœ… volume_ratioå¯è¯†åˆ«çŸ­æœŸæ”¾é‡
- âœ… ä¸ºå¤šå‘¨æœŸåˆ†æå¥ å®šåŸºç¡€

---

**PR-002: åŸºäºtakerBuyçš„ä¹°å–å¤±è¡¡**

**å®ç°æ–¹æ¡ˆ**ï¼š
```python
# ä½¿ç”¨klinesçš„takerBuyBaseAssetVolumeï¼ˆç´¢å¼•9ï¼‰
taker_buy = sum([float(k[9]) for k in klines])
total_volume = sum([float(k[5]) for k in klines])

# è®¡ç®—å¤±è¡¡åº¦
taker_imbalance = (2 * taker_buy - total_volume) / total_volume
# èŒƒå›´: [-1, 1]
# -1 = å…¨æ˜¯ä¸»åŠ¨å–
#  0 = å¹³è¡¡
#  1 = å…¨æ˜¯ä¸»åŠ¨ä¹°
```

**æ–°å¢å­—æ®µ**ï¼š
```python
'taker_imbalance_5m': float,   # 5åˆ†é’Ÿä¹°å–å¤±è¡¡ [-1, 1]
'taker_imbalance_15m': float,  # 15åˆ†é’Ÿä¹°å–å¤±è¡¡
'taker_imbalance_1h': float,   # 1å°æ—¶ä¹°å–å¤±è¡¡
```

**æ•ˆæœ**ï¼š
- âœ… ä¸å—åˆ·æ–°é¢‘ç‡å½±å“
- âœ… æ•°æ®ç¨³å®šï¼Œæ— æ¼‚ç§»
- âœ… èŒƒå›´æ ‡å‡†åŒ– [-1, 1]
- âœ… å‡†ç¡®åæ˜ ä¹°å–å‹åŠ›

---

**PR-003: æ•°æ®å®Œæ•´æ€§æ£€æŸ¥**

**æ–°å¢æ ‡ç­¾**ï¼š
```python
DATA_INCOMPLETE = "data_incomplete"  # æ•°æ®ä¸å®Œæ•´ï¼ˆå†å²ä¸è¶³ï¼‰
```

**å®ç°**ï¼š
```python
# æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
if volume_5m is None or taker_imbalance_5m is None:
    _data_complete = False
    # åç»­åœ¨Step 1æ£€æŸ¥å¹¶æ ‡æ³¨DATA_INCOMPLETE
```

**æ•ˆæœ**ï¼š
- âœ… å¯åŠ¨åˆæœŸä¸äº§ç”Ÿä¼ªä¿¡å·
- âœ… fail-fastæœºåˆ¶
- âœ… åŸå› å¯è§£é‡Š

---

**PR-004: ä¿¡å·é€æ˜åŒ–ï¼ˆé¢‘æ§ä¸æ”¹å†™æ–¹å‘ï¼‰**

**æ ¸å¿ƒæ”¹è¿›**ï¼š
```python
# æ—§é€»è¾‘
if MIN_INTERVAL_BLOCK:
    decision = NO_TRADE  # âŒ è¦†ç›–åŸå§‹ä¿¡å·

# æ–°é€»è¾‘ï¼ˆPR-004ï¼‰
signal_decision = decision  # âœ… ä¿å­˜åŸå§‹ä¿¡å·
if MIN_INTERVAL_BLOCK:
    reason_tags.append(MIN_INTERVAL_BLOCK)  # âœ… åªåŠ æ ‡ç­¾
    # decisionä¿æŒä¸å˜
# é€šè¿‡execution_permission=DENYé˜»æ–­
```

**æ–°å¢å­—æ®µ**ï¼š
```python
'signal_decision': Decision  # åŸå§‹ä¿¡å·æ–¹å‘ï¼ˆé¢‘æ§å‰ï¼‰
```

**æ•ˆæœå¯¹æ¯”**ï¼š

| åœºæ™¯ | æ—§ç‰ˆ | PR-004 |
|------|------|--------|
| **ä¿¡å·** | LONG | LONG |
| **é¢‘æ§è§¦å‘** | â†’ NO_TRADE | â†’ LONGï¼ˆä¿ç•™ï¼‰ |
| **ç”¨æˆ·çœ‹åˆ°** | NO_TRADEï¼ˆåŸå› ä¸æ˜ï¼‰ | LONGä½†è¢«é¢‘æ§é˜»æ–­ |
| **signal_decision** | - | LONG |
| **execution_permission** | - | DENY |
| **reason_tags** | MIN_INTERVAL_BLOCK | MIN_INTERVAL_BLOCK |

**ä»·å€¼**ï¼š
- âœ… ä¿¡å·é€æ˜åº¦æå‡100%
- âœ… ç”¨æˆ·å¯è¿½è¸ªæ–¹å‘å˜åŒ–
- âœ… ä¾¿äºè°ƒè¯•å’Œåˆ†æ
- âœ… ä¸ç ´ååŒé—¨æ§›ä½“ç³»

---

**PR-007: EXTREME_VOLUMEè”ç«‹å¦å†³**

**æ ¸å¿ƒæ”¹è¿›**ï¼š
```python
# æ—§é€»è¾‘
EXTREME_VOLUME â†’ BLOCK â†’ DENYï¼ˆç¡¬å¦å†³ï¼‰

# æ–°é€»è¾‘ï¼ˆPR-007ï¼‰
EXTREME_VOLUMEå•ç‹¬ â†’ DEGRADE â†’ ALLOW_REDUCEDï¼ˆé™çº§æ‰§è¡Œï¼‰
EXTREME_VOLUME + LIQUIDATION â†’ DENYï¼ˆè”ç«‹å¦å†³ï¼‰
EXTREME_VOLUME + EXTREME_REGIME â†’ DENYï¼ˆè”ç«‹å¦å†³ï¼‰
```

**å®ç°**ï¼š
```python
# models/reason_tags.py
ReasonTag.EXTREME_VOLUME: ExecutabilityLevel.DEGRADE  # æ”¹ä¸ºDEGRADE

# market_state_machine_l1.py
if ReasonTag.EXTREME_VOLUME in reason_tags:
    if LIQUIDATION_PHASE in tags or EXTREME_REGIME in tags:
        return ExecutionPermission.DENY  # è”ç«‹å¦å†³
    # å•ç‹¬å‡ºç°ç»§ç»­æ£€æŸ¥ï¼Œä¼šè¢«æ˜ å°„ä¸ºALLOW_REDUCED
```

**æ•ˆæœå¯¹æ¯”**ï¼š

| åœºæ™¯ | æ—§ç‰ˆ | PR-007 |
|------|------|--------|
| å•ç‹¬æ”¾é‡ï¼ˆæ— å±é™©ä¿¡å·ï¼‰ | DENY | ALLOW_REDUCED âœ… |
| æ”¾é‡+æ¸…ç®— | DENY | DENYï¼ˆè”ç«‹ï¼‰ |
| æ”¾é‡+æç«¯æ³¢åŠ¨ | DENY | DENYï¼ˆè”ç«‹ï¼‰ |

**ä»·å€¼**ï¼š
- âœ… æ”¾é‡æœºä¼šä¸å†é”™è¿‡ï¼ˆå•ç‹¬æ—¶å…è®¸é™çº§ï¼‰
- âœ… å±é™©åœºæ™¯ä»ç„¶é˜»æ–­ï¼ˆè”ç«‹æ—¶æ‹’ç»ï¼‰
- âœ… å†³ç­–æ›´ç²¾ç»†
- âœ… é£é™©æ”¶ç›Šå¹³è¡¡ä¼˜åŒ–

---

---

**PR-005: ä¸‰å±‚è§¦å‘æœºåˆ¶ï¼ˆ1h/15m/5mï¼‰**

**æ ¸å¿ƒè®¾è®¡**ï¼š
```
Layer 1: Contextï¼ˆ1hï¼‰â†’ æ–¹å‘åç½®ï¼ˆ3é€‰2ï¼‰
Layer 2: Confirmï¼ˆ15mï¼‰â†’ ä¿¡å·ç¡®è®¤ï¼ˆ4é€‰2ï¼‰
Layer 3: Triggerï¼ˆ5mï¼‰â†’ æœ€ç»ˆè§¦å‘ï¼ˆ3é€‰2ï¼‰

è¾“å‡º: ltf_statusï¼ˆCONFIRMED/PARTIAL/FAILED/MISSINGï¼‰
æ˜ å°„: 
  CONFIRMED â†’ ALLOW
  PARTIAL â†’ ALLOW_REDUCED
  FAILED â†’ DENY
```

**æ–°å¢å­—æ®µ**ï¼š
```python
'price_change_5m/15m': float  # 5/15åˆ†é’Ÿä»·æ ¼å˜åŒ–
'oi_change_15m': float        # 15åˆ†é’ŸOIå˜åŒ–
ltf_status: str               # ä¸‰å±‚è§¦å‘çŠ¶æ€
```

**æ•ˆæœ**ï¼šçŸ­çº¿ä¿¡å·+25%ï¼Œè™šå‡ä¿¡å·-50%ï¼Œ5åˆ†é’Ÿçº§å“åº”

---

#### **2.3.8 ç³»ç»Ÿé²æ£’æ€§å¢å¼º**

**1. ç½‘ç»œè¿æ¥ä¼˜åŒ–**
```python
# binance_data_fetcher.py
def __init__(self, test_connection=False):
    # å»¶è¿Ÿç½‘ç»œè¿æ¥åˆ°å®é™…ä½¿ç”¨æ—¶
    # é¿å…åˆå§‹åŒ–æ—¶è§¦å‘æƒé™è¯·æ±‚
```

**2. å¿«é€Ÿæ“ä½œè„šæœ¬**
```bash
quick-start.sh   # å¿«é€Ÿå¯åŠ¨ï¼ˆç›´æ¥/Dockerï¼‰
quick-commit.sh  # å¿«é€ŸGitæäº¤
quick-test.sh    # å¿«é€Ÿè¿è¡Œæµ‹è¯•
```

**3. æµ‹è¯•å¥—ä»¶å»ºç«‹**
```
æ–°å¢æµ‹è¯•æ–‡ä»¶ï¼ˆ12ä¸ªï¼‰:
  - test_p0_volume_unit_bugfix.py
  - test_p0_required_fields_bugfix.py
  - test_pr_m_metadata_format.py
  - test_metadata_injection_point.py
  - test_symbol_format_normalization.py
  - test_periodic_update_retry.py
  - test_logger_initialization.py
  - test_short_term_opportunity.py
  - test_data_validation_completeness.py
  - test_data_validation_ranges.py
  - README_TEST_SUITE.md
  - TEST_SUMMARY.md
```

---

### 2.4 v3.1æ ¸å¿ƒä¿®å¤

**v3.1 = v3.0åŠŸèƒ½ + æ–‡æ¡£ä¼˜åŒ– + P0çº§Bugä¿®å¤**

v3.1åœ¨v3.0çš„åŸºç¡€ä¸Šï¼Œè¿›è¡Œäº†ä»¥ä¸‹æ”¹è¿›ï¼š
1. **æ–‡æ¡£ä¼˜åŒ–**ï¼šä¿®æ­£ç« èŠ‚ç¼–å·ï¼ˆ6-16ç« ï¼‰ã€ä»£ç æ³¨é‡Šå¯¹é½ï¼ˆ10æ­¥ç®¡é“ï¼‰
2. **P0çº§Bugä¿®å¤**ï¼šä¿®å¤3ä¸ªP0çº§Bugï¼ˆP0-1/2/3ï¼‰ï¼Œæå‡ç³»ç»Ÿç¨³å®šæ€§å’Œå‡†ç¡®æ€§
3. **æµ‹è¯•å¢å¼º**ï¼šæ–°å¢6ä¸ªéªŒæ”¶æµ‹è¯•ï¼Œæµ‹è¯•æ€»æ•°ä»42ä¸ªå¢åŠ åˆ°48ä¸ª

---

### 2.4.1 P0çº§Bugä¿®å¤ï¼ˆv3.1ä¸“é¡¹ï¼‰

#### **P0-1: WEAK_SIGNAL_IN_RANGE è¢«POORçŸ­è·¯**

**é—®é¢˜æè¿°**ï¼š
- `WEAK_SIGNAL_IN_RANGE` æ ‡ç­¾è¿”å› `TradeQuality.POOR`
- POOR åœ¨ Step 4 è¢«ç¡¬çŸ­è·¯ï¼Œç›´æ¥è¿”å› NO_TRADE
- å¯¼è‡´ ExecutionPermissionã€ç½®ä¿¡åº¦capã€åŒé—¨æ§›æœºåˆ¶å…¨éƒ¨å¤±æ•ˆ
- ä¸ NOISY_MARKETï¼ˆUNCERTAINâ†’ALLOW_REDUCEDï¼‰è®¾è®¡ä¸ä¸€è‡´

**å½±å“èŒƒå›´**ï¼š
```
RANGEå¸‚åœº + å¼±ä¿¡å·ï¼ˆä¹°å–å¤±è¡¡<0.6 æˆ– OI<10%ï¼‰
  â†’ è¿”å› POOR
  â†’ Step 4 çŸ­è·¯ NO_TRADE
  â†’ ExecutionPermission é€»è¾‘ä¸å¯è¾¾
  â†’ é™çº§æ‰§è¡Œè®¾è®¡å¤±æ•ˆ
```

**ä¿®å¤æ–¹æ¡ˆ**ï¼š
```python
# ä¿®å¤å‰ï¼ˆmarket_state_machine_l1.py Line 552-558ï¼‰
if (regime == MarketRegime.RANGE and ...):
    tags.append(ReasonTag.WEAK_SIGNAL_IN_RANGE)
    return TradeQuality.POOR, tags  # âŒ é”™è¯¯

# ä¿®å¤å
if (regime == MarketRegime.RANGE and ...):
    tags.append(ReasonTag.WEAK_SIGNAL_IN_RANGE)
    return TradeQuality.UNCERTAIN, tags  # âœ… ä¿®å¤
    # ä¸ NOISY_MARKET ä¿æŒä¸€è‡´
```

**éªŒæ”¶ç»“æœ**ï¼ˆæ–°å¢æµ‹è¯• `tests/test_p0_1_weak_signal_fix.py`ï¼‰ï¼š
```
âœ… éªŒè¯1: trade_quality = UNCERTAINï¼ˆä¸æ˜¯POORï¼‰
âœ… éªŒè¯2: reason_tags åŒ…å« weak_signal_in_range
âœ… éªŒè¯3: ä¸åœ¨ Step 4 è¢«çŸ­è·¯
âœ… éªŒè¯4: è¿›å…¥ Step 8/9/10ï¼ˆExecutionPermission é€»è¾‘ï¼‰
```

**é‡è¦æ€§**ï¼šâš ï¸ P0çº§ï¼Œå½±å“ RANGE å¸‚åœºçš„é™çº§æ‰§è¡Œé€»è¾‘ï¼

---

#### **P0-2: funding_rate_prev æ›´æ–°ä¸å¯è¾¾ + å¤šå¸ç§ä¸²æ‰°**

**é—®é¢˜æè¿°**ï¼š
1. **æ›´æ–°ä¸å¯è¾¾**ï¼š
   - NOISY_MARKET åˆ†æ”¯ `return` åœ¨å‰ï¼ˆLine 536ï¼‰
   - `funding_rate_prev` å†™å›åœ¨åï¼ˆLine 539ï¼‰
   - è§¦å‘ NOISY æ—¶ï¼Œprev æ°¸è¿œä¸æ›´æ–°
   
2. **å¤šå¸ç§ä¸²æ‰°**ï¼š
   - `history_data` æ˜¯å…¨å±€å…±äº«å­—å…¸
   - æ²¡æœ‰æŒ‰ symbol åˆ†æ¡¶
   - BTC/ETH/AIA/GPS äº’ç›¸è¦†ç›– prev å€¼

**å½±å“èŒƒå›´**ï¼š
```
åœºæ™¯1ï¼ˆæ›´æ–°ä¸å¯è¾¾ï¼‰ï¼š
  tick 1: funding_rate=0.0005 â†’ è§¦å‘NOISY â†’ return â†’ prevæœªæ›´æ–°
  tick 2: funding_rate=0.0015 â†’ prevä»æ˜¯åˆå§‹å€¼ â†’ volatilityé”™è¯¯ï¼

åœºæ™¯2ï¼ˆå¤šå¸ç§ä¸²æ‰°ï¼‰ï¼š
  BTC tick 1: funding_rate=0.0005 â†’ prev=0.0005
  ETH tick 1: funding_rate=0.0003 â†’ prev=0.0003ï¼ˆè¦†ç›–BTCï¼‰
  BTC tick 2: funding_rate=0.0006 â†’ prev=0.0003ï¼ˆé”™è¯¯ï¼ï¼‰
```

**ä¿®å¤æ–¹æ¡ˆ**ï¼š
```python
# ä¿®å¤å‰ï¼ˆmarket_state_machine_l1.py Line 527-539ï¼‰
funding_rate_prev = self.history_data.get('funding_rate_prev', funding_rate)
funding_volatility = abs(funding_rate - funding_rate_prev)

if (funding_volatility > ... and ...):
    tags.append(ReasonTag.NOISY_MARKET)
    return TradeQuality.UNCERTAIN, tags  # âŒ å…ˆreturn

self.history_data['funding_rate_prev'] = funding_rate  # âŒ ä¸å¯è¾¾

# ä¿®å¤å
funding_rate_prev = self.history_data.get(f'{symbol}_funding_rate_prev', funding_rate)
funding_volatility = abs(funding_rate - funding_rate_prev)

# âœ… å…ˆå†™å›ï¼ˆç¡®ä¿æ¯æ¬¡tickéƒ½æ›´æ–°ï¼‰
self.history_data[f'{symbol}_funding_rate_prev'] = funding_rate

if (funding_volatility > ... and ...):
    tags.append(ReasonTag.NOISY_MARKET)
    return TradeQuality.UNCERTAIN, tags
```

**æ–¹æ³•ç­¾åè°ƒæ•´**ï¼š
```python
# _eval_trade_quality æ–¹æ³•æ·»åŠ  symbol å‚æ•°
def _eval_trade_quality(
    self, 
    symbol: str,  # âœ… æ–°å¢
    data: Dict, 
    regime: MarketRegime
) -> Tuple[TradeQuality, List[ReasonTag]]:
```

**éªŒæ”¶ç»“æœ**ï¼ˆæ–°å¢æµ‹è¯• `tests/test_p0_2_funding_prev.py`ï¼‰ï¼š
```
âœ… éªŒæ”¶1: åŒä¸€symbolè¿ç»­tickï¼Œprevæ­£ç¡®æ›´æ–°ï¼ˆ0.0005â†’0.0015ï¼‰
âœ… éªŒæ”¶2: å¤šå¸ç§ä¸ä¸²æ‰°ï¼ˆBTC/ETH/AIAå„è‡ªç‹¬ç«‹ï¼‰
âœ… éªŒæ”¶3: NOISYåˆ†æ”¯returnåï¼Œprevä»æ­£ç¡®æ›´æ–°
```

**é‡è¦æ€§**ï¼šâš ï¸ P0çº§ï¼Œå½±å“ funding_volatility è®¡ç®—å‡†ç¡®æ€§å’Œå¤šå¸ç§æ”¯æŒï¼

---

#### **P0-3: OI è¾…åŠ©æ ‡ç­¾é˜ˆå€¼å£å¾„é”™è¯¯**

**é—®é¢˜æè¿°**ï¼š
- `_add_auxiliary_tags` ä¸­ OI é˜ˆå€¼ç¡¬ç¼–ç ä¸º 5.0 / -5.0
- ç³»ç»Ÿå£å¾„å·²ç»Ÿä¸€ä¸º DECIMAL æ ¼å¼ï¼ˆ0.05 = 5%ï¼‰
- ä½†è¾…åŠ©æ ‡ç­¾ä»ä½¿ç”¨ç™¾åˆ†ç‚¹æ ¼å¼ï¼ˆ5.0 = 500%ï¼ï¼‰
- å¯¼è‡´ `OI_GROWING` å’Œ `OI_DECLINING` å‡ ä¹æ°¸ä¸è§¦å‘

**å½±å“èŒƒå›´**ï¼š
```
æ­£å¸¸OIå˜åŒ–ï¼š
  oi_change_1h = 0.06 (6%)   â†’ ä¸ 5.0 æ¯”è¾ƒ â†’ ä¸è§¦å‘ âŒ
  oi_change_1h = 0.50 (50%)  â†’ ä¸ 5.0 æ¯”è¾ƒ â†’ ä¸è§¦å‘ âŒ
  oi_change_1h = 6.0 (600%!) â†’ ä¸ 5.0 æ¯”è¾ƒ â†’ è§¦å‘ï¼ˆä½†ä¸å¯èƒ½ï¼‰

æ ‡ç­¾è§¦å‘ç‡ï¼š~0%
```

**ä¿®å¤æ–¹æ¡ˆ**ï¼š

**1. é…ç½®æ–‡ä»¶æ–°å¢é˜ˆå€¼**ï¼ˆ`config/l1_thresholds.yaml`ï¼‰ï¼š
```yaml
# ==================
# è¾…åŠ©æ ‡ç­¾é˜ˆå€¼
# ==================
auxiliary_tags:
  # OI å˜åŒ–é˜ˆå€¼ï¼ˆè¾…åŠ©ä¿¡æ¯æ ‡ç­¾ï¼‰- P0-3ä¿®å¤ï¼šä½¿ç”¨DECIMALæ ¼å¼
  oi_growing_threshold: 0.05     # 1h OI å¢é•¿ > 5% â†’ OI_GROWING
  oi_declining_threshold: -0.05  # 1h OI ä¸‹é™ < -5% â†’ OI_DECLINING
  
  # èµ„é‡‘è´¹ç‡é˜ˆå€¼ï¼ˆè¾…åŠ©ä¿¡æ¯æ ‡ç­¾ï¼‰
  funding_rate_threshold: 0.0005  # è´¹ç‡ç»å¯¹å€¼ > 0.05%
```

**2. ä»£ç æ”¹ä¸ºé…ç½®åŒ–**ï¼ˆ`market_state_machine_l1.py` Line 984-1009ï¼‰ï¼š
```python
# ä¿®å¤å‰
oi_change_1h = data.get('oi_change_1h', 0)
if oi_change_1h > 5.0:  # âŒ ç¡¬ç¼–ç ç™¾åˆ†ç‚¹æ ¼å¼
    reason_tags.append(ReasonTag.OI_GROWING)
elif oi_change_1h < -5.0:  # âŒ ç¡¬ç¼–ç ç™¾åˆ†ç‚¹æ ¼å¼
    reason_tags.append(ReasonTag.OI_DECLINING)

# ä¿®å¤å
oi_change_1h = data.get('oi_change_1h', 0)
oi_growing_threshold = self.thresholds.get('aux_oi_growing_threshold', 0.05)
oi_declining_threshold = self.thresholds.get('aux_oi_declining_threshold', -0.05)

if oi_change_1h > oi_growing_threshold:  # âœ… é…ç½®åŒ– + DECIMALæ ¼å¼
    reason_tags.append(ReasonTag.OI_GROWING)
elif oi_change_1h < oi_declining_threshold:  # âœ… é…ç½®åŒ– + DECIMALæ ¼å¼
    reason_tags.append(ReasonTag.OI_DECLINING)
```

**3. é…ç½®åŠ è½½é€»è¾‘æ›´æ–°**ï¼ˆ`market_state_machine_l1.py` Line 1284-1288ï¼‰ï¼š
```python
# è¾…åŠ©æ ‡ç­¾é˜ˆå€¼ï¼ˆP0-3ï¼‰
aux = config.get('auxiliary_tags', {})
flat['aux_oi_growing_threshold'] = aux.get('oi_growing_threshold', 0.05)
flat['aux_oi_declining_threshold'] = aux.get('oi_declining_threshold', -0.05)
flat['aux_funding_rate_threshold'] = aux.get('funding_rate_threshold', 0.0005)
```

**éªŒæ”¶ç»“æœ**ï¼ˆæ–°å¢æµ‹è¯• `tests/test_p0_3_oi_auxiliary.py`ï¼‰ï¼š
```
âœ… éªŒæ”¶1: oi_change_1h=0.06 (6%) è§¦å‘ OI_GROWING
âœ… éªŒæ”¶2: oi_change_1h=-0.06 (-6%) è§¦å‘ OI_DECLINING
âœ… éªŒæ”¶3: è¾¹ç•Œå€¼ 0.04/-0.04 æ­£ç¡®ä¸è§¦å‘
âœ… éªŒæ”¶4: æç«¯å€¼ 0.50/-0.30 æ­£ç¡®è§¦å‘
âœ… éªŒæ”¶5: ç²¾ç¡®è¾¹ç•Œ 0.051 æ­£ç¡®è§¦å‘
```

**ç³»ç»Ÿæ”¹è¿›**ï¼š
- é˜ˆå€¼æ•°é‡ï¼š26 â†’ 29 (+3)
- é…ç½®åŒ–ç¨‹åº¦ï¼šæ›´é«˜ï¼ˆè¾…åŠ©æ ‡ç­¾ä¹Ÿé…ç½®åŒ–ï¼‰
- å£å¾„ä¸€è‡´æ€§ï¼š100%ï¼ˆå…¨éƒ¨ DECIMALï¼‰

**é‡è¦æ€§**ï¼šâš ï¸ P0çº§ï¼Œå½±å“è¾…åŠ©æ ‡ç­¾å‡†ç¡®æ€§å’Œå£å¾„ä¸€è‡´æ€§ï¼

---

### 2.2.2 P0ä¿®å¤æ€»ç»“

| ä¿®å¤é¡¹ | é—®é¢˜ç±»å‹ | å½±å“èŒƒå›´ | ä¿®å¤æ–‡ä»¶æ•° | æµ‹è¯•ç”¨ä¾‹ | çŠ¶æ€ |
|--------|---------|---------|-----------|---------|------|
| **P0-1** | è´¨é‡è¯„çº§é€»è¾‘é”™è¯¯ | RANGEå¼±ä¿¡å·åœºæ™¯ | 1 | 4ä¸ªéªŒæ”¶ç‚¹ | âœ… å®Œæˆ |
| **P0-2** | å†å²æ•°æ®ç®¡ç†é”™è¯¯ | funding_volatility + å¤šå¸ç§ | 1 | 3ä¸ªéªŒæ”¶ç‚¹ | âœ… å®Œæˆ |
| **P0-3** | é˜ˆå€¼å£å¾„ä¸ä¸€è‡´ | è¾…åŠ©æ ‡ç­¾è§¦å‘ | 2 | 5ä¸ªéªŒæ”¶ç‚¹ | âœ… å®Œæˆ |

**å…³é”®æˆæœ**ï¼š
1. âœ… RANGE å¸‚åœºé™çº§æ‰§è¡Œé€»è¾‘æ¢å¤æ­£å¸¸
2. âœ… å¤šå¸ç§ funding_volatility è®¡ç®—å‡†ç¡®
3. âœ… è¾…åŠ©æ ‡ç­¾ä»"æ°¸ä¸è§¦å‘"æ¢å¤æ­£å¸¸
4. âœ… å£å¾„ä¸€è‡´æ€§è¾¾åˆ° 100%
5. âœ… æµ‹è¯•è¦†ç›–ä» 42 ä¸ªå¢åŠ åˆ° 48 ä¸ª

---

### 2.3 v3.0æ ¸å¿ƒå‡çº§

#### **2.2.0 PR-Aå£å¾„é—®é¢˜ä¿®å¤ï¼ˆç³»ç»Ÿæ€§é”™è¯¯ï¼‰**

**é—®é¢˜å‘ç°**ï¼š
- é…ç½®æ–‡ä»¶ä¸­ç™¾åˆ†æ¯”é˜ˆå€¼æ··ç”¨**ç™¾åˆ†ç‚¹æ ¼å¼**ï¼ˆ5.0è¡¨ç¤º5%ï¼‰å’Œ**å°æ•°æ ¼å¼**ï¼ˆ0.05è¡¨ç¤º5%ï¼‰
- MetricsNormalizerå·²å°†è¾“å…¥æ•°æ®ç»Ÿä¸€ä¸ºå°æ•°æ ¼å¼
- ä½†é…ç½®é˜ˆå€¼ä»ä½¿ç”¨ç™¾åˆ†ç‚¹æ ¼å¼
- **å¯¼è‡´æ–¹å‘æ¡ä»¶æ°¸è¿œä¸è§¦å‘çš„ç³»ç»Ÿæ€§é”™è¯¯**

**å½±å“èŒƒå›´**ï¼š
```
æ•°æ®å±‚é¢: 0.05 (5%)
é˜ˆå€¼å±‚é¢: 5.0 (å®é™…å˜æˆ500%ï¼)
ç»“æœ: 0.05 < 5.0 â†’ æ¡ä»¶æ°¸è¿œä¸æ»¡è¶³ â†’ æ–¹å‘è¯„ä¼°æ°¸è¿œä¸è§¦å‘
```

**ä¿®å¤å†…å®¹**ï¼š
| é…ç½®é¡¹ | ä¿®å¤å‰ | ä¿®å¤å | è¯´æ˜ |
|--------|--------|--------|------|
| `extreme_price_change_1h` | 5.0 | 0.05 | 5% |
| `trend_price_change_6h` | 3.0 | 0.03 | 3% |
| `liquidation.price_change` | 5.0 | 0.05 | 5% |
| `liquidation.oi_drop` | -15.0 | -0.15 | -15% |
| `crowding.oi_growth` | 30.0 | 0.30 | 30% |
| `rotation.price_threshold` | 2.0 | 0.02 | 2% |
| `rotation.oi_threshold` | 5.0 | 0.05 | 5% |
| `range_weak.oi` | 10.0 | 0.10 | 10% |
| `direction.*.*.oi_change` | 5.0/10.0 | 0.05/0.10 | 5%/10% |
| `direction.*.*.price_change` | 1.0 | 0.01 | 1% |

**éªŒè¯ç»“æœ**ï¼ˆæ–°å¢æµ‹è¯•ï¼‰ï¼š
```
âœ… Test 1: é…ç½®é˜ˆå€¼ä½¿ç”¨å°æ•°æ ¼å¼
âœ… Test 2: æ•°æ®è§„èŒƒåŒ–æ­£ç¡®
âœ… Test 3: å¸‚åœºç¯å¢ƒè¯†åˆ«èƒ½æ­£å¸¸è§¦å‘ï¼ˆEXTREME/TREND/RANGEï¼‰
âœ… Test 4: æ–¹å‘è¯„ä¼°èƒ½æ­£å¸¸è§¦å‘ï¼ˆLONG/SHORTï¼‰
âœ… Test 5: å®Œæ•´å†³ç­–æµç¨‹ï¼ˆé¦–æ¬¡æˆåŠŸè§¦å‘LONGå†³ç­–ï¼ï¼‰

å…³é”®éªŒè¯:
å¼ºTREND+å¼ºLONGä¿¡å· â†’ decision=LONG, confidence=ULTRA, executable=True
```

**å£å¾„è§„èŒƒï¼ˆæœ€ç»ˆç¡®å®šï¼‰**ï¼š
- **å†…éƒ¨å­˜å‚¨/è®¡ç®—**: ç»Ÿä¸€å°æ•°æ ¼å¼ï¼ˆ0.05è¡¨ç¤º5%ï¼‰
- **é…ç½®æ–‡ä»¶**: ç»Ÿä¸€å°æ•°æ ¼å¼ + æ³¨é‡Šè¯´æ˜
- **MetricsNormalizer**: è‡ªåŠ¨è½¬æ¢ç™¾åˆ†ç‚¹â†’å°æ•°
- **å‰ç«¯å±•ç¤º**: å¯è½¬æ¢ä¸ºç™¾åˆ†æ¯”æ˜¾ç¤ºï¼ˆå¦‚éœ€è¦ï¼‰

**é‡è¦æ€§**ï¼šâš ï¸ è¿™æ˜¯v3.0æœ€å…³é”®çš„ä¿®å¤ï¼Œè§£å†³äº†**v1.0/v2.0ä»¥æ¥çš„ç³»ç»Ÿæ€§é”™è¯¯**ï¼

---

#### **2.2.1 PR-B: TradeQualityè¯­ä¹‰é’‰æ­»**
- **ExecutabilityLevelä¸‰çº§æ§åˆ¶**: ALLOWï¼ˆå…è®¸ï¼‰ã€DEGRADEï¼ˆé™çº§ï¼‰ã€BLOCKï¼ˆé˜»æ–­ï¼‰
- **23ä¸ªReasonTagç²¾ç»†æ˜ å°„**: æ¯ä¸ªæ ‡ç­¾æ˜ç¡®å®šä¹‰æ‰§è¡Œç­‰çº§
- **POORè´¨é‡ç¡¬çŸ­è·¯**: é‡åˆ°POORç›´æ¥NO_TRADEï¼Œä¸å¯é™çº§
- **UNCERTAINè´¨é‡é™çº§æ‰§è¡Œ**: å…è®¸ç»§ç»­ä½†ç½®ä¿¡åº¦å—é™
- **executableåŸºç¡€åˆ¤å®š**: ä¸ºæ–¹æ¡ˆDçš„åŒé—¨æ§›æœºåˆ¶å¥ å®šåŸºç¡€

#### **2.2.2 PR-C: å†³ç­–é¢‘ç‡æ§åˆ¶**
- **DecisionMemoryç®¡ç†**: å¤šå¸ç§ç‹¬ç«‹è®°å¿†ï¼Œè®°å½•last_decision_timeå’Œlast_decision_side
- **æœ€å°å†³ç­–é—´éš”**: é»˜è®¤300ç§’ï¼Œé˜²æ­¢çŸ­æ—¶é—´é‡å¤å»ºè®®
- **ç¿»è½¬å†·å´**: é»˜è®¤600ç§’ï¼Œé˜²æ­¢LONGâ†”SHORTé¢‘ç¹åˆ‡æ¢
- **NO_TRADEä¸æ›´æ–°è®°å¿†**: åªæœ‰LONG/SHORTæ‰ä¼šæ›´æ–°å†³ç­–è®°å¿†
- **å¯é…ç½®å¼€å…³**: æ”¯æŒenable_min_intervalå’Œenable_flip_cooldownç‹¬ç«‹æ§åˆ¶

#### **2.2.3 PR-D: Confidenceæ··åˆæ¨¡å¼**
- **ä¸‰æ­¥æµç¨‹**: åŸºç¡€åŠ åˆ† â†’ åº”ç”¨cap â†’ å¼ºä¿¡å·çªç ´
- **ç¡¬é™çº§ä¸Šé™ï¼ˆcapï¼‰**: UNCERTAINè´¨é‡â‰¤HIGHï¼ˆæ–¹æ¡ˆDä¸Šè°ƒï¼‰ï¼Œé™çº§æ ‡ç­¾â‰¤HIGH
- **å¼ºä¿¡å·çªç ´**: +1æ¡£ä½†ä¸å¯çªç ´capé™åˆ¶
- **é…ç½®åŒ–ç®¡ç†**: åŸºç¡€åˆ†ã€é˜ˆå€¼ã€capè§„åˆ™ã€boostè§„åˆ™å…¨éƒ¨å¯é…ç½®
- **ä¿ç•™åŸæœ‰é€»è¾‘**: ä¸æ¨ç¿»PR-005çš„4æ¡£åŠ åˆ†åˆ¶ï¼Œå¢é‡ä¼˜åŒ–

#### **2.2.4 æ–¹æ¡ˆD: æ‰§è¡Œè®¸å¯æœºåˆ¶ï¼ˆé‡å¤§å‡çº§ï¼‰**

**é—®é¢˜èƒŒæ™¯**ï¼š
- PR-Då°†UNCERTAINå’ŒDEGRADEæ ‡ç­¾capåˆ°MEDIUM
- ä½†executableè¦æ±‚ç½®ä¿¡åº¦â‰¥HIGH
- å¯¼è‡´DEGRADEè¯­ä¹‰è¢«äº‹å®ä¸Šå¦å†³ï¼ˆNOISY_MARKETæ°¸è¿œä¸å¯æ‰§è¡Œï¼‰
- ä¸"é™çº§æ‰§è¡Œ"çš„è®¾è®¡åˆè¡·å†²çª

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **å¼•å…¥ExecutionPermissionæšä¸¾**:
   - `ALLOW`: æ­£å¸¸æ‰§è¡Œï¼ˆæ— é™çº§æ ‡ç­¾ï¼‰
   - `ALLOW_REDUCED`: é™çº§æ‰§è¡Œï¼ˆæœ‰DEGRADEæ ‡ç­¾å¦‚NOISY_MARKETï¼‰
   - `DENY`: æ‹’ç»æ‰§è¡Œï¼ˆæœ‰BLOCKæ ‡ç­¾å¦‚EXTREME_VOLUMEï¼‰

2. **åŒé—¨æ§›æœºåˆ¶**:
   - `ALLOW`: è¦æ±‚confidence â‰¥ HIGHï¼ˆæ­£å¸¸é—¨æ§›ï¼‰
   - `ALLOW_REDUCED`: è¦æ±‚confidence â‰¥ MEDIUMï¼ˆé™çº§é—¨æ§›ï¼‰
   - `DENY`: æ°¸è¿œFalse

3. **Capè°ƒæ•´**:
   - UNCERTAINè´¨é‡ä¸Šé™: MEDIUM â†’ HIGH
   - DEGRADEæ ‡ç­¾ä¸Šé™: MEDIUM â†’ HIGH
   - ç¡®ä¿é™çº§åœºæ™¯å¯è¾¾MEDIUMåŠä»¥ä¸Šï¼Œæ»¡è¶³é™çº§é—¨æ§›

4. **å†³ç­–ç®¡é“å¢å¼º**ï¼ˆ8æ­¥â†’10æ­¥ï¼‰:
   - æ‹†åˆ†Step 8ï¼ˆæ‰§è¡Œè®¸å¯ï¼‰å’ŒStep 9ï¼ˆç½®ä¿¡åº¦è®¡ç®—ï¼‰
   - åœ¨ç½®ä¿¡åº¦è®¡ç®—å‰ç¡®å®šexecution_permission
   - Step 10çš„executableåˆ¤å®šåŸºäºåŒé—¨æ§›æœºåˆ¶

**æ ¸å¿ƒæˆæœ**ï¼š
- âœ… DEGRADEçœŸæ­£å®ç°"é™çº§æ‰§è¡Œ"ï¼ˆä¸å†è¢«äº‹å®ç¦æ­¢ï¼‰
- âœ… NOISY_MARKETåœºæ™¯å¯executableï¼ˆHIGH >= MEDIUMï¼‰
- âœ… ExecutabilityLevelå®Œç¾æ˜ å°„åˆ°ExecutionPermission
- âœ… APIå“åº”æ–°å¢execution_permissionå­—æ®µï¼Œè¯­ä¹‰æ¸…æ™°

**æµ‹è¯•éªŒè¯**ï¼š
```
âœ… Test 1: ExecutionPermissionæ˜ å°„æ­£ç¡®
âœ… Test 2: åŒé—¨æ§›æœºåˆ¶ç”Ÿæ•ˆ
âœ… Test 3: NOISY_MARKETå¯é™çº§æ‰§è¡Œï¼ˆæ ¸å¿ƒéªŒè¯ï¼‰
âœ… Test 4: EXTREMEåœºæ™¯æ‹’ç»æ‰§è¡Œ
âœ… Test 5: Capä¸é—¨æ§›é…ç½®ä¸€è‡´
```

**é‡è¦æ€§**ï¼šâš ï¸ è¿™æ˜¯v3.0çš„é‡å¤§é€»è¾‘ä¿®æ­£ï¼Œè§£å†³äº†PR-Då¯¼è‡´çš„è¯­ä¹‰å†²çªï¼

#### **2.2.4 å¸ç§å®šåˆ¶åŒ–**
- **ä»BTCç­‰ä¸»æµå¸æ”¹ä¸º**: AIAã€GPSã€ETH
- **é»˜è®¤å¸ç§**: AIA
- **å¸ç§æ•°é‡**: ä»5ä¸ªç¼©å‡åˆ°3ä¸ª
- **é…ç½®è·¯å¾„**: `config/l1_thresholds.yaml` â†’ `symbol_universe`

#### **2.2.5 å‰ç«¯ç®€åŒ–**
- **åˆ é™¤å¸‚åœºæ•°æ®æ¦‚è§ˆ**: ç§»é™¤ä»·æ ¼ã€æˆäº¤é‡ã€èµ„é‡‘è´¹ç‡ç­‰8ä¸ªæ•°æ®å¡ç‰‡
- **èšç„¦æ ¸å¿ƒåŠŸèƒ½**: å†³ç­–ä¿¡å·ã€å®‰å…¨é—¸é—¨ã€åŸå› æ ‡ç­¾ã€å†å²è®°å½•
- **ä»£ç ä¼˜åŒ–**: åˆ é™¤165è¡ŒHTML/CSS/JSä»£ç 

---

## 3. æ ¸å¿ƒåŠŸèƒ½

### 3.1 åŠŸèƒ½åˆ—è¡¨

| åŠŸèƒ½æ¨¡å— | å­åŠŸèƒ½ | çŠ¶æ€ | ç‰ˆæœ¬ |
|---------|--------|------|------|
| **æ•°æ®éªŒè¯** | å¿…éœ€å­—æ®µæ£€æŸ¥ | âœ… | v1.0 |
| | æŒ‡æ ‡è§„èŒƒåŒ– | âœ… | v2.0 PR-001 |
| | æ•°æ®æ–°é²œåº¦æ£€æŸ¥ | âœ… | v2.0 PR-002 |
| **å¸‚åœºåˆ†æ** | ç¯å¢ƒè¯†åˆ«(TREND/RANGE/EXTREME) | âœ… | v1.0 |
| **é£é™©å‡†å…¥** | æç«¯è¡Œæƒ… | âœ… | v1.0 |
| | æ¸…ç®—é˜¶æ®µæ£€æµ‹ | âœ… | v1.0 |
| | æ‹¥æŒ¤é£é™©æ£€æµ‹ | âœ… | v1.0 |
| | æç«¯æˆäº¤é‡æ£€æµ‹ | âœ… | v1.0 |
| **è´¨é‡è¯„ä¼°** | å¸çº³é£é™© | âœ… | v1.0 |
| | å™ªéŸ³å¸‚åœº | âœ… | v2.0 PR-004 |
| | è½®åŠ¨é£é™© | âœ… | v1.0 |
| | éœ‡è¡å¼±ä¿¡å· | âœ… | v1.0 |
| | ExecutabilityLevelæ˜ å°„ | âœ… | v3.0 PR-B |
| **æ–¹å‘è¯„ä¼°** | LONGæ¡ä»¶åˆ¤æ–­ | âœ… | v1.0 |
| | SHORTæ¡ä»¶åˆ¤æ–­ | âœ… | v1.0 |
| | èµ„é‡‘è´¹ç‡é™çº§ | âœ… | v1.0 |
| **å†³ç­–æ§åˆ¶** | æœ€å°å†³ç­–é—´éš” | âœ… | v3.0 PR-C |
| | ç¿»è½¬å†·å´ | âœ… | v3.0 PR-C |
| **ç½®ä¿¡åº¦è®¡ç®—** | 4å±‚æ¡£ä½ | âœ… | v2.0 PR-005 |
| | æ··åˆæ¨¡å¼(åŠ åˆ†+cap+boost) | âœ… | v3.0 PR-D |
| **æ‰§è¡Œè®¸å¯** | ExecutionPermissionä¸‰çº§ | âœ… | v3.0 æ–¹æ¡ˆD |
| | åŒé—¨æ§›æœºåˆ¶(ALLOW:HIGH/ALLOW_REDUCED:MEDIUM) | âœ… | v3.0 æ–¹æ¡ˆD |
| | ç»¼åˆåˆ¤å®š(æ ‡ç­¾+è´¨é‡+æ‰§è¡Œè®¸å¯) | âœ… | v3.0 PR-B+æ–¹æ¡ˆD |
| **å¯è§‚æµ‹æ€§** | Step TraceæŒä¹…åŒ– | âœ… | v2.0 PR-007 |
| | å†³ç­–ç®¡é“å¯è§†åŒ–(10æ­¥) | âœ… | v3.0 (å«æ–¹æ¡ˆD) |
| **æ•°æ®ç®¡ç†** | 24hçƒ­å­˜å‚¨ | âœ… | v2.0 PR-008 |
| **å¤šå¸ç§** | Symbol Universe | âœ… | v2.0 PR-010 |
| | AIA/GPS/ETHå®šåˆ¶ | âœ… | v3.0 |

---

## 4. å£å¾„è§„èŒƒï¼ˆPR-Aä¿®å¤ï¼‰

### 4.1 é—®é¢˜èƒŒæ™¯

**å†å²é—ç•™é—®é¢˜**ï¼ˆv1.0/v2.0ï¼‰ï¼š
- PR-001å®ç°äº†MetricsNormalizerï¼Œå°†è¾“å…¥æ•°æ®ç»Ÿä¸€ä¸ºå°æ•°æ ¼å¼
- ä½†é…ç½®æ–‡ä»¶ä¸­çš„é˜ˆå€¼ä»ä½¿ç”¨ç™¾åˆ†ç‚¹æ ¼å¼
- **å¯¼è‡´é˜ˆå€¼æ¯”è¾ƒæ°¸è¿œä¸æˆç«‹**

**é—®é¢˜ç¤ºä¾‹**ï¼š
```python
# æ•°æ®å±‚é¢ï¼ˆå·²è§„èŒƒåŒ–ï¼‰
data['price_change_1h'] = 0.05  # 5%ï¼ˆå°æ•°æ ¼å¼ï¼‰

# é…ç½®å±‚é¢ï¼ˆæœªä¿®å¤å‰ï¼‰
thresholds['trend_price_change_6h'] = 3.0  # å®é™…å˜æˆ300%ï¼

# æ¯”è¾ƒç»“æœ
0.05 > 3.0  # False â†’ æ°¸è¿œä¸è§¦å‘TREND
```

**å½±å“**ï¼š
- âŒ å¸‚åœºç¯å¢ƒè¯†åˆ«å¼‚å¸¸ï¼ˆEXTREME/TRENDæ°¸è¿œä¸è§¦å‘ï¼‰
- âŒ æ–¹å‘è¯„ä¼°å¼‚å¸¸ï¼ˆLONG/SHORTæ°¸è¿œä¸è§¦å‘ï¼‰
- âŒ é£é™©å‡†å…¥å¼‚å¸¸ï¼ˆæ¸…ç®—/æ‹¥æŒ¤æ£€æµ‹å¤±æ•ˆï¼‰
- âŒ è´¨é‡è¯„ä¼°å¼‚å¸¸ï¼ˆè½®åŠ¨/å¼±ä¿¡å·æ£€æµ‹å¤±æ•ˆï¼‰
- **ç»“æœ**: ç³»ç»Ÿåªä¼šè¾“å‡ºNO_TRADEï¼Œæ ¸å¿ƒå†³ç­–é€»è¾‘å®Œå…¨å¤±æ•ˆ

### 4.2 ä¿®å¤æ–¹æ¡ˆ

**ç»Ÿä¸€å£å¾„åŸåˆ™**ï¼š
```
å†…éƒ¨å­˜å‚¨: å°æ•°æ ¼å¼ï¼ˆ0.05 = 5%ï¼‰
é…ç½®æ–‡ä»¶: å°æ•°æ ¼å¼ï¼ˆ0.05 = 5%ï¼‰
è®¡ç®—é€»è¾‘: å°æ•°æ ¼å¼ï¼ˆ0.05 > 0.03 = Trueï¼‰
å‰ç«¯å±•ç¤º: ç™¾åˆ†æ¯”æ ¼å¼ï¼ˆ5% = 0.05 Ã— 100ï¼‰
```

### 4.3 ä¿®å¤æ¸…å•

#### å¸‚åœºç¯å¢ƒè¯†åˆ«
```yaml
# ä¿®å¤å‰
market_regime:
  extreme_price_change_1h: 5.0    # âŒ ç™¾åˆ†ç‚¹æ ¼å¼
  trend_price_change_6h: 3.0      # âŒ ç™¾åˆ†ç‚¹æ ¼å¼

# ä¿®å¤å
market_regime:
  extreme_price_change_1h: 0.05   # âœ… å°æ•°æ ¼å¼ï¼ˆ5%ï¼‰
  trend_price_change_6h: 0.03     # âœ… å°æ•°æ ¼å¼ï¼ˆ3%ï¼‰
```

#### é£é™©å‡†å…¥é˜ˆå€¼
```yaml
# ä¿®å¤å‰
risk_exposure:
  liquidation:
    price_change: 5.0             # âŒ ç™¾åˆ†ç‚¹
    oi_drop: -15.0                # âŒ ç™¾åˆ†ç‚¹
  crowding:
    oi_growth: 30.0               # âŒ ç™¾åˆ†ç‚¹

# ä¿®å¤å
risk_exposure:
  liquidation:
    price_change: 0.05            # âœ… å°æ•°ï¼ˆ5%ï¼‰
    oi_drop: -0.15                # âœ… å°æ•°ï¼ˆ-15%ï¼‰
  crowding:
    oi_growth: 0.30               # âœ… å°æ•°ï¼ˆ30%ï¼‰
```

#### äº¤æ˜“è´¨é‡é˜ˆå€¼
```yaml
# ä¿®å¤å‰
trade_quality:
  rotation:
    price_threshold: 2.0          # âŒ ç™¾åˆ†ç‚¹
    oi_threshold: 5.0             # âŒ ç™¾åˆ†ç‚¹
  range_weak:
    oi: 10.0                      # âŒ ç™¾åˆ†ç‚¹

# ä¿®å¤å
trade_quality:
  rotation:
    price_threshold: 0.02         # âœ… å°æ•°ï¼ˆ2%ï¼‰
    oi_threshold: 0.05            # âœ… å°æ•°ï¼ˆ5%ï¼‰
  range_weak:
    oi: 0.10                      # âœ… å°æ•°ï¼ˆ10%ï¼‰
```

#### æ–¹å‘è¯„ä¼°é˜ˆå€¼ï¼ˆæœ€å…³é”®ï¼‰
```yaml
# ä¿®å¤å‰
direction:
  trend:
    long:
      oi_change: 5.0              # âŒ ç™¾åˆ†ç‚¹
      price_change: 1.0           # âŒ ç™¾åˆ†ç‚¹
  range:
    long:
      oi_change: 10.0             # âŒ ç™¾åˆ†ç‚¹

# ä¿®å¤å
direction:
  trend:
    long:
      oi_change: 0.05             # âœ… å°æ•°ï¼ˆ5%ï¼‰
      price_change: 0.01          # âœ… å°æ•°ï¼ˆ1%ï¼‰
  range:
    long:
      oi_change: 0.10             # âœ… å°æ•°ï¼ˆ10%ï¼‰
```

### 4.4 éªŒè¯ç»“æœ

**æ–°å¢æµ‹è¯•**: `tests/test_decimal_calibration.py`

```
âœ… Test 1: é…ç½®é˜ˆå€¼å£å¾„æ£€æŸ¥
  - æ‰€æœ‰ç™¾åˆ†æ¯”é˜ˆå€¼ä½¿ç”¨å°æ•°æ ¼å¼
  - extreme=0.05, trend=0.03, liquidation=0.05
  - oi_change=0.05, price_change=0.01

âœ… Test 2: æ•°æ®è§„èŒƒåŒ–æ£€æŸ¥
  - ç™¾åˆ†ç‚¹è¾“å…¥è‡ªåŠ¨è½¬æ¢: 5.0 â†’ 0.05
  - å°æ•°è¾“å…¥ä¿æŒä¸å˜: 0.05 â†’ 0.05

âœ… Test 3: å¸‚åœºç¯å¢ƒè¯†åˆ«è§¦å‘
  - 6%å˜åŒ– â†’ EXTREME âœ“
  - 4%å˜åŒ–(6h) â†’ TREND âœ“
  - 1%å˜åŒ– â†’ RANGE âœ“

âœ… Test 4: æ–¹å‘è¯„ä¼°è§¦å‘
  - TREND+å¼ºå¤šæ–¹ â†’ allow_long=True âœ“
  - TREND+å¼ºç©ºæ–¹ â†’ allow_short=True âœ“
  - TREND+å¼±ä¿¡å· â†’ allow_long=False âœ“

âœ… Test 5: å®Œæ•´å†³ç­–æµç¨‹
  - å¼ºTREND+å¼ºLONG â†’ decision=LONG âœ“
  - confidence=ULTRA âœ“
  - executable=True âœ“
```

**å…³é”®è¯æ˜**ï¼š
```
ä¿®å¤å‰: æ‰€æœ‰å†³ç­–éƒ½æ˜¯NO_TRADEï¼ˆæ–¹å‘æ¡ä»¶ä»æœªè§¦å‘ï¼‰
ä¿®å¤å: å¼ºä¿¡å·å¯è§¦å‘LONG/SHORTå†³ç­–ï¼ˆç³»ç»Ÿæ­£å¸¸å·¥ä½œï¼‰
```

### 4.5 é˜²å›å½’æœºåˆ¶ï¼ˆå¯åŠ¨æ ¡éªŒï¼‰- 4é‡Guardrail

**é—®é¢˜**ï¼šå¦‚ä½•é˜²æ­¢æœªæ¥å†æ¬¡å¼•å…¥é…ç½®é”™è¯¯é—®é¢˜ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼šå¯åŠ¨æ—¶è‡ªåŠ¨æ ¡éªŒé…ç½®ï¼ˆ4é‡guardrailï¼‰

#### å®ç°ï¼ˆv3.1.5ï¼š4é‡æ ¡éªŒï¼‰

**ç¬¬1é‡ï¼šå£å¾„æ ¡éªŒï¼ˆPR-Aä¿®å¤ï¼‰**
```python
def _validate_decimal_calibration(self, config: dict):
    """
    å¯åŠ¨æ—¶æ ¡éªŒï¼šæ£€æŸ¥é…ç½®å£å¾„æ˜¯å¦ä¸ºå°æ•°æ ¼å¼ï¼ˆé˜²å›å½’ï¼‰
    
    æ ¡éªŒé€»è¾‘ï¼š
    - æ‰€æœ‰ç™¾åˆ†æ¯”é˜ˆå€¼çš„ç»å¯¹å€¼åº” < 1.0
    - å¦‚æœå‘ç° >= 1.0 çš„å€¼ï¼Œè®¤ä¸ºæ˜¯ç™¾åˆ†ç‚¹æ ¼å¼
    - æ‹’ç»å¯åŠ¨å¹¶è¾“å‡ºè¯¦ç»†é”™è¯¯ä¿¡æ¯
    """
    errors = []
    
    # æ£€æŸ¥market_regimeã€risk_exposureã€trade_qualityã€direction
    # å‘ç°é”™è¯¯ç«‹å³æ”¶é›†
    
    if errors:
        # æ ¼å¼åŒ–é”™è¯¯ä¿¡æ¯ï¼ŒåŒ…å«ï¼š
        # 1. é…ç½®è·¯å¾„ï¼ˆå¦‚ market_regime.extreme_price_change_1hï¼‰
        # 2. å½“å‰å€¼ï¼ˆå¦‚ 5.0ï¼‰
        # 3. ä¿®å¤å»ºè®®ï¼ˆå¦‚ åº”æ”¹ä¸º 0.05ï¼‰
        raise ValueError(error_message)
```

**ç¬¬2é‡ï¼šé—¨æ§›ä¸€è‡´æ€§æ ¡éªŒï¼ˆP1-3ï¼‰**
```python
def _validate_threshold_consistency(self, config: dict):
    """
    å¯åŠ¨æ—¶æ ¡éªŒï¼šé—¨æ§›ä¸€è‡´æ€§æ£€æŸ¥
    
    æ£€æŸ¥ï¼š
    1. min_confidence_reduced <= uncertain_quality_max
    2. min_confidence_reduced <= tag_caps (for reduce_tags)
    
    é˜²æ­¢é€»è¾‘çŸ›ç›¾ï¼ˆå¦‚å…è®¸é™çº§ä½†æ°¸è¿œè¾¾ä¸åˆ°é—¨æ§›ï¼‰
    """
```

**ç¬¬3é‡ï¼šReasonTagæ‹¼å†™æ ¡éªŒï¼ˆP1-3ï¼‰**
```python
def _validate_reason_tag_spelling(self, config: dict):
    """
    å¯åŠ¨æ—¶æ ¡éªŒï¼šReasonTagæ‹¼å†™æœ‰æ•ˆæ€§æ£€æŸ¥
    
    æ£€æŸ¥èŒƒå›´ï¼š
    1. reason_tag_rules.reduce_tags
    2. reason_tag_rules.deny_tags
    3. confidence_scoring.caps.tag_caps (keys)
    4. confidence_scoring.strong_signal_boost.required_tags
    
    Fail-fastæœºåˆ¶ï¼šæ‹¼å†™é”™è¯¯ç›´æ¥æ‹’ç»å¯åŠ¨
    """
```

**ç¬¬4é‡ï¼šConfidenceå€¼æ‹¼å†™æ ¡éªŒï¼ˆPR-Hï¼Œv3.1.3æ–°å¢ï¼‰**
```python
def _validate_confidence_values(self, config: dict):
    """
    å¯åŠ¨æ—¶æ ¡éªŒï¼šConfidenceå€¼æ‹¼å†™æœ‰æ•ˆæ€§æ£€æŸ¥
    
    æ£€æŸ¥èŒƒå›´ï¼š
    1. execution.min_confidence_normal
    2. execution.min_confidence_reduced
    3. confidence_scoring.caps.uncertain_quality_max
    4. confidence_scoring.caps.tag_caps.* (æ‰€æœ‰å€¼)
    
    æœ‰æ•ˆå€¼ï¼šLOW, MEDIUM, HIGH, ULTRAï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼‰
    Fail-fastæœºåˆ¶ï¼šæ‹¼å†™é”™è¯¯ç›´æ¥æ‹’ç»å¯åŠ¨
    """
```

**å¯åŠ¨æ—¶æ‰§è¡Œé¡ºåº**ï¼š
```python
# âš ï¸ å¯åŠ¨æ—¶æ ¡éªŒï¼šé˜²æ­¢é…ç½®é”™è¯¯ï¼ˆP1-3, PR-Hï¼‰
self._validate_decimal_calibration(self.config)        # 1. å£å¾„æ ¡éªŒ
self._validate_threshold_consistency(self.config)      # 2. é—¨æ§›ä¸€è‡´æ€§æ ¡éªŒ
self._validate_reason_tag_spelling(self.config)        # 3. ReasonTagæ‹¼å†™æ ¡éªŒ
self._validate_confidence_values(self.config)          # 4. Confidenceæ‹¼å†™æ ¡éªŒ
```
    
    logger.info("âœ… é…ç½®å£å¾„æ ¡éªŒé€šè¿‡ï¼šæ‰€æœ‰ç™¾åˆ†æ¯”é˜ˆå€¼ä½¿ç”¨å°æ•°æ ¼å¼")
```

#### æ ¡éªŒæ—¶æœº

```python
def __init__(self, config_path: str = None):
    self.config = self._load_config(config_path)
    
    # âš ï¸ å¯åŠ¨æ—¶æ ¡éªŒï¼šé˜²æ­¢å£å¾„å›å½’
    self._validate_decimal_calibration(self.config)  # ğŸ‘ˆ è¿™é‡Œæ‹¦æˆª
    
    self.thresholds = self._flatten_thresholds(self.config)
    # ...
```

#### é”™è¯¯ç¤ºä¾‹

```
================================================================================
âš ï¸  é…ç½®å£å¾„é”™è¯¯æ£€æµ‹ï¼ˆDecimal Calibration Validation Failedï¼‰
================================================================================
å‘ç°ç–‘ä¼¼ä½¿ç”¨ç™¾åˆ†ç‚¹æ ¼å¼çš„é˜ˆå€¼é…ç½®ï¼Œç³»ç»Ÿæ‹’ç»å¯åŠ¨ï¼

é”™è¯¯é¡¹ï¼š
  âŒ market_regime.extreme_price_change_1h = 5.0 (ç–‘ä¼¼ç™¾åˆ†ç‚¹æ ¼å¼ï¼Œåº”ä½¿ç”¨å°æ•°æ ¼å¼ï¼Œå¦‚ 0.05 è¡¨ç¤º 5%)
  âŒ direction.trend.long.oi_change = 5.0 (ç–‘ä¼¼ç™¾åˆ†ç‚¹æ ¼å¼ï¼Œåº”ä½¿ç”¨å°æ•°æ ¼å¼ï¼Œå¦‚ 0.05 è¡¨ç¤º 5%)
  âŒ risk_exposure.liquidation.oi_drop = -15.0 (ç–‘ä¼¼ç™¾åˆ†ç‚¹æ ¼å¼ï¼Œåº”ä½¿ç”¨å°æ•°æ ¼å¼ï¼Œå¦‚ 0.05 è¡¨ç¤º 5%)

ä¿®å¤æ–¹æ³•ï¼š
  1. æ‰“å¼€é…ç½®æ–‡ä»¶: config/l1_thresholds.yaml
  2. å°†æ‰€æœ‰ç™¾åˆ†æ¯”é˜ˆå€¼æ”¹ä¸ºå°æ•°æ ¼å¼:
     - é”™è¯¯: 5.0 (ç™¾åˆ†ç‚¹)
     - æ­£ç¡®: 0.05 (å°æ•°ï¼Œè¡¨ç¤º5%)
  3. å‚è€ƒæ–‡æ¡£: doc/å¹³å°è¯¦è§£3.1.md ç¬¬4ç« ï¼ˆå£å¾„è§„èŒƒï¼‰
================================================================================
```

#### æµ‹è¯•è¦†ç›–

**æµ‹è¯•æ–‡ä»¶**: `tests/test_calibration_validation.py` - **4/4é€šè¿‡** âœ…

```python
âœ… Test 1: æ­£ç¡®å°æ•°æ ¼å¼é€šè¿‡
  - å½“å‰é…ç½®ä½¿ç”¨å°æ•°æ ¼å¼ â†’ æ­£å¸¸å¯åŠ¨ âœ“

âœ… Test 2: ç™¾åˆ†ç‚¹æ ¼å¼è¢«æ‹¦æˆª
  - extreme_price_change_1h: 5.0 â†’ ValueError âœ“
  - trend_price_change_6h: 3.0 â†’ ValueError âœ“

âœ… Test 3: æ–¹å‘é˜ˆå€¼é”™è¯¯è¢«æ‹¦æˆª
  - direction.trend.long.oi_change: 5.0 â†’ ValueError âœ“
  - direction.trend.long.price_change: 1.0 â†’ ValueError âœ“
  - direction.range.long.oi_change: 10.0 â†’ ValueError âœ“

âœ… Test 4: å¤šé¡¹é”™è¯¯å…¨éƒ¨æŠ¥å‘Š
  - 8ä¸ªåŸºç¡€é”™è¯¯åŒæ—¶æ£€æµ‹ âœ“
  - é”™è¯¯ä¿¡æ¯åŒ…å«é…ç½®è·¯å¾„å’Œå…·ä½“æ•°å€¼ âœ“
```

**ä¿æŠ¤æ•ˆæœ**ï¼š
- âœ… ä»»ä½•äººä¿®æ”¹é…ç½®æ–‡ä»¶å¼•å…¥ç™¾åˆ†ç‚¹æ ¼å¼ â†’ å¯åŠ¨å¤±è´¥
- âœ… é”™è¯¯ä¿¡æ¯æ¸…æ™°ï¼Œç›´æ¥å®šä½é—®é¢˜
- âœ… ä¿®å¤å»ºè®®æ˜ç¡®ï¼Œé™ä½æ²Ÿé€šæˆæœ¬
- âœ… ä»æ ¹æœ¬ä¸Šæœç»å£å¾„å›å½’é£é™©

### 4.6 é‡è¦æ€§è¯„ä¼°

âš ï¸ **è¿™æ˜¯v3.0æœ€å…³é”®çš„ä¿®å¤ï¼**

**ä¸¥é‡ç¨‹åº¦**: ğŸ”´ **è‡´å‘½çº§åˆ«**
- v1.0/v2.0çš„æ–¹å‘è¯„ä¼°å®Œå…¨å¤±æ•ˆ
- æ‰€æœ‰LONG/SHORTå†³ç­–ä»æœªè¢«è§¦å‘è¿‡
- ç³»ç»Ÿå®é™…ä¸Šåªæ˜¯ä¸ª"æ°¸è¿œNO_TRADE"çš„ç©ºå£³

**ä¿®å¤å½±å“**:
- âœ… å¸‚åœºç¯å¢ƒè¯†åˆ«æ¢å¤æ­£å¸¸
- âœ… æ–¹å‘è¯„ä¼°æ¢å¤æ­£å¸¸
- âœ… **é¦–æ¬¡æˆåŠŸè§¦å‘LONG/SHORTå†³ç­–**
- âœ… ç³»ç»ŸçœŸæ­£å¼€å§‹å‘æŒ¥ä½œç”¨
- âœ… **å¯åŠ¨æ ¡éªŒé˜²æ­¢å›å½’**

**ç»éªŒæ•™è®­**ï¼š
1. å£å¾„ç»Ÿä¸€å¿…é¡»åœ¨æ•´ä¸ªç³»ç»Ÿç”Ÿå‘½å‘¨æœŸä¿æŒä¸€è‡´
2. é…ç½®æ–‡ä»¶æ³¨é‡Šè¦æ˜ç¡®è¯´æ˜æ ¼å¼ï¼ˆå°æ•° vs ç™¾åˆ†ç‚¹ï¼‰
3. å¿…é¡»æœ‰ç«¯åˆ°ç«¯æµ‹è¯•éªŒè¯é˜ˆå€¼è§¦å‘é€»è¾‘
4. MetricsNormalizerä¸é…ç½®é˜ˆå€¼å¿…é¡»åŒæ­¥ä¿®æ”¹
5. **å¯åŠ¨æ—¶æ ¡éªŒæ˜¯é˜²æ­¢å›å½’çš„æœ€åä¸€é“é˜²çº¿**

---

## 5. PR-B: è´¨é‡è¯­ä¹‰é’‰æ­» + æ–¹æ¡ˆD: æ‰§è¡Œè®¸å¯æœºåˆ¶

### 5.1 è®¾è®¡ç›®æ ‡

**é—®é¢˜**ï¼š
- TradeQualityä¸executableçš„è¯­ä¹‰ä¸æ¸…æ™°
- UNCERTAINæ˜¯å¦é˜»æ–­æ‰§è¡Œå­˜åœ¨æ­§ä¹‰
- ReasonTagå¯¹æ‰§è¡Œçš„å½±å“ç¼ºä¹ç»Ÿä¸€è§„åˆ™
- **æ–¹æ¡ˆD**: DEGRADEæ ‡ç­¾è¢«capåˆ°MEDIUMï¼Œä½†executableè¦æ±‚HIGHï¼Œå¯¼è‡´"é™çº§æ‰§è¡Œ"è¯­ä¹‰è¢«äº‹å®ä¸Šå¦å†³

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. å¼•å…¥ExecutabilityLevelä¸‰çº§æ§åˆ¶ï¼ˆALLOW/DEGRADE/BLOCKï¼‰
2. POORå¿…é¡»ç¡¬çŸ­è·¯ä¸ºNO_TRADE
3. UNCERTAINå…è®¸é™çº§æ‰§è¡Œä½†æœ‰ä¸Šé™
4. **æ–¹æ¡ˆD**: å¼•å…¥ExecutionPermissionä¸‰çº§è®¸å¯ + åŒé—¨æ§›æœºåˆ¶
5. executableç”±æ‰§è¡Œè®¸å¯çº§åˆ«å’ŒåŒé—¨æ§›ç»¼åˆåˆ¤å®š

### 5.2 ExecutabilityLevelå®šä¹‰

```python
class ExecutabilityLevel(Enum):
    ALLOW = "allow"      # ä¸å½±å“æ‰§è¡Œ
    DEGRADE = "degrade"  # é™çº§ä½†å…è®¸ï¼ˆå¦‚NOISY_MARKETï¼‰
    BLOCK = "block"      # é˜»æ–­æ‰§è¡Œï¼ˆå¦‚LIQUIDATION_PHASEï¼‰
```

### 5.3 ExecutionPermissionå®šä¹‰ï¼ˆæ–¹æ¡ˆDæ–°å¢ï¼‰

```python
class ExecutionPermission(Enum):
    ALLOW = "allow"                    # æ­£å¸¸æ‰§è¡Œ
    ALLOW_REDUCED = "allow_reduced"    # é™çº§æ‰§è¡Œï¼ˆæ›´ä¸¥æ ¼é—¨æ§›ï¼‰
    DENY = "deny"                      # æ‹’ç»æ‰§è¡Œ
```

**æ˜ å°„å…³ç³»**ï¼š
```
ExecutabilityLevel â†’ ExecutionPermission
- BLOCK â†’ DENYï¼ˆæ‹’ç»æ‰§è¡Œï¼‰
- DEGRADE â†’ ALLOW_REDUCEDï¼ˆé™çº§æ‰§è¡Œï¼‰
- ALLOW â†’ ALLOWï¼ˆæ­£å¸¸æ‰§è¡Œï¼‰
```

### 5.4 ReasonTagæ˜ å°„è§„åˆ™

| ReasonTag | ExecutabilityLevel | ExecutionPermission | è¯´æ˜ |
|-----------|-------------------|---------------------|------|
| **æ•°æ®éªŒè¯** |
| INVALID_DATA | BLOCK | DENY | æ•°æ®æ— æ•ˆ |
| DATA_STALE | BLOCK | DENY | æ•°æ®è¿‡æœŸ |
| **é£é™©å¦å†³ç±»** |
| EXTREME_REGIME | BLOCK | DENY | æç«¯è¡Œæƒ… |
| LIQUIDATION_PHASE | BLOCK | DENY | æ¸…ç®—é˜¶æ®µ |
| CROWDING_RISK | BLOCK | DENY | æ‹¥æŒ¤é£é™© |
| EXTREME_VOLUME | BLOCK | DENY | æç«¯æˆäº¤é‡ |
| **è´¨é‡å¦å†³ç±»** |
| ABSORPTION_RISK | BLOCK | DENY | å¸çº³é£é™©ï¼ˆPOORï¼‰ |
| ROTATION_RISK | BLOCK | DENY | è½®åŠ¨é£é™©ï¼ˆPOORï¼‰ |
| NOISY_MARKET | DEGRADE | ALLOW_REDUCED | å™ªéŸ³å¸‚åœºï¼ˆUNCERTAINï¼‰|
| WEAK_SIGNAL_IN_RANGE | DEGRADE | ALLOW_REDUCED | éœ‡è¡å¼±ä¿¡å·ï¼ˆUNCERTAINï¼‰|
| **æ–¹å‘å†²çªç±»** |
| CONFLICTING_SIGNALS | BLOCK | DENY | ä¿¡å·å†²çª |
| NO_CLEAR_DIRECTION | BLOCK | DENY | æ–¹å‘ä¸æ˜ |
| **å†³ç­–é¢‘ç‡æ§åˆ¶ç±»ï¼ˆPR-Cï¼‰** |
| MIN_INTERVAL_BLOCK | BLOCK | DENY | é—´éš”è¿‡çŸ­ |
| FLIP_COOLDOWN_BLOCK | BLOCK | DENY | ç¿»è½¬å†·å´ |
| **è¾…åŠ©ä¿¡æ¯ç±»** |
| HIGH_FUNDING_RATE | ALLOW | ALLOW | é«˜èµ„é‡‘è´¹ç‡ |
| LOW_FUNDING_RATE | ALLOW | ALLOW | ä½èµ„é‡‘è´¹ç‡ |
| STRONG_BUY_PRESSURE | ALLOW | ALLOW | å¼ºä¹°å‹ |
| STRONG_SELL_PRESSURE | ALLOW | ALLOW | å¼ºå–å‹ |
| OI_GROWING | ALLOW | ALLOW | æŒä»“å¢é•¿ |
| OI_DECLINING | ALLOW | ALLOW | æŒä»“ä¸‹é™ |

> âš ï¸ **å…³é”®è¯´æ˜ï¼šABSORPTION_RISK å’Œ ROTATION_RISK çš„æ‰§è¡Œä¿éšœ**
> 
> - è¿™ä¸¤ä¸ªæ ‡ç­¾è¢«è®¾ç½®ä¸º `ExecutabilityLevel.BLOCK` è€Œé `DEGRADE`ï¼ˆæ›´ä¿å®ˆç­–ç•¥ï¼‰
> - å®ƒä»¬**ç­‰ä»·äºé£é™©å¦å†³ç±»çš„ deny_tags**ï¼Œå…·æœ‰åŒé‡ä¿æŠ¤æœºåˆ¶ï¼š
>   1. **ç¬¬ä¸€é“é˜²çº¿**ï¼šè¿”å› `TradeQuality.POOR` â†’ Step 4 ç¡¬çŸ­è·¯ä¸º NO_TRADE
>   2. **ç¬¬äºŒé“é˜²çº¿**ï¼š`BLOCK` æ ‡ç­¾ â†’ Step 8 è®¡ç®— `ExecutionPermission.DENY` â†’ Step 10 çš„ `executable` æ°¸è¿œä¸º False
> - **å³ä½¿æœ‰å¼ºä¿¡å·æå‡ç½®ä¿¡åº¦**ï¼ˆStep 9ï¼‰ï¼Œä¹Ÿ**æ— æ³•ç»•è¿‡**è¿™ä¸¤é“é˜²çº¿
> - æ‰§è¡Œé¡ºåºä¿è¯ï¼šStep 8ï¼ˆæ‰§è¡Œè®¸å¯åˆ¤å®šï¼‰åœ¨ Step 9ï¼ˆç½®ä¿¡åº¦è®¡ç®—ï¼Œå«å¼ºä¿¡å·boostï¼‰ä¹‹å‰
> - è¿™ç¡®ä¿äº†**å¸çº³é£é™©**å’Œ**è½®åŠ¨é£é™©**åœºæ™¯ä¸‹ï¼Œç³»ç»Ÿç»ä¸ä¼šè¯¯æ‰§è¡Œäº¤æ˜“

### 5.5 è´¨é‡è¯„çº§ä¸ç½®ä¿¡åº¦å…³ç³»

```
GOODè´¨é‡:
  - ç½®ä¿¡åº¦: æ— é™åˆ¶ï¼ˆå¯è¾¾ULTRAï¼‰
  - execution_permission: å–å†³äºReasonTagï¼ˆé€šå¸¸ä¸ºALLOWï¼‰
  - executable: å–å†³äºç½®ä¿¡åº¦å’Œæ‰§è¡Œè®¸å¯çº§åˆ«

UNCERTAINè´¨é‡:
  - ç½®ä¿¡åº¦: â‰¤ HIGHï¼ˆæ–¹æ¡ˆDä¸Šè°ƒï¼ŒåŸä¸ºMEDIUMï¼‰
  - execution_permission: ALLOW_REDUCEDï¼ˆå¦‚æœæœ‰DEGRADEæ ‡ç­¾ï¼‰
  - executable: å¯ä»¥ä¸ºTrueï¼ˆä½¿ç”¨é™çº§é—¨æ§›MEDIUMï¼‰
  - ReasonTag: NOISY_MARKETæˆ–WEAK_SIGNAL_IN_RANGE

POORè´¨é‡:
  - å†³ç­–: ç¡¬çŸ­è·¯ä¸ºNO_TRADEï¼ˆStep 4ç›´æ¥è¿”å›ï¼‰
  - execution_permission: DENYï¼ˆå³ä½¿ä¸çŸ­è·¯ï¼ŒStep 8ä¹Ÿä¼šåˆ¤å®šä¸ºDENYï¼‰
  - executable: å¼ºåˆ¶Falseï¼ˆDENYåœ¨compute_executableä¸­æ°¸è¿œè¿”å›Falseï¼‰
  - ReasonTag: ABSORPTION_RISKæˆ–ROTATION_RISK
  - âš ï¸ åŒé‡ä¿æŠ¤ï¼šæ— è®ºç½®ä¿¡åº¦å¤šé«˜ï¼ˆåŒ…æ‹¬å¼ºä¿¡å·boostï¼‰ï¼Œéƒ½ä¸å¯èƒ½è¢«æ‰§è¡Œ
  - ç­‰ä»·äº deny_tagsï¼šä¸ LIQUIDATION_PHASEã€CROWDING_RISK ç­‰é£é™©å¦å†³ç±»åŒç­‰çº§
```

### 5.6 åŒé—¨æ§›æœºåˆ¶ï¼ˆæ–¹æ¡ˆDæ ¸å¿ƒï¼‰â­

> ğŸ“ **æ ¸å¿ƒå‚è€ƒç‚¹**ï¼šæœ¬èŠ‚åŒ…å« `compute_executable` çš„å®Œæ•´é€»è¾‘å’Œä¼ªä»£ç ï¼Œæ˜¯ç†è§£ executable åˆ¤å®šçš„**å”¯ä¸€çœŸç›¸**ã€‚

> âš ï¸ **é…ç½®çº¦æŸ**ï¼š`min_confidence_reduced` â‰¤ å„ç±»capï¼ˆ`uncertain_quality_max`, `tag_caps`ï¼‰ï¼Œå¦åˆ™é™çº§åœºæ™¯å°†æ°¸è¿œä¸å¯æ‰§è¡Œã€‚  
> å½“å‰é…ç½®ï¼šcap=**HIGH**, reduced=**MEDIUM** âœ… æ»¡è¶³çº¦æŸï¼ˆMEDIUM < HIGHï¼‰ã€‚

**é…ç½®**ï¼š
```yaml
executable_control:
  min_confidence_normal: "HIGH"      # ALLOW çš„æœ€ä½è¦æ±‚
  min_confidence_reduced: "MEDIUM"   # ALLOW_REDUCED çš„æœ€ä½è¦æ±‚
```

**é€»è¾‘**ï¼š
```python
def compute_executable(
    self,
    min_confidence_normal: Confidence = Confidence.HIGH,
    min_confidence_reduced: Confidence = Confidence.MEDIUM
) -> bool:
    # 1. å†³ç­–å¿…é¡»æ˜¯LONGæˆ–SHORT
    if self.decision == Decision.NO_TRADE:
        return False
    
    # 2. é£é™©å¿…é¡»é€šè¿‡
    if not self.risk_exposure_allowed:
        return False
    
    # 3. æ–¹æ¡ˆD: æ ¹æ®æ‰§è¡Œè®¸å¯çº§åˆ«åº”ç”¨ä¸åŒé—¨æ§›
    if self.execution_permission == ExecutionPermission.DENY:
        return False  # æ‹’ç»æ‰§è¡Œ
    
    elif self.execution_permission == ExecutionPermission.ALLOW:
        # æ­£å¸¸æ‰§è¡Œï¼šè¦æ±‚ >= HIGH
        return self._confidence_meets_threshold(
            self.confidence, min_confidence_normal
        )
    
    elif self.execution_permission == ExecutionPermission.ALLOW_REDUCED:
        # é™çº§æ‰§è¡Œï¼šè¦æ±‚ >= MEDIUMï¼ˆæ›´å®½æ¾ï¼‰
        return self._confidence_meets_threshold(
            self.confidence, min_confidence_reduced
        )
    
    return False

def _confidence_meets_threshold(
    self, confidence: Confidence, threshold: Confidence
) -> bool:
    """æ¯”è¾ƒç½®ä¿¡åº¦æ˜¯å¦è¾¾åˆ°é˜ˆå€¼"""
    confidence_order = [Confidence.LOW, Confidence.MEDIUM, 
                       Confidence.HIGH, Confidence.ULTRA]
    return confidence_order.index(confidence) >= confidence_order.index(threshold)
```

### 5.7 æ–¹æ¡ˆDè§£å†³çš„æ ¸å¿ƒå†²çª

**ä¿®å¤å‰**ï¼ˆé—®é¢˜ï¼‰ï¼š
```
NOISY_MARKET â†’ ExecutabilityLevel.DEGRADE
              â†“
          cap to MEDIUM
              â†“
executableè¦æ±‚: confidence in [ULTRA, HIGH]
              â†“
          MEDIUM not in [ULTRA, HIGH]
              â†“
          executable=False âŒï¼ˆDEGRADEè¢«äº‹å®ä¸Šå¦å†³ï¼‰
```

**ä¿®å¤å**ï¼ˆæ–¹æ¡ˆDï¼‰ï¼š
```
NOISY_MARKET â†’ ExecutabilityLevel.DEGRADE
              â†“
          ExecutionPermission.ALLOW_REDUCED
              â†“
          cap to HIGHï¼ˆä¸Šè°ƒï¼‰
              â†“
executableè¦æ±‚: HIGH >= MEDIUMï¼ˆé™çº§é—¨æ§›ï¼‰
              â†“
          True âœ…ï¼ˆçœŸæ­£å®ç°"é™çº§æ‰§è¡Œ"ï¼‰
```

### 5.8 å†³ç­–ç®¡é“é›†æˆ

**æ–°å¢æ­¥éª¤**ï¼ˆåœ¨ç½®ä¿¡åº¦è®¡ç®—å‰ï¼‰ï¼š

```
Step 8: è®¡ç®—æ‰§è¡Œè®¸å¯çº§åˆ«ï¼ˆæ–¹æ¡ˆDï¼‰
  - éå†reason_tags
  - å¦‚æœå­˜åœ¨BLOCKæ ‡ç­¾ â†’ DENY
  - å¦‚æœå­˜åœ¨DEGRADEæ ‡ç­¾ â†’ ALLOW_REDUCED
  - å¦åˆ™ â†’ ALLOW
```

```python
def _compute_execution_permission(
    self, reason_tags: List[ReasonTag]
) -> ExecutionPermission:
    """è®¡ç®—æ‰§è¡Œè®¸å¯çº§åˆ«"""
    from models.reason_tags import REASON_TAG_EXECUTABILITY, ExecutabilityLevel
    from models.enums import ExecutionPermission
    
    has_block = False
    has_degrade = False
    
    for tag in reason_tags:
        level = REASON_TAG_EXECUTABILITY.get(tag, ExecutabilityLevel.ALLOW)
        if level == ExecutabilityLevel.BLOCK:
            has_block = True
            break
        elif level == ExecutabilityLevel.DEGRADE:
            has_degrade = True
    
    if has_block:
        return ExecutionPermission.DENY
    elif has_degrade:
        return ExecutionPermission.ALLOW_REDUCED
    else:
        return ExecutionPermission.ALLOW
```

### 5.9 åœºæ™¯å¯¹æ¯”

| åœºæ™¯ | ä¿®å¤å‰ | ä¿®å¤åï¼ˆæ–¹æ¡ˆDï¼‰âœ… |
|------|-------|----------------|
| **å¼ºä¿¡å·** (GOOD, æ— é™çº§æ ‡ç­¾) | å¯æ‰§è¡Œ | confidence=ULTRA, permission=ALLOW, executable=True |
| **å™ªå£°å¸‚åœº** (UNCERTAIN, NOISY_MARKET) | âŒ ä¸å¯æ‰§è¡Œ | confidence=HIGH, permission=ALLOW_REDUCED, executable=True |
| **éœ‡è¡å¼±ä¿¡å·** (UNCERTAIN, WEAK_SIGNAL) | âŒ ä¸å¯æ‰§è¡Œ | confidence=HIGH, permission=ALLOW_REDUCED, executable=True |
| **æç«¯é£é™©** (POOR, EXTREME_VOLUME) | ä¸å¯æ‰§è¡Œ | confidence=LOW, permission=DENY, executable=False |

### 5.10 æµ‹è¯•è¦†ç›–

**åŸPR-Bæµ‹è¯•** (7ä¸ª):
```
âœ… Test 1: ExecutabilityLevelæ˜ å°„æ­£ç¡®æ€§
âœ… Test 2: has_blocking_tagså‡½æ•°
âœ… Test 3: has_degrading_tagså‡½æ•°
âœ… Test 4: POORè´¨é‡ç¡¬çŸ­è·¯
âœ… Test 5: UNCERTAINè´¨é‡é™çº§
âœ… Test 6: é™çº§æ ‡ç­¾é™åˆ¶ç½®ä¿¡åº¦ä¸Šé™
âœ… Test 7: executableç»¼åˆåˆ¤å®š
```

**æ–¹æ¡ˆDæ–°å¢æµ‹è¯•** (5ä¸ª):
```
âœ… Test 1: ExecutionPermissionæ˜ å°„æ­£ç¡®
âœ… Test 2: åŒé—¨æ§›æœºåˆ¶ç”Ÿæ•ˆ
âœ… Test 3: NOISY_MARKETå¯é™çº§æ‰§è¡Œï¼ˆæ ¸å¿ƒéªŒè¯ï¼‰
âœ… Test 4: EXTREMEåœºæ™¯æ‹’ç»æ‰§è¡Œ
âœ… Test 5: Capä¸é—¨æ§›é…ç½®ä¸€è‡´
```

---

## 6. PR-C: å†³ç­–é¢‘ç‡æ§åˆ¶

### 6.1 è®¾è®¡ç›®æ ‡

**é—®é¢˜**ï¼š
- L1æ˜¯å’¨è¯¢å±‚ï¼Œä¸åº”ç»´æŠ¤å¤æ‚æŒä»“/ACTIVE/CLOSEçŠ¶æ€
- ä½†éœ€è¦é˜²æ­¢çŸ­æ—¶é—´å†…é‡å¤ç»™å»ºè®®æˆ–æ–¹å‘é¢‘ç¹ç¿»è½¬

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æœ€å°å†³ç­–é—´éš”ï¼ˆMin Decision Intervalï¼‰
2. ç¿»è½¬å†·å´ï¼ˆFlip Cooldownï¼‰
3. æç®€è®°å¿†ç®¡ç†ï¼ˆåªè®°å½•æ—¶é—´å’Œæ–¹å‘ï¼‰

### 6.2 DecisionMemoryè®¾è®¡

```python
class DecisionMemory:
    """å†³ç­–è®°å¿†ç®¡ç†"""
    
    def __init__(self):
        self._memory = {}  # {symbol: {"time": datetime, "side": Decision}}
    
    def get_last_decision(self, symbol: str) -> Optional[Dict]:
        """è·å–æŒ‡å®šå¸ç§çš„ä¸Šæ¬¡å†³ç­–è®°å½•"""
        return self._memory.get(symbol)
    
    def update_decision(self, symbol: str, decision: Decision, timestamp: datetime):
        """æ›´æ–°å†³ç­–è®°å¿†ï¼ˆä»…LONG/SHORTï¼‰"""
        if decision in [Decision.LONG, Decision.SHORT]:
            self._memory[symbol] = {"time": timestamp, "side": decision}
```

**å…³é”®è®¾è®¡**ï¼š
- **å¤šå¸ç§ç‹¬ç«‹**: æ¯ä¸ªsymbolç‹¬ç«‹è®°å¿†
- **NO_TRADEä¸æ›´æ–°**: åªæœ‰LONG/SHORTæ‰æ›´æ–°è®°å¿†
- **è½»é‡çº§**: åªè®°å½•2ä¸ªå­—æ®µï¼ˆtime, sideï¼‰

### 6.3 æœ€å°å†³ç­–é—´éš”

**è§„åˆ™**ï¼š
```
IF è·ç¦»ä¸Šæ¬¡è¾“å‡ºLONG/SHORTæœªè¶…è¿‡min_decision_interval_seconds:
    æœ¬æ¬¡ç›´æ¥è¾“å‡ºNO_TRADEï¼ˆåŸå› ï¼šMIN_INTERVAL_BLOCKï¼‰
```

**ç¤ºä¾‹**ï¼š
```
T0: LONGå†³ç­–è¾“å‡ºï¼Œè®°å½•æ—¶é—´
T0+2min: å°è¯•LONG â†’ è¢«é˜»æ–­ â†’ NO_TRADE (MIN_INTERVAL_BLOCK)
T0+6min: å°è¯•LONG â†’ é€šè¿‡ï¼ˆè¶…è¿‡5åˆ†é’Ÿï¼‰
```

**é…ç½®**ï¼š
```yaml
decision_control:
  min_decision_interval_seconds: 300  # 5åˆ†é’Ÿ
  enable_min_interval: true
```

### 6.4 ç¿»è½¬å†·å´

**è§„åˆ™**ï¼š
```
IF æœ¬æ¬¡æ–¹å‘ä¸ä¸Šæ¬¡éNO_TRADEæ–¹å‘ç›¸å:
    AND é—´éš”æœªè¶…è¿‡flip_cooldown_seconds:
        æœ¬æ¬¡è¾“å‡ºNO_TRADEï¼ˆåŸå› ï¼šFLIP_COOLDOWN_BLOCKï¼‰
```

**ç¤ºä¾‹**ï¼š
```
T0: LONGå†³ç­–è¾“å‡º
T0+3min: å°è¯•SHORT â†’ è¢«é˜»æ–­ â†’ NO_TRADE (FLIP_COOLDOWN_BLOCK)
T0+11min: å°è¯•SHORT â†’ é€šè¿‡ï¼ˆè¶…è¿‡10åˆ†é’Ÿï¼‰
```

**é…ç½®**ï¼š
```yaml
decision_control:
  flip_cooldown_seconds: 600  # 10åˆ†é’Ÿ
  enable_flip_cooldown: true
```

### 6.5 å†³ç­–æµç¨‹é›†æˆ

åœ¨å†³ç­–ç®¡é“çš„Step 7æ’å…¥é¢‘ç‡æ§åˆ¶ï¼š

```
Step 1: æ•°æ®éªŒè¯ + è§„èŒƒåŒ–ï¼ˆPR-Jå¢å¼ºï¼Œv3.1.5ï¼‰
  â”œâ”€ 1.1 å¿…éœ€å­—æ®µæ£€æŸ¥
  â”œâ”€ 1.2 æ•°æ®æ–°é²œåº¦æ£€æŸ¥ï¼ˆPR-002ï¼‰
  â”œâ”€ 1.3 æŒ‡æ ‡è§„èŒƒåŒ–ï¼ˆPR-001ï¼‰
  â”œâ”€ 1.4 è¶…èŒƒå›´æ‹¦æˆªï¼ˆPR-Jï¼Œv3.1.5æ–°å¢ï¼‰âœ…
  â””â”€ 1.5 åŸºç¡€å¼‚å¸¸å€¼æ£€æŸ¥ï¼ˆåŒé‡ä¿æŠ¤ï¼‰
Step 2: å¸‚åœºç¯å¢ƒè¯†åˆ«ï¼ˆTREND/RANGE/EXTREMEï¼‰
Step 3: é£é™©å‡†å…¥è¯„ä¼°
Step 4: äº¤æ˜“è´¨é‡è¯„ä¼°
Step 5: æ–¹å‘è¯„ä¼°ï¼ˆLONG/SHORTåˆ¤æ–­ï¼‰
Step 6: å†³ç­–ä¼˜å…ˆçº§åˆ¤æ–­
Step 7: å†³ç­–é¢‘ç‡æ§åˆ¶ï¼ˆPR-Cæ–°å¢ï¼šæœ€å°é—´éš”+ç¿»è½¬å†·å´ï¼‰
Step 8: è®¡ç®—æ‰§è¡Œè®¸å¯çº§åˆ«ï¼ˆæ–¹æ¡ˆDæ–°å¢ï¼šALLOW/ALLOW_REDUCED/DENYï¼‰
Step 9: ç½®ä¿¡åº¦è®¡ç®—ï¼ˆPR-Dæ··åˆæ¨¡å¼ï¼šåŠ åˆ†+cap+boostï¼ŒPR-Iä¼˜åŒ–ï¼‰
Step 10: æ„é€ ç»“æœ + executableåˆ¤å®šï¼ˆæ–¹æ¡ˆDåŒé—¨æ§›ï¼‰
```

```python
def _apply_decision_control(
    self, symbol: str, decision: Decision, 
    reason_tags: List[ReasonTag], timestamp: datetime
) -> Tuple[Decision, List[ReasonTag]]:
    control_tags = []
    
    if decision == Decision.NO_TRADE:
        return decision, control_tags
    
    last = self.decision_memory.get_last_decision(symbol)
    if last is None:
        return decision, control_tags
    
    elapsed = (timestamp - last['time']).total_seconds()
    
    # æ£€æŸ¥1: æœ€å°å†³ç­–é—´éš”
    if enable_min_interval and elapsed < min_interval:
        control_tags.append(ReasonTag.MIN_INTERVAL_BLOCK)
        return Decision.NO_TRADE, control_tags
    
    # æ£€æŸ¥2: ç¿»è½¬å†·å´
    if enable_flip_cooldown:
        is_flip = (decision != last['side'])
        if is_flip and elapsed < flip_cooldown:
            control_tags.append(ReasonTag.FLIP_COOLDOWN_BLOCK)
            return Decision.NO_TRADE, control_tags
    
    return decision, control_tags
```

### 6.6 æ–°å¢ReasonTag

```python
# å†³ç­–é¢‘ç‡æ§åˆ¶ç±»ï¼ˆPR-Cï¼‰
MIN_INTERVAL_BLOCK = "min_interval_block"
FLIP_COOLDOWN_BLOCK = "flip_cooldown_block"

# ä¸­æ–‡è§£é‡Š
"min_interval_block": "â±ï¸ é—´éš”è¿‡çŸ­ï¼šè·ç¦»ä¸Šæ¬¡å†³ç­–æ—¶é—´è¿‡çŸ­ï¼Œé˜²æ­¢é¢‘ç¹è¾“å‡º"
"flip_cooldown_block": "ğŸ”„ ç¿»è½¬å†·å´ï¼šæ–¹å‘ç¿»è½¬å†·å´æœŸå†…ï¼Œé˜²æ­¢é¢‘ç¹åˆ‡æ¢"
```

### 6.7 æµ‹è¯•è¦†ç›–

```
âœ… Test 1: DecisionMemoryåŸºæœ¬åŠŸèƒ½
âœ… Test 2: æœ€å°é—´éš”é˜»æ–­
âœ… Test 3: ç¿»è½¬å†·å´é˜»æ–­
âœ… Test 4: ç¦ç”¨æ§åˆ¶åŠŸèƒ½
```

---

## 7. PR-D: ç½®ä¿¡åº¦æ··åˆæ¨¡å¼

### 7.1 è®¾è®¡ç›®æ ‡

**é—®é¢˜**ï¼š
- PR-005çš„çº¯åŠ åˆ†åˆ¶å¯èƒ½è®©UNCERTAIN+TREND+å¼ºä¿¡å·è¾¾åˆ°ULTRAï¼ˆä¸åˆç†ï¼‰
- PR-Bçš„é™çº§æ ‡ç­¾å·²ç»é™åˆ¶ï¼Œä½†PR-Déœ€è¦æ›´ç³»ç»Ÿçš„capæœºåˆ¶
- éœ‡è¡å¸‚+å¼ºä¿¡å·åº”è¯¥æœ‰çªç ´èƒ½åŠ›ï¼ˆä¸è¢«çŸ­æ¿å®Œå…¨å‹æ­»ï¼‰

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ä¿ç•™ç°æœ‰4æ¡£åŠ åˆ†åˆ¶ï¼ˆä¸æ¨ç¿»PR-005ï¼‰
2. æ–°å¢ç¡¬é™çº§ä¸Šé™ï¼ˆcapsï¼‰
3. æ–°å¢å¼ºä¿¡å·çªç ´ï¼ˆboostï¼‰
4. ä¸‰æ­¥æµç¨‹ï¼šåŠ åˆ† â†’ cap â†’ boost

### 7.2 ä¸‰æ­¥æµç¨‹

**ç½®ä¿¡åº¦è®¡ç®—å†…éƒ¨æµç¨‹**ï¼ˆå¯¹åº”ä¸»ç®¡é“Step 9ï¼‰ï¼š

```
å­æ­¥éª¤1: åŸºç¡€åŠ åˆ†
  - decision_score: 30åˆ†ï¼ˆLONG/SHORTï¼‰
  - regime_score: TREND=30, RANGE=10, EXTREME=0
  - quality_score: GOOD=30, UNCERTAIN=15, POOR=0
  - strong_signal_bonus: 10åˆ†
  - æ€»åˆ†æ˜ å°„: â‰¥90â†’ULTRA, â‰¥65â†’HIGH, â‰¥40â†’MEDIUM, <40â†’LOW

å­æ­¥éª¤2: åº”ç”¨capï¼ˆç¡¬é™çº§ä¸Šé™ï¼Œæ–¹æ¡ˆDä¿®è®¢ï¼‰
  - UNCERTAINè´¨é‡ â†’ â‰¤HIGHï¼ˆæ–¹æ¡ˆDä¸Šè°ƒï¼ŒåŸä¸ºMEDIUMï¼‰
  - reduce_tags (NOISY_MARKETç­‰) â†’ â‰¤HIGHï¼ˆæ–¹æ¡ˆDä¸Šè°ƒï¼ŒåŸä¸ºMEDIUMï¼‰
  - deny_tags (LIQUIDATION_PHASEç­‰) â†’ LOWï¼ˆå·²åœ¨å­æ­¥éª¤3çŸ­è·¯ï¼‰

å­æ­¥éª¤3: å¼ºä¿¡å·çªç ´
  - å¦‚æœæœ‰STRONG_BUY_PRESSUREæˆ–STRONG_SELL_PRESSURE
  - ç½®ä¿¡åº¦+1æ¡£ï¼ˆä½†ä¸å¯çªç ´capé™åˆ¶ï¼‰
```

### 7.3 åŸºç¡€åŠ åˆ†é…ç½®

```yaml
confidence_scoring:
  # åŸºç¡€åˆ†
  decision_score: 30               # å†³ç­–ç±»å‹åˆ†
  regime_trend_score: 30           # TRENDç¯å¢ƒåˆ†
  regime_range_score: 10           # RANGEç¯å¢ƒåˆ†
  regime_extreme_score: 0          # EXTREMEç¯å¢ƒåˆ†
  quality_good_score: 30           # GOODè´¨é‡åˆ†
  quality_uncertain_score: 15      # UNCERTAINè´¨é‡åˆ†ï¼ˆé™çº§ï¼‰
  quality_poor_score: 0            # POORè´¨é‡åˆ†
  strong_signal_bonus: 10          # å¼ºä¿¡å·åŠ åˆ†
  
  # æ¡£ä½æ˜ å°„
  thresholds:
    ultra: 90                      # â‰¥90åˆ† â†’ ULTRA
    high: 65                       # â‰¥65åˆ† â†’ HIGH
    medium: 40                     # â‰¥40åˆ† â†’ MEDIUM
```

### 7.4 ç¡¬é™çº§ä¸Šé™ï¼ˆcapsï¼Œæ–¹æ¡ˆDè°ƒæ•´ï¼‰

```yaml
confidence_scoring:
  caps:
    # UNCERTAINè´¨é‡çš„ä¸Šé™ï¼ˆæ–¹æ¡ˆD: MEDIUM â†’ HIGHï¼‰
    uncertain_quality_max: "HIGH"
    
    # ç‰¹å®šReasonTagçš„ä¸Šé™ï¼ˆæ–¹æ¡ˆD: MEDIUM â†’ HIGHï¼‰
    tag_caps:
      noisy_market: "HIGH"
      weak_signal_in_range: "HIGH"
```

**æ–¹æ¡ˆDè°ƒæ•´è¯´æ˜**ï¼š
- å°†UNCERTAINå’ŒDEGRADEæ ‡ç­¾çš„capä»`MEDIUM`ä¸Šè°ƒåˆ°`HIGH`
- é…åˆåŒé—¨æ§›æœºåˆ¶ï¼Œä½¿ALLOW_REDUCEDåœºæ™¯å¯æ‰§è¡Œï¼ˆHIGH >= MEDIUMé—¨æ§›ï¼‰
- ä¿è¯"é™çº§æ‰§è¡Œ"è¯­ä¹‰çœŸæ­£è½åœ°

**é€»è¾‘**ï¼š
```python
def _apply_confidence_caps(
    self, confidence: Confidence, quality: TradeQuality, reason_tags: List[ReasonTag]
) -> Tuple[Confidence, bool]:
    has_cap = False
    
    # 1. UNCERTAINè´¨é‡ä¸Šé™ï¼ˆæ–¹æ¡ˆD: HIGHï¼‰
    if quality == TradeQuality.UNCERTAIN:
        max_level = self._string_to_confidence("HIGH")  # æ–¹æ¡ˆDä¿®è®¢
        if self._confidence_level(confidence) > self._confidence_level(max_level):
            confidence = max_level
            has_cap = True
    
    # 2. reduce_tagsä¸Šé™ï¼ˆæ–¹æ¡ˆD: HIGHï¼‰
    for tag in reason_tags:
        if tag.value in reduce_tags or tag.value in tag_caps:
            max_level = self._string_to_confidence(tag_caps.get(tag.value, "HIGH"))  # æ–¹æ¡ˆDä¿®è®¢
            if self._confidence_level(confidence) > self._confidence_level(max_level):
                confidence = max_level
                has_cap = True
    
    return confidence, has_cap
```

### 7.5 å¼ºä¿¡å·çªç ´ï¼ˆboostï¼‰

```yaml
confidence_scoring:
  strong_signal_boost:
    enabled: true                  # æ˜¯å¦å¯ç”¨
    boost_levels: 1                # æå‡æ¡£æ•°
    
    # è§¦å‘çªç ´çš„æ ‡ç­¾
    required_tags:
      - strong_buy_pressure
      - strong_sell_pressure
```

**é€»è¾‘**ï¼š
```python
def _apply_strong_signal_boost(
    self, confidence: Confidence, reason_tags: List[ReasonTag],
    cap_limit: Confidence, has_strong_signal: bool
) -> Confidence:
    if not has_strong_signal:
        return confidence
    
    # æå‡1æ¡£
    boosted = self._boost_confidence(confidence, 1)
    
    # ä¸èƒ½çªç ´cap
    if self._confidence_level(boosted) > self._confidence_level(cap_limit):
        return cap_limit
    
    return boosted
```

**å…³é”®**ï¼š
- å¼ºä¿¡å·å¯ä»¥+1æ¡£
- ä½†**ä¸èƒ½çªç ´capé™åˆ¶**

### 7.6 ç¤ºä¾‹åœºæ™¯

#### åœºæ™¯1: TREND + GOOD + å¼ºä¿¡å·
```
åŸºç¡€åŠ åˆ†: 30+30+30+10 = 100åˆ† â†’ ULTRA
åº”ç”¨cap: æ— cap
å¼ºä¿¡å·çªç ´: å·²æ˜¯ULTRAï¼Œæ— éœ€çªç ´
æœ€ç»ˆ: ULTRA
```

#### åœºæ™¯2: TREND + UNCERTAIN + å¼ºä¿¡å·ï¼ˆæ–¹æ¡ˆDä¿®è®¢ï¼‰
```
åŸºç¡€åŠ åˆ†: 30+30+15+10 = 85åˆ† â†’ HIGH
åº”ç”¨cap: UNCERTAIN â†’ capåˆ°HIGHï¼ˆæ–¹æ¡ˆD: MEDIUMâ†’HIGHï¼‰
å¼ºä¿¡å·çªç ´: å·²æ˜¯HIGHï¼Œå°è¯•HIGH+1â†’ULTRAï¼Œä½†è¢«capé™åˆ¶
æœ€ç»ˆ: HIGH
executable: HIGH >= MEDIUMï¼ˆé™çº§é—¨æ§›ï¼‰â†’ True âœ…
```

#### åœºæ™¯3: RANGE + GOOD + å¼ºä¿¡å·
```
åŸºç¡€åŠ åˆ†: 30+10+30+10 = 80åˆ† â†’ HIGH
åº”ç”¨cap: æ— cap
å¼ºä¿¡å·çªç ´: HIGH+1 â†’ ULTRA ï¼ˆæ— capæ—¶å¯çªç ´ï¼‰
æœ€ç»ˆ: ULTRA
executable: ULTRA >= HIGHï¼ˆæ­£å¸¸é—¨æ§›ï¼‰â†’ True âœ…
```

#### åœºæ™¯4: TREND + GOOD + NOISY_MARKETï¼ˆæ–¹æ¡ˆDä¿®è®¢ï¼‰
```
åŸºç¡€åŠ åˆ†: 30+30+30+10 = 100åˆ† â†’ ULTRA
åº”ç”¨cap: NOISY_MARKET â†’ capåˆ°HIGHï¼ˆæ–¹æ¡ˆD: MEDIUMâ†’HIGHï¼‰
å¼ºä¿¡å·çªç ´: å°è¯•HIGH+1â†’ULTRAï¼Œä½†è¢«capé™åˆ¶
æœ€ç»ˆ: HIGH
execution_permission: ALLOW_REDUCEDï¼ˆNOISY_MARKETæ˜¯DEGRADEï¼‰
executable: HIGH >= MEDIUMï¼ˆé™çº§é—¨æ§›ï¼‰â†’ True âœ…ï¼ˆæ–¹æ¡ˆDå‰ä¸ºFalseï¼‰
```

### 7.7 é…ç½®åŒ–ç®¡ç†

æ‰€æœ‰è§„åˆ™éƒ½å¯ä»¥é€šè¿‡`config/l1_thresholds.yaml`é…ç½®ï¼š

```yaml
# ==================
# ç½®ä¿¡åº¦é…ç½®ï¼ˆPR-Dæ··åˆæ¨¡å¼ï¼‰
# ==================
confidence_scoring:
  # åŸºç¡€åˆ†ï¼ˆä¿æŒç°æœ‰è¯„åˆ†ä½“ç³»ï¼‰
  decision_score: 30
  regime_trend_score: 30
  regime_range_score: 10
  quality_good_score: 30
  quality_uncertain_score: 15
  strong_signal_bonus: 10
  
  # æ¡£ä½æ˜ å°„
  thresholds:
    ultra: 90
    high: 65
    medium: 40
  
  # ç¡¬é™çº§ä¸Šé™ï¼ˆæ–¹æ¡ˆDä¿®è®¢ï¼šMEDIUM â†’ HIGHï¼‰
  caps:
    uncertain_quality_max: "HIGH"  # æ–¹æ¡ˆDä¸Šè°ƒï¼Œå…è®¸é™çº§æ‰§è¡Œ
    tag_caps:
      noisy_market: "HIGH"  # æ–¹æ¡ˆDä¸Šè°ƒ
      weak_signal_in_range: "HIGH"  # æ–¹æ¡ˆDä¸Šè°ƒ
  
  # å¼ºä¿¡å·çªç ´
  strong_signal_boost:
    enabled: true
    boost_levels: 1
    required_tags:
      - strong_buy_pressure
      - strong_sell_pressure

# ==================
# ReasonTagåˆ†ç±»è§„åˆ™ï¼ˆPR-Dï¼‰
# ==================
reason_tag_rules:
  # é™çº§æ ‡ç­¾ï¼ˆè§¦å‘capï¼‰
  reduce_tags:
    - noisy_market
    - weak_signal_in_range
  
  # å¦å†³æ ‡ç­¾ï¼ˆå¼ºåˆ¶LOWï¼‰
  deny_tags:
    - liquidation_phase
    - crowding_risk
    - extreme_volume
    - data_stale
    - extreme_regime
    - absorption_risk
    - rotation_risk
```

### 7.8 æµ‹è¯•è¦†ç›–

```
âœ… Test 1: åŸºç¡€åŠ åˆ†åˆ¶æ­£å¸¸
âœ… Test 2: UNCERTAINè´¨é‡ä¸Šé™ç”Ÿæ•ˆ
âœ… Test 3: é™çº§æ ‡ç­¾ä¸Šé™ç”Ÿæ•ˆ
âœ… Test 4: å¼ºä¿¡å·çªç ´åŠŸèƒ½æ­£å¸¸
âœ… Test 5: å¼ºä¿¡å·æ— æ³•çªç ´cap
âœ… Test 6: ç½®ä¿¡åº¦æ¡£ä½æ¯”è¾ƒåŠŸèƒ½
âœ… Test 7: å­—ç¬¦ä¸²è½¬ç½®ä¿¡åº¦åŠŸèƒ½
```

---

## 8. å†³ç­–ç®¡é“

### 8.1 å®Œæ•´10æ­¥æµç¨‹ï¼ˆå«æ–¹æ¡ˆDï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: æ•°æ®éªŒè¯ + æŒ‡æ ‡è§„èŒƒåŒ– + æ–°é²œåº¦æ£€æŸ¥              â”‚
â”‚  - å¿…éœ€å­—æ®µæ£€æŸ¥                                         â”‚
â”‚  - ç™¾åˆ†æ¯”ç»Ÿä¸€ä¸ºå°æ•°æ ¼å¼ï¼ˆPR-Aå£å¾„ä¿®å¤ï¼‰                 â”‚
â”‚  - æ•°æ®å¹´é¾„æ£€æŸ¥ï¼ˆâ‰¤120ç§’ï¼‰                               â”‚
â”‚  - å¤±è´¥ â†’ NO_TRADE + INVALID_DATA/DATA_STALE           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: å¸‚åœºç¯å¢ƒè¯†åˆ«                                     â”‚
â”‚  - EXTREME: 1hä»·æ ¼å˜åŒ– > 5%ï¼ˆ0.05å°æ•°æ ¼å¼ï¼‰            â”‚
â”‚  - TREND: 6hä»·æ ¼å˜åŒ– > 3%ï¼ˆ0.03å°æ•°æ ¼å¼ï¼‰              â”‚
â”‚  - RANGE: å…¶ä»–æƒ…å†µï¼ˆé»˜è®¤ï¼‰                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: é£é™©å‡†å…¥è¯„ä¼°ï¼ˆç¬¬ä¸€é“é—¸é—¨ï¼‰                       â”‚
â”‚  - EXTREMEè¡Œæƒ… â†’ æ‹’ç»                                   â”‚
â”‚  - æ¸…ç®—é˜¶æ®µï¼ˆä»·æ ¼æ€¥å˜+OIéª¤é™ï¼‰â†’ æ‹’ç»                    â”‚
â”‚  - æ‹¥æŒ¤é£é™©ï¼ˆæç«¯è´¹ç‡+é«˜OIå¢é•¿ï¼‰â†’ æ‹’ç»                  â”‚
â”‚  - æç«¯æˆäº¤é‡ï¼ˆ1h > 24hå‡å€¼Ã—10ï¼‰â†’ æ‹’ç»                 â”‚
â”‚  - å¤±è´¥ â†’ NO_TRADE + é£é™©æ ‡ç­¾                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: äº¤æ˜“è´¨é‡è¯„ä¼°ï¼ˆç¬¬äºŒé“é—¸é—¨ï¼‰                       â”‚
â”‚  - å¸çº³é£é™© â†’ POOR                                      â”‚
â”‚  - å™ªéŸ³å¸‚åœº â†’ UNCERTAIN                                 â”‚
â”‚  - è½®åŠ¨é£é™© â†’ POOR                                      â”‚
â”‚  - éœ‡è¡å¼±ä¿¡å· â†’ UNCERTAIN                               â”‚
â”‚  - POOR â†’ ç¡¬çŸ­è·¯ä¸ºNO_TRADEï¼ˆPR-Bï¼‰                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: æ–¹å‘è¯„ä¼°ï¼ˆSHORTä¼˜å…ˆï¼‰                           â”‚
â”‚  - TRENDå¸‚: ä»·æ ¼+å¤±è¡¡+OIç»¼åˆåˆ¤æ–­                        â”‚
â”‚  - RANGEå¸‚: æ›´é«˜é˜ˆå€¼è¦æ±‚                                â”‚
â”‚  - èµ„é‡‘è´¹ç‡é™çº§: HIGHâ†’SHORT, LOWâ†’LONG                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: å†³ç­–ä¼˜å…ˆçº§åˆ¤æ–­                                   â”‚
â”‚  - LONG&SHORTåŒæ—¶æ»¡è¶³ â†’ CONFLICTING_SIGNALS â†’ NO_TRADE â”‚
â”‚  - ä»…SHORTæ»¡è¶³ â†’ SHORTï¼ˆä¼˜å…ˆçº§é«˜ï¼‰                      â”‚
â”‚  - ä»…LONGæ»¡è¶³ â†’ LONG                                    â”‚
â”‚  - å‡ä¸æ»¡è¶³ â†’ NO_CLEAR_DIRECTION â†’ NO_TRADE            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 7: å†³ç­–é¢‘ç‡æ§åˆ¶ï¼ˆPR-Cæ–°å¢ï¼‰                        â”‚
â”‚  - æœ€å°å†³ç­–é—´éš”æ£€æŸ¥ï¼ˆé»˜è®¤300ç§’ï¼‰                        â”‚
â”‚  - ç¿»è½¬å†·å´æ£€æŸ¥ï¼ˆé»˜è®¤600ç§’ï¼‰                            â”‚
â”‚  - å¤±è´¥ â†’ NO_TRADE + MIN_INTERVAL_BLOCK/FLIP_COOLDOWN   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 8: è®¡ç®—æ‰§è¡Œè®¸å¯çº§åˆ«ï¼ˆæ–¹æ¡ˆDæ–°å¢ï¼‰                   â”‚
â”‚  - éå†reason_tagsï¼Œæ£€æŸ¥ExecutabilityLevel:             â”‚
â”‚    â€¢ å­˜åœ¨BLOCKæ ‡ç­¾ â†’ ExecutionPermission.DENY           â”‚
â”‚    â€¢ å­˜åœ¨DEGRADEæ ‡ç­¾ â†’ ExecutionPermission.ALLOW_REDUCEDâ”‚
â”‚    â€¢ å…¶ä»– â†’ ExecutionPermission.ALLOW                   â”‚
â”‚  - æ—¥å¿—è¾“å‡º: execution_permissionçº§åˆ«                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 9: ç½®ä¿¡åº¦è®¡ç®—ï¼ˆPR-Dæ··åˆæ¨¡å¼ï¼‰                      â”‚
â”‚  1. åŸºç¡€åŠ åˆ†ï¼ˆdecision+regime+quality+strong_signalï¼‰   â”‚
â”‚  2. åº”ç”¨capï¼ˆUNCERTAINâ‰¤HIGH, reduce_tagsâ‰¤HIGHï¼‰         â”‚
â”‚  3. å¼ºä¿¡å·çªç ´ï¼ˆ+1æ¡£ä½†ä¸çªç ´capï¼‰                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 10: æ„é€ ç»“æœ + executableåˆ¤å®šï¼ˆè¯¦è§5.6èŠ‚ï¼‰         â”‚
â”‚  1. æ„é€ AdvisoryResult:                                 â”‚
â”‚     - decision, confidence, execution_permissionç­‰       â”‚
â”‚  2. executableåˆ¤å®šï¼ˆåŒé—¨æ§›æœºåˆ¶ï¼Œå®Œæ•´é€»è¾‘è§5.6èŠ‚ï¼‰:      â”‚
â”‚     - å†³ç­–=LONG/SHORT                                   â”‚
â”‚     - é£é™©é€šè¿‡                                          â”‚
â”‚     - æ ¹æ®execution_permissionåº”ç”¨ä¸åŒé—¨æ§›:              â”‚
â”‚       â€¢ DENY â†’ False                                    â”‚
â”‚       â€¢ ALLOW â†’ è¦æ±‚confidence >= HIGH                  â”‚
â”‚       â€¢ ALLOW_REDUCED â†’ è¦æ±‚confidence >= MEDIUM        â”‚
â”‚  3. æ›´æ–°å†³ç­–è®°å¿†ï¼ˆä»…LONG/SHORTï¼‰                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 ç®¡é“æ­¥éª¤æ•°æ®ç»“æ„

```python
{
    "step": 1,
    "name": "validate_data",
    "status": "success",  # success | warning | failed | pending
    "message": "æ•°æ®éªŒè¯é€šè¿‡ï¼ˆå«è§„èŒƒåŒ–+æ–°é²œåº¦æ£€æŸ¥ï¼‰",
    "result": "Valid"
}
```

### 8.3 å¯è§†åŒ–å±•ç¤º

å‰ç«¯é€šè¿‡`/api/l1/pipeline/{symbol}`æ¥å£è·å–ç®¡é“æ­¥éª¤ï¼Œå¹¶å±•ç¤ºï¼š
- âœ… æˆåŠŸæ­¥éª¤ï¼ˆç»¿è‰²ï¼‰
- âš ï¸ è­¦å‘Šæ­¥éª¤ï¼ˆé»„è‰²ï¼‰
- âŒ å¤±è´¥æ­¥éª¤ï¼ˆçº¢è‰²ï¼‰
- â³ å¾…å¤„ç†æ­¥éª¤ï¼ˆç°è‰²ï¼‰

---

## 9. æŠ€æœ¯æ¶æ„

### 9.1 æŠ€æœ¯æ ˆ

| å±‚æ¬¡ | æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|------|
| **åç«¯** | Python | 3.12 | æ ¸å¿ƒå†³ç­–å¼•æ“ |
| | Flask | 3.0+ | WebæœåŠ¡æ¡†æ¶ |
| | APScheduler | - | å®šæ—¶ä»»åŠ¡ã€æ•°æ®ç¼“å­˜ |
| | Watchdog | - | é…ç½®çƒ­æ›´æ–° |
| **æ•°æ®åº“** | SQLite | - | å†³ç­–ç»“æœæŒä¹…åŒ– |
| **å‰ç«¯** | HTML5 + CSS3 | - | Webç•Œé¢ |
| | JavaScript (Vanilla) | ES6+ | åŠ¨æ€äº¤äº’ |
| **æ•°æ®æº** | Binance API | - | åˆçº¦å¸‚åœºæ•°æ® |
| **å®¹å™¨åŒ–** | Docker | - | æœåŠ¡å®¹å™¨åŒ– |
| | Docker Compose | - | æœåŠ¡ç¼–æ’ |
| **éƒ¨ç½²** | AWS EC2 | - | ç”Ÿäº§ç¯å¢ƒ |

### 9.2 æ ¸å¿ƒæ¨¡å—

```
trade-info/
â”œâ”€â”€ market_state_machine_l1.py    # æ ¸å¿ƒå†³ç­–å¼•æ“
â”‚   â”œâ”€â”€ L1AdvisoryEngine          # ä¸»å¼•æ“ç±»
â”‚   â”œâ”€â”€ DecisionMemory            # å†³ç­–è®°å¿†ï¼ˆPR-Cï¼‰
â”‚   â”œâ”€â”€ _validate_data()          # Step 1
â”‚   â”œâ”€â”€ _detect_market_regime()   # Step 2
â”‚   â”œâ”€â”€ _eval_risk_exposure_allowed()  # Step 3
â”‚   â”œâ”€â”€ _eval_trade_quality()     # Step 4
â”‚   â”œâ”€â”€ _eval_long/short_direction()   # Step 5
â”‚   â”œâ”€â”€ _decide_priority()        # Step 6
â”‚   â”œâ”€â”€ _apply_decision_control() # Step 7ï¼ˆPR-Cï¼‰
â”‚   â”œâ”€â”€ _compute_execution_permission() # Step 8ï¼ˆæ–¹æ¡ˆDï¼‰
â”‚   â”œâ”€â”€ _compute_confidence()     # Step 9ï¼ˆPR-Dï¼‰
â”‚   â””â”€â”€ _build_advisory_result()  # Step 10
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ enums.py                  # æšä¸¾å®šä¹‰
â”‚   â”œâ”€â”€ advisory_result.py        # å†³ç­–ç»“æœæ•°æ®ç±»
â”‚   â””â”€â”€ reason_tags.py            # åŸå› æ ‡ç­¾ï¼ˆPR-Bæ‰©å±•ï¼‰
â”‚       â”œâ”€â”€ ExecutabilityLevel    # ä¸‰çº§æ§åˆ¶
â”‚       â”œâ”€â”€ ReasonTag             # æ ‡ç­¾æšä¸¾
â”‚       â”œâ”€â”€ REASON_TAG_EXECUTABILITY  # æ˜ å°„è§„åˆ™
â”‚       â”œâ”€â”€ has_blocking_tags()   # è¾…åŠ©å‡½æ•°
â”‚       â””â”€â”€ has_degrading_tags()  # è¾…åŠ©å‡½æ•°
â”‚
â”œâ”€â”€ btc_web_app_l1.py             # Flask WebæœåŠ¡
â”œâ”€â”€ database_l1.py                # æ•°æ®åº“æ“ä½œ
â”œâ”€â”€ data_cache.py                 # æ•°æ®ç¼“å­˜
â”œâ”€â”€ binance_data_fetcher.py       # Binance APIå°è£…
â”œâ”€â”€ metrics_normalizer.py         # æŒ‡æ ‡è§„èŒƒåŒ–
â”œâ”€â”€ logger_config.py              # æ—¥å¿—é…ç½®
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ l1_thresholds.yaml        # é…ç½®æ–‡ä»¶ï¼ˆPR-Dæ‰©å±•ï¼‰
â”‚
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ css/style_l1.css          # æ ·å¼ï¼ˆPR-åˆ é™¤å¸‚åœºæ•°æ®æ¦‚è§ˆï¼‰
â”‚   â””â”€â”€ js/app_l1.js              # å‰ç«¯é€»è¾‘
â”‚
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index_l1.html             # Webé¡µé¢ï¼ˆPR-ç®€åŒ–ï¼‰
â”‚
â””â”€â”€ tests/
    â”œâ”€â”€ test_pr_b_trade_quality.py       # PR-Bæµ‹è¯•
    â”œâ”€â”€ test_pr_c_decision_control.py    # PR-Cæµ‹è¯•
    â””â”€â”€ test_pr_d_confidence_hybrid.py   # PR-Dæµ‹è¯•
```

### 9.3 æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Binance API â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ åŸå§‹å¸‚åœºæ•°æ®
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DataCache   â”‚ â† å®šæ—¶åˆ·æ–°ï¼ˆ60sï¼‰
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ è§„èŒƒåŒ–æ•°æ®
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ L1AdvisoryEngine â”‚ â† 10æ­¥å†³ç­–ç®¡é“
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ AdvisoryResult
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ L1Database   â”‚ â† æŒä¹…åŒ–ï¼ˆ24hçƒ­å­˜å‚¨ï¼‰
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Flask API    â”‚ â† /api/l1/advisory/{symbol}
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ JSON
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Web Frontend â”‚ â† å®æ—¶å±•ç¤º
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. é…ç½®ç®¡ç†

### 10.1 å®Œæ•´é…ç½®æ–‡ä»¶

`config/l1_thresholds.yaml`:

```yaml
# L1 Advisory Layer - é˜ˆå€¼é…ç½®æ–‡ä»¶

# ==================
# Symbol Universeï¼ˆå¸ç§å®‡å®™ï¼‰
# ==================
symbol_universe:
  enabled_symbols:
    - AIA    # AIA
    - GPS    # GPS
    - ETH    # ä»¥å¤ªåŠ
  default_symbol: AIA

# ==================
# æ•°æ®è´¨é‡é˜ˆå€¼
# ==================
data_quality:
  max_staleness_seconds: 120      # æ•°æ®æœ€å¤§è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰

# ==================
# å†³ç­–é¢‘ç‡æ§åˆ¶ï¼ˆPR-Cï¼‰
# ==================
decision_control:
  min_decision_interval_seconds: 300  # æœ€å°å†³ç­–é—´éš”ï¼ˆ5åˆ†é’Ÿï¼‰
  flip_cooldown_seconds: 600          # ç¿»è½¬å†·å´ï¼ˆ10åˆ†é’Ÿï¼‰
  enable_min_interval: true
  enable_flip_cooldown: true

# ==================
# å¸‚åœºç¯å¢ƒè¯†åˆ«é˜ˆå€¼ï¼ˆPR-Aå£å¾„ä¿®å¤ï¼šå°æ•°æ ¼å¼ï¼‰
# ==================
market_regime:
  extreme_price_change_1h: 0.05   # 1å°æ—¶ä»·æ ¼å˜åŒ– > 5% â†’ EXTREMEï¼ˆå°æ•°æ ¼å¼ï¼š0.05=5%ï¼‰
  trend_price_change_6h: 0.03     # 6å°æ—¶ä»·æ ¼å˜åŒ– > 3% â†’ TRENDï¼ˆå°æ•°æ ¼å¼ï¼š0.03=3%ï¼‰

# ==================
# é£é™©å‡†å…¥é˜ˆå€¼ï¼ˆPR-Aå£å¾„ä¿®å¤ï¼šå°æ•°æ ¼å¼ï¼‰
# ==================
risk_exposure:
  liquidation:
    price_change: 0.05            # ä»·æ ¼å˜åŒ–é˜ˆå€¼ï¼ˆå°æ•°æ ¼å¼ï¼š0.05=5%ï¼‰
    oi_drop: -0.15                # OIä¸‹é™é˜ˆå€¼ï¼ˆå°æ•°æ ¼å¼ï¼š-0.15=-15%ï¼‰
  crowding:
    funding_abs: 0.001            # è´¹ç‡ç»å¯¹å€¼é˜ˆå€¼ï¼ˆ0.1%ï¼‰
    oi_growth: 0.30               # 6h OIå¢é•¿é˜ˆå€¼ï¼ˆå°æ•°æ ¼å¼ï¼š0.30=30%ï¼‰
  extreme_volume:
    multiplier: 10.0              # 1hæˆäº¤é‡è¶…è¿‡24hå‡å€¼çš„å€æ•°

# ==================
# äº¤æ˜“è´¨é‡é˜ˆå€¼ï¼ˆPR-Aå£å¾„ä¿®å¤ï¼šå°æ•°æ ¼å¼ï¼‰
# ==================
trade_quality:
  absorption:
    imbalance: 0.7                # ä¹°å–å¤±è¡¡é˜ˆå€¼
    volume_ratio: 0.5             # æˆäº¤é‡æ¯”ä¾‹ï¼ˆç›¸å¯¹äº24hå‡å€¼ï¼‰
  noise:
    funding_volatility: 0.0005    # è´¹ç‡æ³¢åŠ¨é˜ˆå€¼ï¼ˆ0.05%ï¼‰
    funding_abs: 0.0001           # å½“å‰è´¹ç‡é˜ˆå€¼ï¼ˆ0.01%ï¼‰
  rotation:
    price_threshold: 0.02         # ä»·æ ¼å˜åŒ–é˜ˆå€¼ï¼ˆå°æ•°æ ¼å¼ï¼š0.02=2%ï¼‰
    oi_threshold: 0.05            # OIå˜åŒ–é˜ˆå€¼ï¼ˆå°æ•°æ ¼å¼ï¼š0.05=5%ï¼‰
  range_weak:
    imbalance: 0.6                # å¤±è¡¡é˜ˆå€¼
    oi: 0.10                      # OIå˜åŒ–é˜ˆå€¼ï¼ˆå°æ•°æ ¼å¼ï¼š0.10=10%ï¼‰

# ==================
# æ–¹å‘è¯„ä¼°é˜ˆå€¼ï¼ˆPR-Aå£å¾„ä¿®å¤ï¼šå°æ•°æ ¼å¼ï¼‰
# ==================
direction:
  trend:
    long:
      imbalance: 0.6              # ä¹°å–å¤±è¡¡é˜ˆå€¼ï¼ˆå¤šæ–¹ï¼‰
      oi_change: 0.05             # 1h OIå¢é•¿é˜ˆå€¼ï¼ˆå°æ•°æ ¼å¼ï¼š0.05=5%ï¼‰
      price_change: 0.01          # 1hä»·æ ¼ä¸Šæ¶¨é˜ˆå€¼ï¼ˆå°æ•°æ ¼å¼ï¼š0.01=1%ï¼‰
    short:
      imbalance: -0.6             # ä¹°å–å¤±è¡¡é˜ˆå€¼ï¼ˆç©ºæ–¹ï¼Œè´Ÿå€¼ï¼‰
      oi_change: 0.05             # 1h OIå¢é•¿é˜ˆå€¼ï¼ˆå°æ•°æ ¼å¼ï¼š0.05=5%ï¼‰
      price_change: -0.01         # 1hä»·æ ¼ä¸‹è·Œé˜ˆå€¼ï¼ˆå°æ•°æ ¼å¼ï¼š-0.01=-1%ï¼‰
  range:
    long:
      imbalance: 0.7              # æ›´é«˜çš„å¤±è¡¡è¦æ±‚
      oi_change: 0.10             # æ›´é«˜çš„OIå¢é•¿è¦æ±‚ï¼ˆå°æ•°æ ¼å¼ï¼š0.10=10%ï¼‰
    short:
      imbalance: -0.7             # è´Ÿå€¼è¡¨ç¤ºç©ºæ–¹
      oi_change: 0.10             # å°æ•°æ ¼å¼ï¼š0.10=10%

# ==================
# ç½®ä¿¡åº¦é…ç½®ï¼ˆPR-Dæ··åˆæ¨¡å¼ï¼‰
# ==================
confidence_scoring:
  # åŸºç¡€åˆ†ï¼ˆä¿æŒç°æœ‰è¯„åˆ†ä½“ç³»ï¼‰
  decision_score: 30
  regime_trend_score: 30
  regime_range_score: 10
  regime_extreme_score: 0
  quality_good_score: 30
  quality_uncertain_score: 15      # UNCERTAINé™çº§
  quality_poor_score: 0
  strong_signal_bonus: 10
  
  # æ¡£ä½æ˜ å°„
  thresholds:
    ultra: 90                      # â‰¥90åˆ† â†’ ULTRA
    high: 65                       # â‰¥65åˆ† â†’ HIGH
    medium: 40                     # â‰¥40åˆ† â†’ MEDIUM
  
  # ç¡¬é™çº§ä¸Šé™ï¼ˆcapsï¼Œæ–¹æ¡ˆDä¿®è®¢ï¼‰
  caps:
    uncertain_quality_max: "HIGH"        # æ–¹æ¡ˆD: MEDIUM â†’ HIGHï¼ˆå…è®¸é™çº§æ‰§è¡Œï¼‰
    tag_caps:
      noisy_market: "HIGH"               # æ–¹æ¡ˆD: MEDIUM â†’ HIGH
      weak_signal_in_range: "HIGH"       # æ–¹æ¡ˆD: MEDIUM â†’ HIGH
  
  # å¼ºä¿¡å·çªç ´
  strong_signal_boost:
    enabled: true
    boost_levels: 1
    required_tags:
      - strong_buy_pressure
      - strong_sell_pressure

# ==================
# æ‰§è¡Œæ§åˆ¶ï¼ˆæ–¹æ¡ˆDæ–°å¢ï¼‰
# ==================
executable_control:
  min_confidence_normal: "HIGH"          # ALLOW é—¨æ§›ï¼šæ­£å¸¸æ‰§è¡Œè¦æ±‚ HIGH/ULTRA
  min_confidence_reduced: "MEDIUM"       # ALLOW_REDUCED é—¨æ§›ï¼šé™çº§æ‰§è¡Œè¦æ±‚ MEDIUMåŠä»¥ä¸Š
  
  # è¯´æ˜ï¼š
  # - ALLOW: æ— é™çº§æ ‡ç­¾ï¼Œè¦æ±‚ HIGH/ULTRA
  # - ALLOW_REDUCED: æœ‰DEGRADEæ ‡ç­¾ï¼ˆå¦‚NOISY_MARKETï¼‰ï¼Œè¦æ±‚ MEDIUMåŠä»¥ä¸Š
  # - DENY: æœ‰BLOCKæ ‡ç­¾ï¼ˆå¦‚EXTREME_VOLUMEï¼‰ï¼Œæ°¸è¿œä¸å¯æ‰§è¡Œ
  
  # é…ç½®çº¦æŸï¼ˆé‡è¦ï¼‰ï¼š
  # - min_confidence_reduced â‰¤ uncertain_quality_max/tag_capsï¼Œå¦åˆ™é™çº§åœºæ™¯ä¸å¯æ‰§è¡Œ
  # - å½“å‰é…ç½®ï¼šMEDIUM â‰¤ HIGH âœ… æ»¡è¶³çº¦æŸ
  # - éªŒè¯ï¼šæµ‹è¯• "Capä¸é—¨æ§›é…ç½®ä¸€è‡´" ä¼šè‡ªåŠ¨æ£€æŸ¥æ­¤çº¦æŸ

# ==================
# ReasonTagåˆ†ç±»è§„åˆ™ï¼ˆPR-Dï¼‰
# ==================
reason_tag_rules:
  reduce_tags:
    - noisy_market
    - weak_signal_in_range
  deny_tags:
    - liquidation_phase
    - crowding_risk
    - extreme_volume
    - data_stale
    - extreme_regime
    - absorption_risk
    - rotation_risk
```

### 10.2 é…ç½®çƒ­æ›´æ–°

ç³»ç»Ÿä½¿ç”¨Watchdogç›‘å¬é…ç½®æ–‡ä»¶å˜åŒ–ï¼Œæ”¯æŒçƒ­æ›´æ–°ï¼ˆæ— éœ€é‡å¯æœåŠ¡ï¼‰ã€‚

---

## 11. Webç•Œé¢

### 11.1 ç•Œé¢ç»„æˆ

**v3.0ç®€åŒ–ç‰ˆ**ï¼ˆåˆ é™¤å¸‚åœºæ•°æ®æ¦‚è§ˆï¼‰ï¼š

1. **å¤´éƒ¨** - ç³»ç»Ÿæ ‡é¢˜ã€æœ€åæ›´æ–°æ—¶é—´ã€åˆ·æ–°æŒ‰é’®
2. **å¸ç§é€‰æ‹©** - AIAã€GPSã€ETHæŒ‰é’®åˆ‡æ¢
3. **æ ¸å¿ƒå†³ç­–ä¿¡å·** - å†³ç­–æ–¹å‘ã€ç½®ä¿¡åº¦ã€æ—¶é—´æˆ³
4. **å®‰å…¨é—¸é—¨çŠ¶æ€** - é£é™©å‡†å…¥ã€äº¤æ˜“è´¨é‡ã€å¸‚åœºç¯å¢ƒã€ç³»ç»ŸçŠ¶æ€
5. **å†³ç­–åŸå› æ ‡ç­¾** - åˆ†ç±»å±•ç¤ºã€é¢œè‰²æ ‡è¯†
6. **å†å²å†³ç­–è®°å½•** - æœ€è¿‘30æ¡ã€å¯æŠ˜å å±•å¼€
7. **å†³ç­–ç®¡é“å¯è§†åŒ–** - 10æ­¥æµç¨‹çŠ¶æ€
8. **é¡µè„šä¿¡æ¯** - ç³»ç»Ÿè¯´æ˜ã€é£é™©æç¤º

**å·²åˆ é™¤**ï¼š
- âŒ å¸‚åœºæ•°æ®æ¦‚è§ˆï¼ˆä»·æ ¼ã€æˆäº¤é‡ã€èµ„é‡‘è´¹ç‡ç­‰8ä¸ªæ•°æ®å¡ç‰‡ï¼‰

### 11.2 è®¿é—®åœ°å€

- **æœ¬åœ°**: http://localhost:8001/
- **AWS**: http://43.212.176.169:8001/

### 11.3 è‡ªåŠ¨åˆ·æ–°

- åˆ·æ–°å‘¨æœŸ: 60ç§’
- å¯æ‰‹åŠ¨åˆ·æ–°

---

## 12. APIæ¥å£

### 12.1 æ ¸å¿ƒæ¥å£

#### 12.1.1 è·å–å†³ç­–å»ºè®®

```http
GET /api/l1/advisory/{symbol}
```

**å“åº”ç¤ºä¾‹**ï¼ˆå«æ–¹æ¡ˆDæ–°å¢å­—æ®µï¼‰ï¼š
```json
{
  "success": true,
  "data": {
    "decision": "no_trade",
    "confidence": "low",
    "execution_permission": "deny",      // æ–¹æ¡ˆDæ–°å¢ï¼šæ‰§è¡Œè®¸å¯çº§åˆ«
    "market_regime": "range",
    "system_state": "wait",
    "risk_exposure_allowed": false,
    "trade_quality": "poor",
    "reason_tags": [
      "weak_signal_in_range"
    ],
    "timestamp": "2026-01-20T21:48:45.123456",
    "executable": false
  },
  "message": "Advisory generated successfully"
}
```

**execution_permissionå–å€¼è¯´æ˜**ï¼š
- `"allow"`: æ­£å¸¸æ‰§è¡Œï¼ˆæ— é™çº§æ ‡ç­¾ï¼Œè¦æ±‚HIGH/ULTRAï¼‰
- `"allow_reduced"`: é™çº§æ‰§è¡Œï¼ˆæœ‰DEGRADEæ ‡ç­¾å¦‚NOISY_MARKETï¼Œè¦æ±‚MEDIUMåŠä»¥ä¸Šï¼‰
- `"deny"`: æ‹’ç»æ‰§è¡Œï¼ˆæœ‰BLOCKæ ‡ç­¾å¦‚EXTREME_VOLUMEï¼‰

#### 12.1.2 è·å–å¸ç§åˆ—è¡¨

```http
GET /api/markets
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "success": true,
  "data": {
    "markets": {
      "AIA": {"futures": true, "spot": false},
      "GPS": {"futures": true, "spot": false},
      "ETH": {"futures": true, "spot": false}
    },
    "default_symbol": "AIA"
  }
}
```

#### 12.1.3 è·å–å†³ç­–ç®¡é“

```http
GET /api/l1/pipeline/{symbol}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "success": true,
  "data": {
    "steps": [
      {
        "step": 1,
        "name": "validate_data",
        "status": "success",
        "message": "æ•°æ®éªŒè¯é€šè¿‡",
        "result": "Valid"
      },
      {
        "step": 7,
        "name": "decision_control",
        "status": "failed",
        "message": "é¢‘ç‡æ§åˆ¶é˜»æ–­ï¼šmin_interval_block",
        "result": "Blocked"
      }
    ]
  }
}
```

---

## 13. éƒ¨ç½²æ¶æ„

### 13.1 éƒ¨ç½²ç¯å¢ƒ

| ç¯å¢ƒ | åœ°å€ | çŠ¶æ€ | ç”¨é€” |
|------|------|------|------|
| **æœ¬åœ°å¼€å‘** | localhost:8001 | æŒ‰éœ€å¯åŠ¨ | å¼€å‘è°ƒè¯•ã€æµ‹è¯• |
| **AWSç”Ÿäº§** | 43.212.176.169:8001 | æŒç»­è¿è¡Œ | ç”Ÿäº§æœåŠ¡ |

### 13.2 Dockeréƒ¨ç½²

#### æœ¬åœ°éƒ¨ç½²

```bash
# å¯åŠ¨æœåŠ¡
./docker-l1-run.sh

# åœæ­¢æœåŠ¡
./docker-l1-stop.sh

# æŸ¥çœ‹æ—¥å¿—
docker logs -f l1-advisory-layer

# é‡å¯æœåŠ¡
docker compose -f docker-compose-l1.yml restart
```

#### AWSéƒ¨ç½²

```bash
# åŒæ­¥ä»£ç 
rsync -avz --exclude 'data/db/*.db' \
  -e "ssh -i ../john-test.pem" \
  ./ ubuntu@43.212.176.169:~/trade-info-l1/

# SSHç™»å½•
ssh -i ../john-test.pem ubuntu@43.212.176.169

# éƒ¨ç½²æœåŠ¡
cd ~/trade-info-l1
docker compose -f docker-compose-l1.yml down
docker compose -f docker-compose-l1.yml build
docker compose -f docker-compose-l1.yml up -d

# æŸ¥çœ‹çŠ¶æ€
docker ps
docker logs -f l1-advisory-layer
```

### 13.3 æ•°æ®æŒä¹…åŒ–

```
./data/db/
â”œâ”€â”€ l1_advisory_results.db    # å†³ç­–ç»“æœæ•°æ®åº“
â””â”€â”€ l1_advisory_results.db-wal  # WALæ—¥å¿—

./config/
â””â”€â”€ l1_thresholds.yaml        # é…ç½®æ–‡ä»¶ï¼ˆçƒ­æ›´æ–°ï¼‰
```

---

## 14. æµ‹è¯•è¦†ç›–

### 14.1 æµ‹è¯•åˆ—è¡¨

| PR | æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•æ•°é‡ | çŠ¶æ€ |
|----|---------|---------|------|
| **PR-001** | test_pr_batch1.py | 1 | âœ… |
| **PR-002** | test_pr_batch1.py | 1 | âœ… |
| **PR-003** | test_pr_batch1.py | 1 | âœ… |
| **PR-004** | test_pr_batch2.py | 1 | âœ… |
| **PR-005** | test_pr_batch2.py | 1 | âœ… |
| **PR-006** | test_pr_batch2.py | 1 | âœ… |
| **PR-007** | test_pr_batch3.py | 1 | âœ… |
| **PR-008** | test_pr_batch3.py | 1 | âœ… |
| **PR-009** | test_pr_batch3.py | 1 | âœ… |
| **PR-010** | test_pr_batch3.py | 1 | âœ… |
| **PR-B** | test_pr_b_trade_quality.py | 7 | âœ… |
| **PR-C** | test_pr_c_decision_control.py | 4 | âœ… |
| **PR-D** | test_pr_d_confidence_hybrid.py | 7 | âœ… |
| **PR-Aä¿®å¤** | test_decimal_calibration.py | 5 | âœ… |
| **PR-Aé˜²å›å½’** | test_calibration_validation.py | 4 | âœ… |
| **æ–¹æ¡ˆD** | test_execution_permission.py | 5 | âœ… |
| **P0-1ä¿®å¤** | test_p0_1_weak_signal_fix.py | 1 | âœ… |
| **P0-1éªŒè¯** | test_case_a.py | 1 | âœ… |
| **P0-2ä¿®å¤** | test_p0_2_funding_prev.py | 1 | âœ… |
| **P0-3ä¿®å¤** | test_p0_3_oi_auxiliary.py | 3 | âœ… |
| **æ€»è®¡** | - | **48** | âœ… |

### 14.2 æµ‹è¯•å‘½ä»¤

```bash
# åœ¨Dockerå®¹å™¨ä¸­è¿è¡Œ
docker exec l1-advisory-layer python tests/test_pr_b_trade_quality.py
docker exec l1-advisory-layer python tests/test_pr_c_decision_control.py
docker exec l1-advisory-layer python tests/test_pr_d_confidence_hybrid.py

# P0ä¿®å¤æµ‹è¯•
docker exec l1-advisory-layer python tests/test_p0_1_weak_signal_fix.py
docker exec l1-advisory-layer python tests/test_p0_2_funding_prev.py
docker exec l1-advisory-layer python tests/test_p0_3_oi_auxiliary.py

# æˆ–æ‰¹é‡è¿è¡Œå…¨éƒ¨æµ‹è¯•
docker exec l1-advisory-layer bash -c "
  python tests/test_pr_b_trade_quality.py && \
  python tests/test_pr_c_decision_control.py && \
  python tests/test_pr_d_confidence_hybrid.py && \
  python tests/test_p0_1_weak_signal_fix.py && \
  python tests/test_p0_2_funding_prev.py && \
  python tests/test_p0_3_oi_auxiliary.py
"
```

### 14.3 æµ‹è¯•è¦†ç›–ç‡

```
æ ¸å¿ƒåŠŸèƒ½è¦†ç›–:
  - æ•°æ®éªŒè¯: âœ…
  - æ•°æ®å£å¾„è§„èŒƒ: âœ… (PR-A)
  - å¯åŠ¨æ ¡éªŒ: âœ… (PR-Aé˜²å›å½’)
  - å¸‚åœºç¯å¢ƒè¯†åˆ«: âœ…
  - é£é™©å‡†å…¥: âœ…
  - è´¨é‡è¯„ä¼°: âœ… (å«P0-1ä¿®å¤)
  - æ–¹å‘è¯„ä¼°: âœ…
  - å†³ç­–é¢‘ç‡æ§åˆ¶: âœ… (PR-C)
  - æ‰§è¡Œè®¸å¯çº§åˆ«: âœ… (æ–¹æ¡ˆD)
  - ç½®ä¿¡åº¦è®¡ç®—: âœ… (PR-D)
  - executableåˆ¤å®š: âœ… (PR-B + æ–¹æ¡ˆD)
  - ç®¡é“è¿½æº¯: âœ…
  - å¤šå¸ç§æ”¯æŒ: âœ… (å«P0-2ä¿®å¤)
  - è¾…åŠ©æ ‡ç­¾: âœ… (å«P0-3ä¿®å¤)

PR-Aä¸“é¡¹æµ‹è¯•:
  âœ… é…ç½®æ–‡ä»¶å°æ•°æ ¼å¼æ­£ç¡®
  âœ… æ•°æ®è§„èŒƒåŒ–æ­£ç¡®
  âœ… å¸‚åœºç¯å¢ƒè§¦å‘æ­£ç¡®
  âœ… æ–¹å‘è¯„ä¼°è§¦å‘æ­£ç¡®
  âœ… å…¨ç®¡é“decimalå£å¾„ä¸€è‡´

PR-Aé˜²å›å½’æµ‹è¯•:
  âœ… æ­£ç¡®å°æ•°æ ¼å¼é€šè¿‡

P0-1ä¸“é¡¹æµ‹è¯•:
  âœ… WEAK_SIGNAL_IN_RANGE â†’ UNCERTAINï¼ˆä¸æ˜¯POORï¼‰
  âœ… ä¸åœ¨Step 4è¢«çŸ­è·¯
  âœ… è¿›å…¥ExecutionPermissioné€»è¾‘
  âœ… é™çº§æ‰§è¡Œæœºåˆ¶ç”Ÿæ•ˆ

P0-2ä¸“é¡¹æµ‹è¯•:
  âœ… funding_rate_prev æ¯æ¬¡tickéƒ½æ›´æ–°
  âœ… NOISYåˆ†æ”¯returnåprevä»æ›´æ–°
  âœ… å¤šå¸ç§prevç‹¬ç«‹ä¸ä¸²æ‰°
  âœ… BTC/ETH/AIA/GPSå„è‡ªéš”ç¦»

P0-3ä¸“é¡¹æµ‹è¯•:
  âœ… oi_change_1h=0.06 è§¦å‘ OI_GROWING
  âœ… oi_change_1h=-0.06 è§¦å‘ OI_DECLINING
  âœ… è¾¹ç•Œå€¼æ­£ç¡®åˆ¤æ–­
  âœ… æç«¯å€¼æ­£ç¡®è§¦å‘
  âœ… DECIMALå£å¾„ä¸€è‡´
  âœ… ç™¾åˆ†æ¯”ç‚¹æ ¼å¼è¢«æ‹’ç»
  âœ… æ–¹å‘é˜ˆå€¼æ ¼å¼è¢«æ‹’ç»
  âœ… å¤šä¸ªé”™è¯¯å…¨éƒ¨æŠ¥å‘Š

PR-Bä¸“é¡¹æµ‹è¯•:
  âœ… ExecutabilityLevelæ˜ å°„
  âœ… has_blocking_tagså‡½æ•°
  âœ… has_degrading_tagså‡½æ•°
  âœ… POORè´¨é‡ç¡¬çŸ­è·¯
  âœ… UNCERTAINè´¨é‡é™çº§
  âœ… é™çº§æ ‡ç­¾é™åˆ¶ç½®ä¿¡åº¦
  âœ… executableç»¼åˆåˆ¤å®š

PR-Cä¸“é¡¹æµ‹è¯•:
  âœ… DecisionMemoryåŸºæœ¬åŠŸèƒ½
  âœ… æœ€å°é—´éš”é˜»æ–­
  âœ… ç¿»è½¬å†·å´é˜»æ–­
  âœ… ç¦ç”¨æ§åˆ¶åŠŸèƒ½

PR-Dä¸“é¡¹æµ‹è¯•:
  âœ… åŸºç¡€åŠ åˆ†åˆ¶
  âœ… UNCERTAINè´¨é‡ä¸Šé™
  âœ… é™çº§æ ‡ç­¾ä¸Šé™
  âœ… å¼ºä¿¡å·çªç ´
  âœ… å¼ºä¿¡å·æ— æ³•çªç ´cap
  âœ… ç½®ä¿¡åº¦æ¡£ä½æ¯”è¾ƒ
  âœ… å­—ç¬¦ä¸²è½¬ç½®ä¿¡åº¦

æ–¹æ¡ˆDä¸“é¡¹æµ‹è¯•:
  âœ… ExecutionPermissionæ˜ å°„æ­£ç¡®
  âœ… åŒé—¨æ§›æœºåˆ¶ç”Ÿæ•ˆ
  âœ… NOISY_MARKETå¯é™çº§æ‰§è¡Œï¼ˆæ ¸å¿ƒéªŒè¯ï¼‰
  âœ… EXTREMEåœºæ™¯æ‹’ç»æ‰§è¡Œ
  âœ… Capä¸é—¨æ§›é…ç½®ä¸€è‡´
```

---

## 15. ä½¿ç”¨æŒ‡å—

### 15.1 å¿«é€Ÿå¼€å§‹

#### æœ¬åœ°éƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
cd /path/to/trade-info

# 2. å¯åŠ¨æœåŠ¡
./docker-l1-run.sh

# 3. è®¿é—®Webç•Œé¢
open http://localhost:8001

# 4. æµ‹è¯•API
curl http://localhost:8001/api/l1/advisory/AIA
```

#### AWSè®¿é—®

```bash
# ç›´æ¥è®¿é—®
open http://43.212.176.169:8001

# æˆ–ä½¿ç”¨curl
curl http://43.212.176.169:8001/api/l1/advisory/AIA
```

### 15.2 é…ç½®è°ƒæ•´

#### ä¿®æ”¹å¸ç§åˆ—è¡¨

ç¼–è¾‘ `config/l1_thresholds.yaml`:

```yaml
symbol_universe:
  enabled_symbols:
    - AIA    # æ”¹ä¸ºä½ çš„å¸ç§
    - GPS
    - ETH
  default_symbol: AIA  # æ”¹ä¸ºé»˜è®¤å¸ç§
```

é‡å¯æœåŠ¡ï¼š
```bash
docker compose -f docker-compose-l1.yml restart
```

#### è°ƒæ•´å†³ç­–é¢‘ç‡æ§åˆ¶

```yaml
decision_control:
  min_decision_interval_seconds: 300  # æ”¹ä¸ºä½ çš„é—´éš”ï¼ˆç§’ï¼‰
  flip_cooldown_seconds: 600          # æ”¹ä¸ºä½ çš„å†·å´ï¼ˆç§’ï¼‰
  enable_min_interval: true           # æ˜¯å¦å¯ç”¨
  enable_flip_cooldown: true
```

æ”¯æŒçƒ­æ›´æ–°ï¼Œæ— éœ€é‡å¯ã€‚

#### è°ƒæ•´ç½®ä¿¡åº¦è§„åˆ™

```yaml
confidence_scoring:
  # ä¿®æ”¹åŸºç¡€åˆ†
  quality_uncertain_score: 15  # UNCERTAINçš„åˆ†æ•°
  
  # ä¿®æ”¹capè§„åˆ™ï¼ˆå·²é€šè¿‡æ–¹æ¡ˆDä¸Šè°ƒåˆ°HIGHï¼‰
  caps:
    uncertain_quality_max: "HIGH"  # æ–¹æ¡ˆDå·²ä¸Šè°ƒï¼Œå…è®¸é™çº§æ‰§è¡Œ
  
  # ä¿®æ”¹å¼ºä¿¡å·çªç ´
  strong_signal_boost:
    enabled: true
    boost_levels: 1  # æ”¹ä¸º2æå‡2æ¡£
```

æ”¯æŒçƒ­æ›´æ–°ã€‚

### 15.3 ç›‘æ§ä¸æ—¥å¿—

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker logs -f l1-advisory-layer

# æŸ¥çœ‹æœ€è¿‘100è¡Œ
docker logs --tail 100 l1-advisory-layer

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker ps --filter "name=l1-advisory-layer"

# æŸ¥çœ‹å¥åº·çŠ¶æ€
docker inspect l1-advisory-layer | grep -A 5 Health
```

### 15.4 æ•…éšœæ’æŸ¥

#### é—®é¢˜1: æœåŠ¡æ— æ³•å¯åŠ¨

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :8001

# æ£€æŸ¥DockerçŠ¶æ€
docker ps -a

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
docker logs l1-advisory-layer
```

#### é—®é¢˜2: å¸ç§æ— æ³•é€‰æ‹©

```bash
# æ£€æŸ¥é…ç½®æ–‡ä»¶
cat config/l1_thresholds.yaml | grep -A 5 symbol_universe

# æ£€æŸ¥APIå“åº”
curl http://localhost:8001/api/markets

# é‡æ–°æ„å»ºé•œåƒ
docker compose -f docker-compose-l1.yml build
```

#### é—®é¢˜3: å†³ç­–æ€»æ˜¯NO_TRADE

```bash
# æŸ¥çœ‹å†³ç­–ç®¡é“
curl http://localhost:8001/api/l1/pipeline/AIA | python3 -m json.tool

# æ£€æŸ¥ReasonTag
curl http://localhost:8001/api/l1/advisory/AIA | python3 -c "
import sys, json
d = json.load(sys.stdin)
print('ReasonTags:', d['data']['reason_tags'])
"

# æŸ¥çœ‹é¢‘ç‡æ§åˆ¶
# å¦‚æœæœ‰MIN_INTERVAL_BLOCKæˆ–FLIP_COOLDOWN_BLOCKï¼Œç­‰å¾…å†·å´æ—¶é—´è¿‡å»
```

### 15.5 å¼€å‘æµç¨‹

```
1. æœ¬åœ°å¼€å‘è°ƒè¯•
   - ä¿®æ”¹ä»£ç 
   - ./docker-l1-stop.sh
   - docker compose -f docker-compose-l1.yml build
   - ./docker-l1-run.sh
   - æµ‹è¯•éªŒè¯

2. è¿è¡Œæµ‹è¯•
   - docker exec l1-advisory-layer python tests/test_xxx.py

3. æäº¤ä»£ç 
   - git add .
   - git commit -m "æè¿°"
   - ï¼ˆä¸è‡ªåŠ¨æ¨é€åˆ°GitHubï¼Œå¬ä»æŒ‡ä»¤ï¼‰

4. éƒ¨ç½²åˆ°AWSï¼ˆæŒ‰éœ€ï¼‰
   - rsyncåŒæ­¥ä»£ç 
   - SSHç™»å½•AWS
   - é‡æ–°æ„å»ºå¹¶å¯åŠ¨æœåŠ¡
```

---

## 16. é™„å½•

### 16.1 æšä¸¾å®šä¹‰

#### Decision
```python
class Decision(Enum):
    LONG = "long"        # åšå¤šå»ºè®®
    SHORT = "short"      # åšç©ºå»ºè®®
    NO_TRADE = "no_trade"  # ä¸äº¤æ˜“
```

#### Confidence
```python
class Confidence(Enum):
    ULTRA = "ultra"      # è¶…é«˜ç½®ä¿¡åº¦ï¼ˆâ‰¥90åˆ†ï¼‰
    HIGH = "high"        # é«˜ç½®ä¿¡åº¦ï¼ˆ65-89åˆ†ï¼‰
    MEDIUM = "medium"    # ä¸­ç½®ä¿¡åº¦ï¼ˆ40-64åˆ†ï¼‰
    LOW = "low"          # ä½ç½®ä¿¡åº¦ï¼ˆ<40åˆ†ï¼‰
```

#### TradeQuality
```python
class TradeQuality(Enum):
    GOOD = "good"            # è‰¯å¥½è´¨é‡
    UNCERTAIN = "uncertain"  # ä¸ç¡®å®šï¼ˆå™ªå£°ï¼‰
    POOR = "poor"            # å·®è´¨é‡ï¼ˆé£é™©ï¼‰
```

#### MarketRegime
```python
class MarketRegime(Enum):
    TREND = "trend"      # è¶‹åŠ¿å¸‚
    RANGE = "range"      # éœ‡è¡å¸‚
    EXTREME = "extreme"  # æç«¯å¸‚
```

#### SystemState
```python
class SystemState(Enum):
    INIT = "init"        # åˆå§‹åŒ–
    WAIT = "wait"        # ç­‰å¾…çŠ¶æ€ï¼ˆL1å’¨è¯¢å±‚å›ºå®šçŠ¶æ€ï¼‰
    # æ³¨ï¼šL1ä½œä¸ºçº¯å’¨è¯¢å±‚ï¼Œä¸ç»´æŠ¤æŒä»“çŠ¶æ€ï¼ˆLONG_ACTIVE/SHORT_ACTIVE/COOL_DOWNå·²ç§»é™¤ï¼‰
```

#### ExecutabilityLevel (PR-B)
```python
class ExecutabilityLevel(Enum):
    ALLOW = "allow"      # å…è®¸æ‰§è¡Œ
    DEGRADE = "degrade"  # é™çº§ä½†å…è®¸
    BLOCK = "block"      # é˜»æ–­æ‰§è¡Œ
```

### 16.2 å®Œæ•´ReasonTagåˆ—è¡¨ï¼ˆv3.0ï¼‰

```python
# æ•°æ®éªŒè¯
INVALID_DATA = "invalid_data"
DATA_STALE = "data_stale"

# é£é™©å¦å†³ç±»
EXTREME_REGIME = "extreme_regime"
LIQUIDATION_PHASE = "liquidation_phase"
CROWDING_RISK = "crowding_risk"
EXTREME_VOLUME = "extreme_volume"

# è´¨é‡å¦å†³ç±»
ABSORPTION_RISK = "absorption_risk"
NOISY_MARKET = "noisy_market"
ROTATION_RISK = "rotation_risk"
WEAK_SIGNAL_IN_RANGE = "weak_signal_in_range"

# æ–¹å‘å†²çªç±»
CONFLICTING_SIGNALS = "conflicting_signals"
NO_CLEAR_DIRECTION = "no_clear_direction"

# å†³ç­–é¢‘ç‡æ§åˆ¶ç±»ï¼ˆPR-Cï¼‰
MIN_INTERVAL_BLOCK = "min_interval_block"
FLIP_COOLDOWN_BLOCK = "flip_cooldown_block"

# è¾…åŠ©ä¿¡æ¯ç±»
HIGH_FUNDING_RATE = "high_funding_rate"
LOW_FUNDING_RATE = "low_funding_rate"
STRONG_BUY_PRESSURE = "strong_buy_pressure"
STRONG_SELL_PRESSURE = "strong_sell_pressure"
OI_GROWING = "oi_growing"
OI_DECLINING = "oi_declining"
```

### 16.3 ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¸»è¦æ›´æ–° |
|------|------|---------|
| **v1.0** | 2025-12 | åŸºç¡€å†³ç­–ç³»ç»Ÿã€3æ¡£ç½®ä¿¡åº¦ã€2æ¡£è´¨é‡ |
| **v2.0** | 2026-01-19 | 10ä¸ªPRä¼˜åŒ–ã€4æ¡£ç½®ä¿¡åº¦ã€3æ¡£è´¨é‡ã€å¤šå¸ç§ã€AWSéƒ¨ç½² |
| **v3.0** | 2026-01-20 | PR-B/C/Då¢å¼ºã€ExecutabilityLevelã€é¢‘ç‡æ§åˆ¶ã€ç½®ä¿¡åº¦æ··åˆæ¨¡å¼ã€æ–¹æ¡ˆDæ‰§è¡Œè®¸å¯æœºåˆ¶ |
| **v3.1** | 2026-01-21 | **P0çº§Bugä¿®å¤**ï¼šP0-1(WEAK_SIGNALè´¨é‡)ã€P0-2(funding_prevå¤šå¸ç§)ã€P0-3(OIè¾…åŠ©æ ‡ç­¾å£å¾„)ï¼›æ–‡æ¡£ä¼˜åŒ–ï¼šç« èŠ‚ç¼–å·ä¿®æ­£ã€ä»£ç æ³¨é‡Šå¯¹é½ï¼›æµ‹è¯•å¢å¼ºï¼š48ä¸ªæµ‹è¯•ï¼ˆ+6ä¸ªP0éªŒæ”¶ï¼‰ |
| **v3.1.1** | 2026-01-21 | **P1/P2çº§ä¼˜åŒ–**ï¼šP2(æ³¨é‡Šä¸‰æ€)ã€P1(è¯­ä¹‰è¯´æ˜)ã€P1-1(é…ç½®é©±åŠ¨)ã€P1-2(å®‰å…¨é»˜è®¤å€¼)ã€P1-3(å¯åŠ¨guardrail)ï¼›å‰ç«¯åŒæ­¥ï¼šä¸‰æ€è´¨é‡+æ‰§è¡Œè®¸å¯çº§åˆ«æ˜¾ç¤ºï¼›æµ‹è¯•å¢å¼ºï¼š51ä¸ªæµ‹è¯• |
| **v3.1.2** | 2026-01-21 | **P0çº§æ•°æ®åº“ä¿®å¤**ï¼šexecution_permissionå­—æ®µç¼ºå¤±ï¼›æ•°æ®åº“è¿ç§»æœºåˆ¶ï¼›å‘åå…¼å®¹å¤„ç†ï¼›æµ‹è¯•å¢å¼ºï¼š52ä¸ªæµ‹è¯• |
| **v3.1.3** | 2026-01-21 | **PR-H**ï¼šConfidenceé…ç½®å€¼å¯åŠ¨æœŸfail-fastï¼ˆç¬¬4é‡guardrailï¼‰ï¼›æ‹¼å†™é”™è¯¯æ‹’ç»å¯åŠ¨ï¼›æµ‹è¯•å¢å¼ºï¼š54ä¸ªæµ‹è¯• |
| **v3.1.4** | 2026-01-21 | **PR-I**ï¼šreduce_tagsçš„é»˜è®¤capé…ç½®åŒ–ï¼›æå‡é…ç½®çµæ´»æ€§ï¼›æµ‹è¯•å¢å¼ºï¼š55ä¸ªæµ‹è¯• |
| **v3.1.5** | 2026-01-21 | **PR-J**ï¼šMetricsNormalizer.validate_rangesçº³å…¥L1æ ¡éªŒé“¾è·¯ï¼›ç»Ÿä¸€è¶…èŒƒå›´æ‹¦æˆªï¼›æ•°æ®å®‰å…¨ä¿æŠ¤ï¼›æµ‹è¯•å¢å¼ºï¼š56ä¸ªæµ‹è¯• |

### 16.4 å¼€å‘å›¢é˜Ÿä¸è”ç³»

- **ç³»ç»Ÿæ¶æ„**: L1 Advisory Layer
- **å¼€å‘è¯­è¨€**: Python 3.12
- **æ¡†æ¶**: Flask + Docker
- **éƒ¨ç½²**: AWS EC2
- **æ–‡æ¡£ç‰ˆæœ¬**: 3.1.5
- **æœ€åæ›´æ–°**: 2026-01-21 (v3.1.5é…ç½®å®‰å…¨+æ•°æ®å®‰å…¨)

---

## ğŸ“Œ æ€»ç»“

### v3.1.5æ ¸å¿ƒäº®ç‚¹

**v3.1.5 = v3.1.2 + PR-H/I/Jï¼ˆé…ç½®å®‰å…¨+æ•°æ®å®‰å…¨ï¼‰**

#### **ğŸŸ¢ PR-H/I/Jå¢é‡ä¼˜åŒ–ï¼ˆv3.1.3~v3.1.5ä¸“é¡¹ï¼‰**

**PR-H: Confidenceé…ç½®å€¼å¯åŠ¨æœŸfail-fastï¼ˆv3.1.3ï¼‰**
- **ç¬¬4é‡å¯åŠ¨guardrail**ï¼šConfidenceæ‹¼å†™é”™è¯¯ç›´æ¥æ‹’ç»å¯åŠ¨
- **æ£€æŸ¥èŒƒå›´**ï¼š
  * execution.min_confidence_normal/reduced
  * confidence_scoring.caps.uncertain_quality_max
  * confidence_scoring.caps.tag_caps.* (æ‰€æœ‰å€¼)
- **fail-faståŸåˆ™**ï¼šé…ç½®é”™è¯¯æ—¶æ˜ç¡®æŠ¥é”™ï¼Œé¿å…è¿è¡Œæ—¶é™é»˜å›é€€LOW
- **å¤§å°å†™ä¸æ•æ„Ÿ**ï¼šhigh/High/HIGH éƒ½å¯ä»¥
- **æµ‹è¯•å¢å¼º**ï¼š+2ä¸ªæµ‹è¯•ï¼ˆ54ä¸ªæµ‹è¯•ï¼‰

**PR-I: reduce_tagsçš„é»˜è®¤capé…ç½®åŒ–ï¼ˆv3.1.4ï¼‰**
- **é…ç½®çµæ´»æ€§**ï¼šæ–°å¢ reduce_default_max é…ç½®é¡¹
- **é€»è¾‘ä¸€è‡´æ€§**ï¼šé»˜è®¤å€¼è·Ÿéš uncertain_quality_max
- **é˜²é”™æ€§**ï¼šå¿˜è®°é…ç½®æ—¶æœ‰åˆç†é»˜è®¤è¡Œä¸º
- **ä¼˜å…ˆçº§é“¾**ï¼štag_caps > reduce_default_max > uncertain_quality_max > 'MEDIUM'
- **æµ‹è¯•å¢å¼º**ï¼š+1ä¸ªæµ‹è¯•ï¼ˆ55ä¸ªæµ‹è¯•ï¼‰

**PR-J: è¶…èŒƒå›´æ•°æ®æ‹¦æˆªï¼ˆv3.1.5ï¼‰**
- **æ•°æ®å®‰å…¨ä¿æŠ¤**ï¼švalidate_ranges çº³å…¥ L1 æ ¡éªŒé“¾è·¯
- **ç»Ÿä¸€æ‹¦æˆª**ï¼šåœ¨ Step 1 æ‹¦æˆªè¶…èŒƒå›´æ•°æ®ï¼Œé¿å…è¿›å…¥ç­–ç•¥
- **è¦†ç›–å­—æ®µ**ï¼š8ä¸ªå…³é”®å­—æ®µï¼ˆfunding_rate, oi_change, price_changeç­‰ï¼‰
- **åˆç†èŒƒå›´**ï¼š
  * funding_rate: Â±1% (å•æ¬¡è´¹ç‡æé™)
  * oi_change_1h: Â±100%, oi_change_6h: Â±200%
  * price_change_1h: Â±20%, price_change_6h: Â±50%
- **æ˜ç¡®é”™è¯¯ä¿¡æ¯**ï¼šåŒ…å«å­—æ®µåå’Œå…·ä½“å€¼
- **æµ‹è¯•å¢å¼º**ï¼š+1ä¸ªæµ‹è¯•ï¼ˆ56ä¸ªæµ‹è¯•ï¼‰

---

### v3.1.2æ ¸å¿ƒäº®ç‚¹

**v3.1.2 = v3.1.1 + P0çº§æ•°æ®åº“åŒæ­¥ä¿®å¤**

#### **ğŸ”´ P0çº§æ•°æ®åº“ä¿®å¤ï¼ˆv3.1.2ä¸“é¡¹ï¼‰**

**é—®é¢˜ï¼šexecution_permissionå­—æ®µç¼ºå¤±**
- AdvisoryResultæ¨¡å‹åŒ…å«è¯¥å­—æ®µï¼ˆæ–¹æ¡ˆDæ–°å¢ï¼‰
- æ•°æ®åº“è¡¨ç»“æ„ç¼ºå°‘è¯¥å­—æ®µ
- saveæ–¹æ³•æœªä¿å­˜è¯¥å­—æ®µ
- queryæ–¹æ³•æœªè¯»å–è¯¥å­—æ®µ

**ä¿®å¤æ–¹æ¡ˆï¼šæ•°æ®åº“è¿ç§» + å…¨é¢åŒæ­¥**
- æ–°å»ºè¡¨è‡ªåŠ¨åŒ…å«execution_permissionå­—æ®µ
- æ•°æ®åº“è¿ç§»æœºåˆ¶è‡ªåŠ¨ä¸ºè€è¡¨æ·»åŠ å­—æ®µ
- ALTER TABLEè‡ªåŠ¨æ‰§è¡Œï¼ˆé»˜è®¤å€¼'allow'ï¼‰
- è€æ•°æ®è‡ªåŠ¨è·å¾—é»˜è®¤å€¼

**æ›´æ–°å†…å®¹**
- è¡¨ç»“æ„ï¼šæ–°å¢execution_permission TEXT DEFAULT 'allow'
- è¿ç§»é€»è¾‘ï¼š_migrate_add_execution_permission()
- saveæ–¹æ³•ï¼šå†™å…¥execution_permission
- queryæ–¹æ³•ï¼šè¯»å–execution_permissionï¼ˆå‘åå…¼å®¹ï¼‰
- æ‰¹é‡ä¿å­˜ï¼šsave_advisory_results_batch()

**æµ‹è¯•éªŒè¯**
- æ–°å¢test_database_execution_permission.py
- éªŒè¯æ•°æ®åº“è¿ç§»æ­£å¸¸æ‰§è¡Œ
- éªŒè¯ä¸‰ç§è®¸å¯çº§åˆ«ï¼ˆALLOW/ALLOW_REDUCED/DENYï¼‰
- éªŒè¯ä¿å­˜å’ŒæŸ¥è¯¢æ­£ç¡®
- ç”Ÿäº§æ•°æ®åº“ï¼ˆ716KBï¼‰å·²æˆåŠŸè¿ç§»

**æµ‹è¯•å¢å¼º**ï¼š
- æ–°å¢1ä¸ªæ•°æ®åº“éªŒè¯æµ‹è¯•
- æµ‹è¯•æ€»æ•°ï¼š51 â†’ 52
- å‘åå…¼å®¹100%

---

### v3.1.1æ ¸å¿ƒäº®ç‚¹

**v3.1.1 = v3.1 + P1/P2çº§ä¼˜åŒ– + å¯åŠ¨guardrail + å‰ç«¯åŒæ­¥**

#### **ğŸŸ¡ P1/P2çº§ä¼˜åŒ–ï¼ˆv3.1.1ä¸“é¡¹ï¼‰**

**P2: TradeQualityæ³¨é‡Šä¸‰æ€åŒæ­¥**
- å­—æ®µæ³¨é‡Šä» "GOOD/POOR" æ›´æ–°ä¸º "GOOD/UNCERTAIN/POORï¼ˆä¸‰æ€ï¼‰"
- ä¸PR-004çš„ä¸‰æ€å‡çº§ä¿æŒæ–‡æ¡£ä¸€è‡´æ€§

**P1: ABSORPTION/ROTATIONè¯­ä¹‰æ˜ç¡®**
- æ–‡æ¡£å’Œä»£ç æ³¨é‡Šæ˜ç¡®è¯´æ˜ä¸º "deny_tagsç­‰ä»·ç‰©"
- åŒé‡ä¿æŠ¤æœºåˆ¶è¯´æ˜ï¼šPOORç¡¬çŸ­è·¯ + BLOCKæ ‡ç­¾
- æ‰§è¡Œé¡ºåºä¿è¯ï¼šStep 8å…ˆäºStep 9ï¼ˆå¼ºä¿¡å·æ— æ³•ç»•è¿‡ï¼‰

**P1-1: required_tagsé…ç½®é©±åŠ¨**
- ä»é…ç½®è¯»å– `strong_signal_boost.required_tags`
- æ¶ˆé™¤ç¡¬ç¼–ç ï¼Œæ”¯æŒåŠ¨æ€é…ç½®
- å¼‚å¸¸å®¹é”™ï¼šæ— æ•ˆæ ‡ç­¾warningå¹¶è·³è¿‡

**P1-2: string_to_confidenceå®‰å…¨é»˜è®¤å€¼**
- é…ç½®é”™è¯¯æ—¶è¿”å› LOWï¼ˆæœ€ä¿å®ˆï¼‰è€Œé MEDIUM
- è®°å½• ERROR æ—¥å¿—è®©é—®é¢˜ç«‹å³å¯è§
- é—¨æ§›åœºæ™¯ä¸ä¼šå› é…ç½®é”™è¯¯é™ä½è¦æ±‚

**P1-3: å¯åŠ¨guardrailè¡¥é½**
- æ–°å¢é—¨æ§›ä¸€è‡´æ€§æ ¡éªŒï¼šreduced <= uncertain_max/tag_caps
- æ–°å¢ReasonTagæ‹¼å†™æ ¡éªŒï¼šfail-fastæœºåˆ¶
- ä¸‰é‡å¯åŠ¨æ ¡éªŒï¼šdecimal + threshold + spelling

**å‰ç«¯åŒæ­¥**
- äº¤æ˜“è´¨é‡æ”¯æŒä¸‰æ€æ˜¾ç¤ºï¼ˆâœ… GOOD / âš ï¸ UNCERTAIN / âŒ POORï¼‰
- æ–°å¢æ‰§è¡Œè®¸å¯çº§åˆ«å¡ç‰‡ï¼ˆâœ… ALLOW / âš ï¸ ALLOW_REDUCED / â›” DENYï¼‰
- æ‰§è¡Œåˆ¤å®šè¯´æ˜ä¼˜åŒ–ï¼ˆåŸºäºæ‰§è¡Œè®¸å¯çº§åˆ«+ç½®ä¿¡åº¦åŒé—¨æ§›ï¼‰

**æµ‹è¯•å¢å¼º**ï¼š
- æ–°å¢3ä¸ªP1éªŒæ”¶æµ‹è¯•
- æµ‹è¯•æ€»æ•°ï¼š48 â†’ 51
- å¯åŠ¨guardrailï¼š1ä¸ªæ ¡éªŒ â†’ 3ä¸ªæ ¡éªŒ

---

### v3.1æ ¸å¿ƒäº®ç‚¹

**v3.1 = v3.0åŠŸèƒ½ + æ–‡æ¡£ä¼˜åŒ– + P0çº§Bugä¿®å¤**

#### **ğŸ”´ P0çº§Bugä¿®å¤ï¼ˆv3.1ä¸“é¡¹ï¼‰**

**P0-1: WEAK_SIGNAL_IN_RANGEè´¨é‡è¯„çº§ä¿®æ­£**
- ä» POOR â†’ UNCERTAINï¼Œé¿å…Step 4ç¡¬çŸ­è·¯
- æ¢å¤RANGEå¸‚åœºé™çº§æ‰§è¡Œé€»è¾‘
- ä¸ NOISY_MARKET è¡Œä¸ºä¿æŒä¸€è‡´

**P0-2: funding_rate_prevå¤šå¸ç§éš”ç¦»**
- ä¿®å¤æ›´æ–°ä¸å¯è¾¾é—®é¢˜ï¼ˆå…ˆå†™å›å†returnï¼‰
- å®ç°å¤šå¸ç§ç‹¬ç«‹å­˜å‚¨ï¼ˆsymbolå‰ç¼€ï¼‰
- ç¡®ä¿ funding_volatility è®¡ç®—å‡†ç¡®

**P0-3: OIè¾…åŠ©æ ‡ç­¾å£å¾„ç»Ÿä¸€**
- ä»ç™¾åˆ†ç‚¹æ ¼å¼ï¼ˆ5.0ï¼‰æ”¹ä¸ºå°æ•°æ ¼å¼ï¼ˆ0.05ï¼‰
- é…ç½®åŒ–ç®¡ç†ï¼ˆæ–°å¢auxiliary_tagsé…ç½®ï¼‰
- æ¢å¤ OI_GROWING/OI_DECLINING æ ‡ç­¾æ­£å¸¸è§¦å‘

**æµ‹è¯•å¢å¼º**ï¼š
- æ–°å¢6ä¸ªP0éªŒæ”¶æµ‹è¯•ï¼ˆå«12ä¸ªéªŒæ”¶ç‚¹ï¼‰
- æµ‹è¯•æ€»æ•°ï¼š42 â†’ 48
- å£å¾„ä¸€è‡´æ€§ï¼š100%

---

### v3.0æ ¸å¿ƒå‡çº§

#### **ğŸ”´ æœ€é‡è¦ï¼šPR-Aå£å¾„ä¿®å¤ï¼ˆç³»ç»Ÿæ€§é”™è¯¯ï¼‰**
- ç»Ÿä¸€é…ç½®å£å¾„ä¸ºå°æ•°æ ¼å¼ï¼ˆ0.05=5%ï¼‰
- ä¿®å¤æ–¹å‘è¯„ä¼°ä»æœªè§¦å‘çš„è‡´å‘½Bug
- ä¿®å¤å¸‚åœºç¯å¢ƒè¯†åˆ«å¼‚å¸¸
- **é¦–æ¬¡æˆåŠŸè§¦å‘LONG/SHORTå†³ç­–**
- æµ‹è¯•éªŒè¯ï¼šå¼ºTREND+å¼ºLONG â†’ decision=LONG, confidence=ULTRA, executable=True

1. **PR-B: è´¨é‡è¯­ä¹‰é’‰æ­»**
   - ExecutabilityLevelä¸‰çº§æ§åˆ¶ï¼ˆALLOW/DEGRADE/BLOCKï¼‰
   - 23ä¸ªReasonTagç²¾ç»†æ˜ å°„
   - POORç¡¬çŸ­è·¯ã€UNCERTAINé™çº§æ‰§è¡Œ
   - ä¸ºæ–¹æ¡ˆDçš„åŒé—¨æ§›æœºåˆ¶å¥ å®šåŸºç¡€

2. **PR-C: å†³ç­–é¢‘ç‡æ§åˆ¶**
   - DecisionMemoryè½»é‡çº§ç®¡ç†
   - æœ€å°é—´éš”ï¼ˆ300sï¼‰+ ç¿»è½¬å†·å´ï¼ˆ600sï¼‰
   - å¤šå¸ç§ç‹¬ç«‹æ§åˆ¶
   - å¯é…ç½®å¼€å…³

3. **PR-D: ç½®ä¿¡åº¦æ··åˆæ¨¡å¼**
   - ä¸‰æ­¥æµç¨‹ï¼šåŠ åˆ† â†’ cap â†’ boost
   - UNCERTAINâ‰¤HIGHï¼ˆæ–¹æ¡ˆDä¸Šè°ƒï¼‰ã€é™çº§æ ‡ç­¾â‰¤HIGH
   - å¼ºä¿¡å·+1æ¡£ï¼ˆä½†ä¸çªç ´capï¼‰
   - å®Œå…¨é…ç½®åŒ–

4. **ğŸŸ¡ é‡å¤§å‡çº§ï¼šæ–¹æ¡ˆD - æ‰§è¡Œè®¸å¯æœºåˆ¶**
   - ExecutionPermissionä¸‰çº§ï¼ˆALLOW/ALLOW_REDUCED/DENYï¼‰
   - åŒé—¨æ§›æœºåˆ¶ï¼šALLOWè¦æ±‚HIGHï¼ŒALLOW_REDUCEDè¦æ±‚MEDIUM
   - ä¿®å¤DEGRADEè¯­ä¹‰è¢«å¦å†³çš„å†²çª
   - **çœŸæ­£å®ç°"é™çº§æ‰§è¡Œ"**ï¼ˆNOISY_MARKETå¯executableï¼‰
   - å†³ç­–ç®¡é“æ‰©å±•ä¸º10æ­¥ï¼ˆæ–°å¢Step 8æ‰§è¡Œè®¸å¯ã€Step 9ç½®ä¿¡åº¦ï¼‰

5. **å®šåˆ¶åŒ–ä¼˜åŒ–**
   - å¸ç§ï¼šAIAã€GPSã€ETH
   - å‰ç«¯ç®€åŒ–ï¼šåˆ é™¤å¸‚åœºæ•°æ®æ¦‚è§ˆ
   - æµ‹è¯•è¦†ç›–ï¼š42ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡

6. **ç”Ÿäº§å°±ç»ª**
   - æœ¬åœ°å¼€å‘ç¯å¢ƒ
   - AWSç”Ÿäº§ç¯å¢ƒï¼ˆ43.212.176.169:8001ï¼‰
   - Dockerå®¹å™¨åŒ–
   - é…ç½®çƒ­æ›´æ–°

---

**L1 Advisory Layer v3.1.5 - æ›´æ™ºèƒ½ã€æ›´å®‰å…¨ã€æ›´å¯æ§çš„äº¤æ˜“å†³ç­–å’¨è¯¢ç³»ç»Ÿï¼** ğŸš€

**v3.1.5æ›´æ–°è¯´æ˜**ï¼ˆ2026-01-21ï¼Œé…ç½®å®‰å…¨+æ•°æ®å®‰å…¨ï¼‰ï¼š
- ğŸŸ¢ **PR-H: Confidenceé…ç½®å€¼å¯åŠ¨æœŸfail-fast**ï¼ˆç¬¬4é‡guardrailï¼‰ï¼š
  - æ–°å¢ _validate_confidence_values() å¯åŠ¨æ ¡éªŒ
  - æ£€æŸ¥4ä¸ªé…ç½®ä½ç½®ï¼ˆmin_confidence_normal/reduced + uncertain_max + tag_capsï¼‰
  - æ‹¼å†™é”™è¯¯ï¼ˆHGIH/MEDUIM/LOWWï¼‰ç›´æ¥æ‹’ç»å¯åŠ¨
  - å¤§å°å†™ä¸æ•æ„Ÿï¼ˆhigh/High/HIGHéƒ½å¯ä»¥ï¼‰
  - æµ‹è¯•ï¼š+2ä¸ªï¼ˆ54ä¸ªæµ‹è¯•ï¼‰
- ğŸŸ¢ **PR-I: reduce_tagsçš„é»˜è®¤capé…ç½®åŒ–**ï¼ˆæå‡é…ç½®çµæ´»æ€§ï¼‰ï¼š
  - æ–°å¢ reduce_default_max é…ç½®é¡¹ï¼ˆconfig/l1_thresholds.yamlï¼‰
  - ä¼˜å…ˆçº§é“¾ï¼štag_caps > reduce_default_max > uncertain_quality_max > 'MEDIUM'
  - é€»è¾‘ä¸€è‡´æ€§ï¼šé»˜è®¤å€¼è·Ÿéš uncertain_quality_max
  - é˜²é”™æ€§ï¼šå¿˜è®°é…ç½®æ—¶æœ‰åˆç†é»˜è®¤è¡Œä¸º
  - æµ‹è¯•ï¼š+1ä¸ªï¼ˆ55ä¸ªæµ‹è¯•ï¼‰
- ğŸŸ¢ **PR-J: è¶…èŒƒå›´æ•°æ®æ‹¦æˆª**ï¼ˆæ•°æ®å®‰å…¨æ ¸å¿ƒä¿æŠ¤ï¼‰ï¼š
  - validate_ranges çº³å…¥ L1 æ ¡éªŒé“¾è·¯ï¼ˆåœ¨ Step 1 æ•°æ®éªŒè¯ï¼‰
  - è¦†ç›–8ä¸ªå…³é”®å­—æ®µï¼ˆfunding_rate, oi_change_1h/6h, price_change_1h/6hç­‰ï¼‰
  - ç»Ÿä¸€æ‹¦æˆªè¶…èŒƒå›´æ•°æ®ï¼Œé¿å…å¼‚å¸¸æ•°æ®è¿›å…¥ç­–ç•¥åˆ¤æ–­
  - æ˜ç¡®é”™è¯¯ä¿¡æ¯ï¼ˆåŒ…å«å­—æ®µåå’Œå…·ä½“å€¼ï¼‰
  - æµ‹è¯•ï¼š+1ä¸ªï¼ˆ56ä¸ªæµ‹è¯•ï¼‰
- âœ… å¯åŠ¨guardrail: 3é‡ â†’ 4é‡ï¼ˆæ–°å¢Confidenceæ‹¼å†™æ ¡éªŒï¼‰
- âœ… æ•°æ®æ ¡éªŒé“¾è·¯: å¢å¼ºèŒƒå›´æ‹¦æˆªï¼ˆ8ä¸ªå­—æ®µå…¨è¦†ç›–ï¼‰
- âœ… é…ç½®é©±åŠ¨ä¸€è‡´æ€§: è¿›ä¸€æ­¥æå‡åˆ°98%
- âœ… æµ‹è¯•è¦†ç›–: 52 â†’ 56ä¸ªæµ‹è¯•ï¼ˆå¢é‡+4ä¸ªï¼‰

**v3.1.2æ›´æ–°è¯´æ˜**ï¼ˆ2026-01-21ï¼Œæ•°æ®åº“åŒæ­¥ä¿®å¤ï¼‰ï¼š
- ğŸ”´ **P0çº§æ•°æ®åº“ä¿®å¤**ï¼ˆæ•°æ®åº“ä¸æ¨¡å‹ä¸åŒæ­¥ï¼‰ï¼š
  - execution_permissionå­—æ®µç¼ºå¤±
  - æ•°æ®åº“è¿ç§»æœºåˆ¶ï¼ˆå‘åå…¼å®¹ï¼‰
  - ä¿å­˜å’ŒæŸ¥è¯¢æ–¹æ³•å…¨é¢æ›´æ–°
  - è€æ•°æ®è‡ªåŠ¨è¿ç§»ï¼ˆ716KBæ•°æ®ï¼‰
- âœ… æµ‹è¯•å¢å¼ºï¼š52ä¸ªæµ‹è¯•ï¼ˆ+1ä¸ªæ•°æ®åº“éªŒè¯æµ‹è¯•ï¼‰
- âœ… å‘åå…¼å®¹100%
- âœ… ç”Ÿäº§æ•°æ®åº“å·²è¿ç§»

**v3.1.1æ›´æ–°è¯´æ˜**ï¼ˆ2026-01-21ï¼Œå¢é‡ä¼˜åŒ–ï¼‰ï¼š
- ğŸŸ¡ **P1/P2çº§ä¼˜åŒ–**ï¼ˆ6ä¸ªï¼Œæå‡ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ï¼‰ï¼š
  - P2: TradeQualityæ³¨é‡ŠåŒæ­¥ä¸ºä¸‰æ€ï¼ˆæ–‡æ¡£ä¸€è‡´æ€§ï¼‰
  - P1: ABSORPTION/ROTATION_RISKè¯­ä¹‰è¯´æ˜ï¼ˆdeny_tagsç­‰ä»·ç‰©ï¼‰
  - P1-1: required_tagsé…ç½®é©±åŠ¨ï¼ˆæ¶ˆé™¤ç¡¬ç¼–ç ï¼‰
  - P1-2: string_to_confidenceå®‰å…¨é»˜è®¤å€¼ï¼ˆLOWè€ŒéMEDIUMï¼‰
  - P1-3: å¯åŠ¨guardrailè¡¥é½ï¼ˆé—¨æ§›ä¸€è‡´æ€§+ReasonTagæ‹¼å†™æ ¡éªŒï¼‰
- ğŸ¨ **å‰ç«¯åŒæ­¥**ï¼š
  - æ”¯æŒä¸‰æ€è´¨é‡æ˜¾ç¤ºï¼ˆGOOD/UNCERTAIN/POORï¼‰
  - æ–°å¢æ‰§è¡Œè®¸å¯çº§åˆ«å¡ç‰‡ï¼ˆALLOW/ALLOW_REDUCED/DENYï¼‰
  - æ‰§è¡Œåˆ¤å®šè¯´æ˜ä¼˜åŒ–ï¼ˆåŒé—¨æ§›æœºåˆ¶è¯´æ˜ï¼‰
- âœ… æµ‹è¯•å¢å¼ºï¼š51ä¸ªæµ‹è¯•ï¼ˆ+3ä¸ªP1éªŒæ”¶æµ‹è¯•ï¼‰
- âœ… å¯åŠ¨guardrailå®Œå–„ï¼š3é‡æ ¡éªŒï¼ˆdecimal + threshold + spellingï¼‰
- âœ… é…ç½®é©±åŠ¨ä¸€è‡´æ€§ï¼š100%
- âœ… å‰åç«¯å®Œå…¨åŒæ­¥

**v3.1æ›´æ–°è¯´æ˜**ï¼ˆ2026-01-21ï¼Œæ ¸å¿ƒä¿®å¤ï¼‰ï¼š
- ğŸ”´ **P0çº§Bugä¿®å¤**ï¼ˆ3ä¸ªï¼Œæå‡ç³»ç»Ÿç¨³å®šæ€§ï¼‰ï¼š
  - P0-1: WEAK_SIGNAL_IN_RANGE è´¨é‡è¯„çº§ä¿®æ­£ï¼ˆPOORâ†’UNCERTAINï¼‰
  - P0-2: funding_rate_prev å¤šå¸ç§éš”ç¦» + æ›´æ–°ä¸å¯è¾¾ä¿®å¤
  - P0-3: OI è¾…åŠ©æ ‡ç­¾é˜ˆå€¼å£å¾„ç»Ÿä¸€ï¼ˆé…ç½®åŒ– + DECIMALï¼‰
- âœ… ä¿®æ­£æ–‡æ¡£ç« èŠ‚ç¼–å·ï¼ˆç¬¬6-16ç« ä»é”™ä½çŠ¶æ€æ¢å¤æ­£ç¡®ï¼‰
- âœ… ä»£ç æ³¨é‡Šå¯¹é½ï¼ˆ10æ­¥å†³ç­–ç®¡é“æè¿°ç»Ÿä¸€ï¼‰
- âœ… ä»£ç æ–‡æ¡£ä¸€è‡´æ€§æå‡è‡³100%
- âœ… æµ‹è¯•å¢å¼ºï¼š48ä¸ªæµ‹è¯•ï¼ˆ+6ä¸ªP0éªŒæ”¶æµ‹è¯•ï¼Œå«12ä¸ªéªŒæ”¶ç‚¹ï¼‰
- âœ… åŸºäºv3.0åŠŸèƒ½ï¼Œè´¨é‡å’Œç¨³å®šæ€§å…¨é¢æå‡
